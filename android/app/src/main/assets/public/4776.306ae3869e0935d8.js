"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4776],{4776:(y,O,g)=>{g.d(O,{W:()=>u});var M=g(9808),a=g(4182),l=g(5362),T=g(2028),E=g(7932),h=g(2096);const t=[{path:"",component:E.y}];let m=(()=>{class v{}return v.\u0275fac=function(N){return new(N||v)},v.\u0275mod=h.oAB({type:v}),v.\u0275inj=h.cJS({imports:[[T.Bz.forChild(t)],T.Bz]}),v})();var i=g(7217);let u=(()=>{class v{}return v.\u0275fac=function(N){return new(N||v)},v.\u0275mod=h.oAB({type:v}),v.\u0275inj=h.cJS({imports:[[M.ez,a.u5,l.Pc,m,i.S,a.UX]]}),v})()},7932:(y,O,g)=>{g.d(O,{y:()=>ti});var M=g(655),a=g(4182),l=g(1247),T=g(5351),E=g(3951),h=g(4021),t=g(2271),m=g(9662),i=g(2096),u=g(5362),v=g(7652),R=g(9808);const N=["c1"],L=["c2"],U=["c3"],b=["c4"],V=["c5"],D=["c6"],F=["c7"],J=["c8"],G=["c9"],q=["c10"];function Q(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"ion-buttons",15)(1,"ion-button",3),i.NdJ("click",function(){return i.CHM(e),i.oxw().backStepRegistration()}),i._UZ(2,"ion-icon",16),i.qZA()()}}function x(r,f){if(1&r&&(i.TgZ(0,"ion-segment-button",19),i._uU(1," Registrati "),i.qZA()),2&r){const e=i.oxw(2);i.Q6J("value",e.pageState.REGISTRATION)}}function _(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",17)(1,"ion-segment",18),i.NdJ("ngModelChange",function(n){return i.CHM(e),i.oxw().actualStateSegment=n})("ionChange",function(n){return i.CHM(e),i.oxw().onSegmentChanged(n)}),i.TgZ(2,"ion-segment-button",19),i._uU(3," Accedi "),i.qZA(),i.YNc(4,x,2,1,"ion-segment-button",20),i.qZA()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("ngModel",e.actualStateSegment),i.xp6(1),i.Q6J("value",e.pageState.LOGIN),i.xp6(2),i.Q6J("ngIf",e.registrationInApp)}}function w(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",17)(1,"form",21)(2,"ion-list")(3,"ion-item"),i._UZ(4,"ion-icon",22)(5,"ion-input",23),i.qZA(),i.TgZ(6,"ion-item"),i._UZ(7,"ion-icon",24)(8,"ion-input",25),i.qZA()()(),i.TgZ(9,"div",26)(10,"a",27),i.NdJ("click",function(){return i.CHM(e),i.oxw().onClickReimpostaPsw()}),i._uU(11,"Aiuto, non ricordo la password "),i.qZA()()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("formGroup",e.formLogin)}}function s(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"ion-button",35),i.NdJ("click",function(){return i.CHM(e),i.oxw(2).openPolicyLink()}),i._uU(1," condizioni di registrazione "),i.qZA()}}function c(r,f){1&r&&(i.TgZ(0,"div",36)(1,"p")(2,"ion-text",0),i._UZ(3,"ion-icon",37),i.qZA(),i._uU(4," Indica una email valida dove sar\xe0 possibile inviarti le ricevute di prenotazioni, attestati dei corsi ed altri documenti fiscali. "),i.qZA(),i.TgZ(5,"p")(6,"ion-text",0)(7,"h6")(8,"i"),i._uU(9,"(in seguito potrai abilitare l'email anche per la ricezione di altro materiale informativo)"),i.qZA()()()()())}function d(r,f){1&r&&(i.TgZ(0,"div",36)(1,"p")(2,"ion-text",0),i._UZ(3,"ion-icon",37),i.qZA(),i._uU(4," Indica una email valida dove sar\xe0 possibile inviarti le ricevute di prenotazioni, attestati dei corsi ed altri documenti fiscali. "),i.qZA(),i.TgZ(5,"h6"),i._uU(6," Per effettuare la verifica ti inviamo una email contenente un pincode da inserire nei passaggi succesivi di registrazione "),i.qZA(),i.TgZ(7,"p")(8,"ion-text",0)(9,"h6")(10,"i"),i._uU(11,"(in seguito potrai abilitare l'email anche per la ricezione di altro materiale informativo)"),i.qZA()()()()())}function I(r,f){1&r&&(i.TgZ(0,"div",36)(1,"p")(2,"ion-text",0),i._UZ(3,"ion-icon",37),i.qZA(),i._uU(4," Indica una email valida dove sar\xe0 possibile inviarti i documenti fiscali ed un numero di cellulare per contattarti in caso di problemi. "),i.qZA(),i.TgZ(5,"p")(6,"ion-text",0)(7,"h6")(8,"i"),i._uU(9,"Per effettuare la verifica ti inviamo 2 pincode (email/SMS) da inserire nei passaggi succesivi di registrazione"),i.qZA()()()()())}function A(r,f){1&r&&(i.TgZ(0,"div",36)(1,"p")(2,"ion-text",0),i._UZ(3,"ion-icon",37),i.qZA(),i._uU(4," Indica un numero di cellulare dove contattarti in caso di problematiche legate alle prenotazioni della struttura. "),i.qZA(),i.TgZ(5,"p"),i._uU(6," Per effettuare la verifica ti inviamo un SMS con un pincode da inserire nei passaggi succesivi di registrazione "),i.qZA(),i.TgZ(7,"p")(8,"ion-text",0)(9,"h6")(10,"i"),i._uU(11,"(non sarai mai contattato per promozioni o marketing)"),i.qZA()()()()())}function Z(r,f){if(1&r&&(i.TgZ(0,"div",28)(1,"form",21)(2,"ion-list")(3,"ion-item"),i._UZ(4,"ion-icon",29)(5,"ion-input",30),i.qZA(),i.TgZ(6,"ion-item"),i._UZ(7,"ion-icon",31)(8,"ion-input",32),i.qZA()(),i.YNc(9,s,2,0,"ion-button",33),i.YNc(10,c,10,0,"div",34),i.YNc(11,d,12,0,"div",34),i.YNc(12,I,10,0,"div",34),i.YNc(13,A,12,0,"div",34),i.qZA()()),2&r){const e=i.oxw();i.xp6(1),i.Q6J("formGroup",e.formContact),i.xp6(8),i.Q6J("ngIf",e.isPolicyLink()),i.xp6(1),i.Q6J("ngIf",e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.noverifica),i.xp6(1),i.Q6J("ngIf",e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificaemail),i.xp6(1),i.Q6J("ngIf",e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificaemailsms),i.xp6(1),i.Q6J("ngIf",e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificasms)}}function H(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",36)(1,"ion-item",38)(2,"ion-button",39),i.NdJ("click",function(){i.CHM(e);const n=i.oxw(2);return n.onClickReinviaCodice(n.tipoVerifica.verificaemail)}),i._UZ(3,"ion-icon",40),i.qZA(),i.TgZ(4,"ion-label",41),i._uU(5,"Inserisci il pincode ricevuto tramite email"),i.qZA()(),i.TgZ(6,"form",21)(7,"div",5)(8,"ion-segment")(9,"ion-input",42,43),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(11,"ion-input",44,45),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(13,"ion-input",46,47),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(15,"ion-input",48,49),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(17,"ion-input",50,51),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA()()()()()}if(2&r){const e=i.oxw(2);i.xp6(6),i.Q6J("formGroup",e.formVerifyMail),i.xp6(1),i.Q6J("ngClass",e.isDesktop?"form-verifica desktop":"form-verifica")}}function Y(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",36)(1,"ion-item",38)(2,"ion-button",39),i.NdJ("click",function(){i.CHM(e);const n=i.oxw(2);return n.onClickReinviaCodice(n.tipoVerifica.verificasms)}),i._UZ(3,"ion-icon",40),i.qZA(),i.TgZ(4,"ion-label",41),i._uU(5," Inserisci il pincode ricevuto tramite SMS"),i.qZA()(),i.TgZ(6,"form",21)(7,"div",5)(8,"ion-segment")(9,"ion-input",52,53),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(11,"ion-input",54,55),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(13,"ion-input",56,57),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(15,"ion-input",58,59),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA(),i.TgZ(17,"ion-input",60,61),i.NdJ("ionInput",function(n){return i.CHM(e),i.oxw(2).changeFocus(n)}),i.qZA()()()()()}if(2&r){const e=i.oxw(2);i.xp6(6),i.Q6J("formGroup",e.formVerifyTel),i.xp6(1),i.Q6J("ngClass",e.isDesktop?"form-verifica desktop":"form-verifica")}}function z(r,f){if(1&r&&(i.TgZ(0,"div"),i.YNc(1,H,19,2,"div",34),i.YNc(2,Y,19,2,"div",34),i.qZA()),2&r){const e=i.oxw();i.xp6(1),i.Q6J("ngIf",e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificaemail||e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificaemailsms),i.xp6(1),i.Q6J("ngIf",e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificasms||e.docGruppo.APPTIPOVERIFICA==e.tipoVerifica.verificaemailsms)}}function B(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"ion-item",38)(1,"ion-label"),i._uU(2,"Accetto la "),i.TgZ(3,"a",27),i.NdJ("click",function(){return i.CHM(e),i.oxw(2).openPolicyLink()}),i._uU(4,"privacy policy"),i.qZA()(),i._UZ(5,"ion-checkbox",72),i.qZA()}}function W(r,f){if(1&r&&(i.TgZ(0,"div")(1,"form",21)(2,"ion-list")(3,"ion-item"),i._UZ(4,"ion-icon",62)(5,"ion-input",63),i.qZA(),i.TgZ(6,"ion-item"),i._UZ(7,"ion-icon",62)(8,"ion-input",64),i.qZA(),i.TgZ(9,"ion-item"),i._UZ(10,"ion-icon",65)(11,"ion-input",66),i.qZA(),i.TgZ(12,"ion-item"),i._UZ(13,"ion-icon",65)(14,"ion-input",67),i.qZA(),i.TgZ(15,"ion-item"),i._UZ(16,"ion-icon",68)(17,"ion-input",69),i.qZA(),i.YNc(18,B,6,0,"ion-item",70),i.TgZ(19,"ion-item",38)(20,"ion-label"),i._uU(21,"Voglio ricevere la Newsletter"),i.qZA(),i._UZ(22,"ion-checkbox",71),i.qZA()()(),i.TgZ(23,"div",36)(24,"p")(25,"ion-text",0),i._UZ(26,"ion-icon",37),i.qZA(),i._uU(27," Dobbiamo richiederti alcune informazioni personali per l'eventuale "),i.qZA(),i.TgZ(28,"p"),i._uU(29," emissione di documenti fiscali "),i.qZA(),i.TgZ(30,"p")(31,"ion-text",0)(32,"h6")(33,"i"),i._uU(34,"(ad esempio in caso di iscrizioni a corsi o prenotazioni della struttura)"),i.qZA()()()()()()),2&r){const e=i.oxw();i.xp6(1),i.Q6J("formGroup",e.formRegister),i.xp6(17),i.Q6J("ngIf",e.isPolicyLink())}}function X(r,f){1&r&&(i.TgZ(0,"div")(1,"h1",73),i._uU(2,"Benvenuto"),i.qZA(),i.TgZ(3,"h3",73),i._uU(4,"sei uno dei nostri!"),i.qZA(),i.TgZ(5,"div",73),i._UZ(6,"img",74),i.qZA()())}function K(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",75)(1,"ion-button",76),i.NdJ("click",function(){return i.CHM(e),i.oxw().onClickFooterAvanti()}),i._uU(2," ACCEDI "),i.qZA()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("color",e.colorButton)("disabled",!e.formLogin.valid)}}function j(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",77)(1,"ion-button",76),i.NdJ("click",function(){return i.CHM(e),i.oxw().onClickFooterAvanti()}),i._uU(2,"Avanti"),i.qZA()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("color",e.colorButton)("disabled",!e.formContact.valid)}}function $(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",78)(1,"ion-button",76),i.NdJ("click",function(){return i.CHM(e),i.oxw().onClickFooterAvanti()}),i._uU(2," Verifica "),i.qZA()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("color",e.colorButton)("disabled",!e.isEnableAvantiOnVerify())}}function ii(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",79)(1,"ion-button",76),i.NdJ("click",function(){return i.CHM(e),i.oxw().onClickFooterAvanti()}),i._uU(2," Registrati "),i.qZA()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("color",e.colorButton)("disabled",!e.formRegister.valid)}}function ei(r,f){if(1&r){const e=i.EpF();i.TgZ(0,"div",80)(1,"ion-button",81),i.NdJ("click",function(){return i.CHM(e),i.oxw().closeModal()}),i._uU(2," Inizia "),i.qZA()()}if(2&r){const e=i.oxw();i.xp6(1),i.Q6J("color",e.colorButton)}}let ti=(()=>{class r{constructor(e,o,n,p,P,S){this.modalCtrl=e,this.startService=o,this.loadingCtrl=n,this.toastCtrl=p,this.alertCtrl=P,this.cryptoService=S,this.pageState=C,this.tipoVerifica=h.Xo,this.actualStatePage=C.LOGIN,this.actualStateSegment=C.LOGIN,this.stepRegistration=[],this.indexStepRegistration=0,this.docRichiestaCodici=new t.lA,this.registrationInApp=!1,this.docUtente=new T.oD,this.emailVerificationYES=!1,this.smsVerificationYES=!1,this.emailVerificata="",this.telVerificato="",this.colorButton="tertiary",this.indexStepRegistration=0,this.actualStatePage=C.LOGIN,this.actualStateSegment=C.LOGIN,this.startListen=o.startConfig.subscribe(k=>{this.startConfig=k,this.startConfig&&this.startConfig.gruppo&&(this.docGruppo=this.startConfig.gruppo,this.registrationInApp=this.startConfig.gruppo.APPFLAGREGISTRAZIONE,this.createArrayStepRegistration(this.docGruppo))}),this.docArea=this.startService.areaSelectedValue}ngOnInit(){this.createLoginForm(),this.createRegisterForm(),this.createVerifyForm(),this.createContactForm(),this.isDesktop=this.startService.isDesktop}getCaptionTitle(){let e;return e=this.actualStateSegment==C.LOGIN?"Login":"Nuovo Account",e}onSegmentChanged(e){this.actualStatePage=e.detail.value==C.LOGIN?C.LOGIN:this.stepRegistration[this.indexStepRegistration]}createArrayStepRegistration(e){this.stepRegistration=[],1==e.APPFLAGREGISTRAZIONE&&(this.stepRegistration.push(C.CONTACT),e.APPTIPOVERIFICA!==h.Xo.noverifica&&this.stepRegistration.push(C.VERIFY),this.stepRegistration.push(C.REGISTRATION),this.stepRegistration.push(C.WELCOME))}nextStepRegistration(e=!1){if(this.indexStepRegistration+1<this.stepRegistration.length)for(let o=this.indexStepRegistration+1;o<this.stepRegistration.length;o++){let n=!0;const p=this.stepRegistration[o];if(e&&p==C.VERIFY&&(n=!1),n){this.indexStepRegistration=o,this.actualStatePage=p;break}}}backStepRegistration(){if(this.indexStepRegistration-1>=0)for(let e=this.indexStepRegistration-1;e>=0;e--){const o=this.stepRegistration[e];this.indexStepRegistration=e,this.actualStatePage=o;break}}closeModal(){this.modalCtrl.dismiss()}onClickFooterAvanti(){switch(this.actualStatePage){case C.LOGIN:this.onClickLogin();break;case C.CONTACT:this.onClickAvantiContact();break;case C.VERIFY:this.onClickAvantiVerifica();break;case C.REGISTRATION:this.onClickRegistrati()}}onClickLogin(){this.formLogin.valid&&this.loadingCtrl.create({message:"Controllo credenziali"}).then(e=>{e.present(),this.startService.userLogin(this.formLogin.value.username,this.formLogin.value.password).then(o=>{e.dismiss(),o.result?(this.startService.saveStorageUtente(this.formLogin.value.username,this.formLogin.value.password),this.formLogin.reset(),this.closeModal()):this.showMessage(o.message)}).catch(o=>{e.dismiss(),console.log(o),this.showMessage(o)})})}onClickReimpostaPsw(){this.modalCtrl.create({component:m.w}).then(e=>{e.present(),this.modalCtrl.dismiss()})}onClickAvantiContact(){let e=this.formContact.value.email,o=this.formContact.value.telephone,n=!0,p=!1,P="";if(this.docGruppo.APPTIPOVERIFICA==h.Xo.noverifica)this.emailVerificationYES=!0,this.smsVerificationYES=!0,n=!1,p=!0,this.docRichiestaCodici.REQUESTSMSCODE=!1,this.docRichiestaCodici.REQUESTEMAILCODE=!1;else{switch(this.docGruppo.APPTIPOVERIFICA){case h.Xo.verificaemail:this.emailVerificationYES&&this.emailVerificata==e?(n=!1,p=!0,this.docRichiestaCodici.REQUESTEMAILCODE=!1):(n=!0,p=!0,this.docRichiestaCodici.REQUESTEMAILCODE=!0,this.docRichiestaCodici.EMAIL=e);break;case h.Xo.verificaemailsms:this.emailVerificationYES&&this.emailVerificata==e&&this.smsVerificationYES&&this.telVerificato==o?(n=!1,p=!0,this.docRichiestaCodici.REQUESTEMAILCODE=!1,this.docRichiestaCodici.REQUESTSMSCODE=!1):(n=!0,p=!0,(0==this.emailVerificationYES||this.emailVerificata!==e)&&(this.docRichiestaCodici.REQUESTEMAILCODE=!0,this.docRichiestaCodici.EMAIL=e),(0==this.smsVerificationYES||this.telVerificato!==o)&&(this.docRichiestaCodici.REQUESTSMSCODE=!0,this.docRichiestaCodici.TELEPHONE=o));break;case h.Xo.verificasms:this.smsVerificationYES&&this.telVerificato==o?(n=!1,p=!0,this.docRichiestaCodici.REQUESTSMSCODE=!1):(n=!0,p=!0,this.docRichiestaCodici.REQUESTSMSCODE=!0,this.docRichiestaCodici.TELEPHONE=o);break;default:p=!1,P="Ops..qualcosa \xe8 andato storto"}p?n?this.sendServerRichiestaCodici():this.nextStepRegistration(!0):this.showMessage(P)}}sendServerRichiestaCodici(e=!0,o){this.loadingCtrl.create({message:"Invio Codici in corso..."}).then(n=>{n.present(),this.docRichiestaCodici.IDAREA=this.docArea.ID,this.docRichiestaCodici.USE=h.I4.forRegistration,this.startService.registrationSendCodici(this.docRichiestaCodici).then(p=>{n.dismiss(),this.docRichiestaCodici.IDREFER=p.idRefer,this.docRichiestaCodici.REQUESTSMSCODE=!1,this.docRichiestaCodici.REQUESTEMAILCODE=!1,e&&this.nextStepRegistration(!1),o&&0!==o.length&&this.showMessage(o)}).catch(p=>{n.dismiss(),this.showMessage(p)})})}onClickReinviaCodice(e){let o="",n=!1,p=!1;if(this.docRichiestaCodici){switch(o="Verr\xe0 inviato un nuovo codice a ",e){case h.Xo.verificaemail:o+=this.docRichiestaCodici.EMAIL,n=!0;break;case h.Xo.verificasms:o+=this.docRichiestaCodici.TELEPHONE,p=!0}this.alertCtrl.create({header:"Reinvio pincode",message:o,buttons:[{text:"Annulla",role:"cancel"},{text:"Reinvia",handler:()=>{this.docRichiestaCodici.REQUESTEMAILCODE=n,this.docRichiestaCodici.REQUESTSMSCODE=p,this.sendServerRichiestaCodici(!1,"Codice reinviato con successo")}}]}).then(P=>{P.present()})}}onClickAvantiVerifica(){let n,e=this.isEnableAvantiOnVerify(),o="";e?this.docRichiestaCodici&&this.docRichiestaCodici.IDREFER&&0!==this.docRichiestaCodici.IDREFER.length?(n=new t.Rx,n.IDAREA=this.docRichiestaCodici.IDAREA,n.IDREFER=this.docRichiestaCodici.IDREFER,(this.docGruppo.APPTIPOVERIFICA==h.Xo.verificaemail||this.docGruppo.APPTIPOVERIFICA==h.Xo.verificaemailsms)&&(n.EMAILPINCODE=this.getInputVerifyCode(h.Xo.verificaemail)),(this.docGruppo.APPTIPOVERIFICA==h.Xo.verificasms||this.docGruppo.APPTIPOVERIFICA==h.Xo.verificaemailsms)&&(n.SMSPINCODE=this.getInputVerifyCode(h.Xo.verificasms)),this.sendServerVerificaCodici(n)):(e=!1,o="Errore: Richiedere il reinvio"):o="Controllare i dati inseriti",e||this.showMessage(o)}sendServerVerificaCodici(e){e&&this.loadingCtrl.create({message:"Verifica Codici"}).then(o=>{o.present(),this.startService.registrationVerifyCodici(e).then(n=>{o.dismiss(),n.result?(this.emailVerificationYES=!0,this.emailVerificata=this.docRichiestaCodici.EMAIL,this.smsVerificationYES=!0,this.telVerificato=this.docRichiestaCodici.TELEPHONE,this.nextStepRegistration()):(this.emailVerificationYES=!1,this.emailVerificata="",this.smsVerificationYES=!1,this.telVerificato="")}).catch(n=>{o.dismiss(),this.showMessage(n)})})}onClickRegistrati(){let e;this.formRegister.valid&&(e=this.formRegister.value.codFisc,e=e.toUpperCase(),this.loadingCtrl.create({message:"Check Codice Fiscale"}).then(o=>{o.present(),this.startService.checkCodiceFiscale(e,!0,!0).then(n=>{o.dismiss(),n.checkValidate?this.execRegistrati(n):this.showMessage(n.msgValidate)}).catch(n=>{o.dismiss(),this.showMessage(n.msgValidate)})}))}execRegistrati(e){let o="",n="",p=[],P=!1;this.docUtente.NOME=this.formRegister.value.name,this.docUtente.COGNOME=this.formRegister.value.surname,P=!1,o=this.formRegister.value.psw,n=o,p=this.cryptoService.mySplitPassword(n),p?(this.docRichiestaCodici.TOKEN=p[0],this.docUtente.INPUTPASSWORD=p[1],this.docUtente.SHAPASSWORD="",this.docUtente.CODICEFISCALE=e.codiceFiscale,this.docUtente.SESSO=e.sesso,this.docUtente.NATOIL=e.dataNascita,this.docUtente.NATOA=e.comune,this.docUtente.NATOCAP=e.cap,this.docUtente.NATOPROV=e.provincia,this.docUtente.NATOISOSTATO=e.stato,this.docUtente.WEBLOGIN=this.formContact.value.email,this.docUtente.EMAIL=this.formContact.value.email,this.docUtente.MOBILENUMBER=this.formContact.value.telephone,this.docUtente.NEWSLETTER=1==this.formRegister.value.chkNewsletter,this.loadingCtrl.create({message:"Registrazione"}).then(S=>{S.present(),this.startService.registrationFinalize(this.docUtente,this.docRichiestaCodici).then(k=>{S.dismiss(),this.nextStepRegistration(),this.loginAfterRegister(this.docUtente.WEBLOGIN,o)}).catch(k=>{S.dismiss(),this.showMessage(k)})})):this.showMessage("Dati non corretti")}loginAfterRegister(e,o){e&&o&&this.startService.userLogin(e,o).then(n=>{n.result?this.startService.saveStorageUtente(e,o):this.showMessage(n.message)})}changeFocus(e){switch(e.target.id){case"1":this.c2.setFocus();break;case"2":this.c3.setFocus();break;case"3":this.c4.setFocus();break;case"4":this.c5.setFocus();break;case"6":this.c7.setFocus();break;case"7":this.c8.setFocus();break;case"8":this.c9.setFocus();break;case"9":this.c10.setFocus()}}onClickInizia(){this.modalCtrl.dismiss()}createLoginForm(){this.formLogin=new a.cw({username:new a.NI(null,{updateOn:"change",validators:[a.kI.required]}),password:new a.NI(null,{updateOn:"change",validators:[a.kI.required]})})}createContactForm(){this.formContact=new a.cw({email:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.email]}),telephone:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.pattern("^[+]*[0-9]*")]})})}createRegisterForm(){this.formRegister=new a.cw({name:new a.NI(null,{updateOn:"change",validators:[a.kI.required]}),surname:new a.NI(null,{updateOn:"change",validators:[a.kI.required]}),psw:new a.NI(null,{updateOn:"change",validators:[a.kI.required]}),verifyPsw:new a.NI(null,{updateOn:"change",validators:[a.kI.required]}),codFisc:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.pattern("^[A-Za-z]{6}[0-9]{2}[A-Za-z]{1}[0-9]{2}[A-Za-z]{1}[0-9]{3}[A-Za-z]{1}")]}),chkPrivacy:new a.NI(!1,{updateOn:"change",validators:[this.isPolicyLink()?a.kI.requiredTrue:a.kI.nullValidator]}),chkNewsletter:new a.NI(!0,{updateOn:"change",validators:[]})},[this.pswValidator])}pswValidator(e){if(e.get("verifyPsw").value!=e.get("psw").value)return{invalid:!0}}createVerifyForm(){this.formVerifyMail=new a.cw({c1:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c2:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c3:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c4:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c5:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]})}),this.formVerifyTel=new a.cw({c6:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c7:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c8:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c9:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]}),c10:new a.NI(null,{updateOn:"change",validators:[a.kI.required,a.kI.maxLength(1),a.kI.minLength(1)]})})}getInputVerifyCode(e){let o="";return e==h.Xo.verificaemail?o=this.formVerifyMail.value.c1+this.formVerifyMail.value.c2+this.formVerifyMail.value.c3+this.formVerifyMail.value.c4+this.formVerifyMail.value.c5:e==h.Xo.verificasms&&(o=this.formVerifyTel.value.c6+this.formVerifyTel.value.c7+this.formVerifyTel.value.c8+this.formVerifyTel.value.c9+this.formVerifyTel.value.c10),o}isEnableAvantiOnVerify(){let e=!0;if(this.docGruppo){if(this.docGruppo.APPTIPOVERIFICA!==h.Xo.noverifica)switch(this.docGruppo.APPTIPOVERIFICA){case h.Xo.verificaemail:e=this.formVerifyMail.valid;break;case h.Xo.verificasms:e=this.formVerifyTel.valid;break;case h.Xo.verificaemailsms:e=this.formVerifyTel.valid&&this.formVerifyMail.valid}}else e=!1;return e}isPolicyLink(){let e,o=!1;return this.docArea&&(e=this.docArea.findAreaLinkByPageType(h.GV.policyPrivacy),e&&e.REFERURL&&(o=!0)),o}openPolicyLink(){let e;this.docArea&&(e=this.docArea.findAreaLinkByPageType(h.GV.policyPrivacy),e&&e.REFERURL&&this.openLink(e.REFERURL))}openLink(e){E.A.open({url:e})}showMessage(e){return(0,M.mG)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e,duration:3e3})).present()})}}return r.\u0275fac=function(e){return new(e||r)(i.Y36(u.IN),i.Y36(l.D),i.Y36(u.HT),i.Y36(u.yF),i.Y36(u.Br),i.Y36(v.$))},r.\u0275cmp=i.Xpm({type:r,selectors:[["app-new-login"]],viewQuery:function(e,o){if(1&e&&(i.Gf(N,5),i.Gf(L,5),i.Gf(U,5),i.Gf(b,5),i.Gf(V,5),i.Gf(D,5),i.Gf(F,5),i.Gf(J,5),i.Gf(G,5),i.Gf(q,5)),2&e){let n;i.iGM(n=i.CRH())&&(o.c1=n.first),i.iGM(n=i.CRH())&&(o.c2=n.first),i.iGM(n=i.CRH())&&(o.c3=n.first),i.iGM(n=i.CRH())&&(o.c4=n.first),i.iGM(n=i.CRH())&&(o.c5=n.first),i.iGM(n=i.CRH())&&(o.c6=n.first),i.iGM(n=i.CRH())&&(o.c7=n.first),i.iGM(n=i.CRH())&&(o.c8=n.first),i.iGM(n=i.CRH())&&(o.c9=n.first),i.iGM(n=i.CRH())&&(o.c10=n.first)}},decls:24,vars:15,consts:[["color","primary"],["slot","start",4,"ngIf"],["slot","end"],["fill","clear",3,"click"],["name","close"],[3,"ngClass"],[3,"src"],["class","ion-padding",4,"ngIf"],["class","ion-padding-horizontal",4,"ngIf"],[4,"ngIf"],["id","footer-login",4,"ngIf"],["id","footer-contact",4,"ngIf"],["id","footer-verify",4,"ngIf"],["id","footer-registration",4,"ngIf"],["id","footer-welcome",4,"ngIf"],["slot","start"],["name","arrow-back"],[1,"ion-padding"],["color","primary","mode","md",3,"ngModel","ngModelChange","ionChange"],[3,"value"],[3,"value",4,"ngIf"],[3,"formGroup"],["slot","start","name","person-outline","color","primary"],["inputmode","email","type","email","placeholder","Email","formControlName","username","autocomplete","on"],["slot","start","name","key-outline","color","primary"],["inputmode","text","type","password","placeholder","Password","formControlName","password","autocomplete","current-password"],[1,"ion-text-center","ion-padding-vertical"],[3,"click"],[1,"ion-padding-horizontal"],["name","at-outline","slot","start","color","primary"],["type","email","placeholder","E-Mail","formControlName","email"],["name","call-outline","slot","start","color","primary"],["type","tel","inputmode","tel","placeholder","+39 Cellulare","formControlName","telephone"],["fill","outline","size","small","expand","block",3,"click",4,"ngIf"],["class","ion-no-padding div-message",4,"ngIf"],["fill","outline","size","small","expand","block",3,"click"],[1,"ion-no-padding","div-message"],["name","information-circle-outline"],["lines","none"],["slot","start","fill","clear","color","danger",3,"click"],["name","refresh-outline"],["color","default"],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c1","id","1",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c1",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c2","id","2",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c2",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c3","id","3",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c3",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c4","id","4",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c4",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c5","id","5",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c5",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c6","id","6",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c6",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c7","id","7",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c7",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c8","id","8",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c8",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c9","id","9",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c9",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c10","id","10",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c10",""],["name","person-outline","slot","start","color","primary"],["type","text","placeholder","Nome","formControlName","name"],["type","text","placeholder","Cognome","formControlName","surname"],["name","key-outline","slot","start","color","primary"],["type","password","placeholder","Password","formControlName","psw"],["type","password","placeholder","Verifica password","formControlName","verifyPsw"],["name","card-outline","slot","start","color","primary"],["type","text","placeholder","Codice Fiscale","formControlName","codFisc"],["lines","none",4,"ngIf"],["slot","start","color","primary","formControlName","chkNewsletter"],["slot","start","color","primary","formControlName","chkPrivacy"],[1,"ion-text-center"],["src","assets/img/handshake_b.gif"],["id","footer-login"],["expand","block",1,"btn-confirm",3,"color","disabled","click"],["id","footer-contact"],["id","footer-verify"],["id","footer-registration"],["id","footer-welcome"],["expand","block",1,"btn-confirm",3,"color","click"]],template:function(e,o){1&e&&(i.TgZ(0,"ion-header")(1,"ion-toolbar",0),i.YNc(2,Q,3,0,"ion-buttons",1),i.TgZ(3,"ion-title"),i._uU(4),i.qZA(),i.TgZ(5,"ion-buttons",2)(6,"ion-button",3),i.NdJ("click",function(){return o.closeModal()}),i._UZ(7,"ion-icon",4),i.qZA()()()(),i.TgZ(8,"ion-content")(9,"div",5),i._UZ(10,"img",6),i.qZA(),i.YNc(11,_,5,3,"div",7),i.YNc(12,w,12,1,"div",7),i.YNc(13,Z,14,6,"div",8),i.YNc(14,z,3,2,"div",9),i.YNc(15,W,35,2,"div",9),i.YNc(16,X,7,0,"div",9),i._UZ(17,"div"),i.qZA(),i.TgZ(18,"ion-footer"),i.YNc(19,K,3,2,"div",10),i.YNc(20,j,3,2,"div",11),i.YNc(21,$,3,2,"div",12),i.YNc(22,ii,3,2,"div",13),i.YNc(23,ei,3,1,"div",14),i.qZA()),2&e&&(i.xp6(2),i.Q6J("ngIf",o.actualStatePage==o.pageState.REGISTRATION||o.actualStatePage==o.pageState.VERIFY),i.xp6(2),i.Oqu(o.getCaptionTitle()),i.xp6(5),i.Q6J("ngClass",o.isDesktop?"ion-text-center div-logo desktop":"ion-text-center div-logo"),i.xp6(1),i.Q6J("src",o.startConfig.getUrlLogo(),i.LSH),i.xp6(1),i.Q6J("ngIf",o.actualStatePage!==o.pageState.WELCOME),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.LOGIN),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.CONTACT),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.VERIFY),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.REGISTRATION),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.WELCOME),i.xp6(3),i.Q6J("ngIf",o.actualStatePage==o.pageState.LOGIN),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.CONTACT),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.VERIFY),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.REGISTRATION),i.xp6(1),i.Q6J("ngIf",o.actualStatePage==o.pageState.WELCOME))},directives:[u.Gu,u.sr,R.O5,u.Sm,u.YG,u.gu,u.wd,u.W2,R.mk,u.cJ,u.QI,a.JJ,a.On,u.GO,a._Y,a.JL,a.sg,u.q_,u.Ie,u.pK,u.j9,a.u,u.yW,u.Q$,a.wO,a.nD,u.nz,u.w,u.fr],styles:["div.div-logo[_ngcontent-%COMP%]{background-color:#fff;padding-top:3vh;padding-bottom:3vh;margin-bottom:3vh}div.div-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:15vh}div.content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{background-color:var(--ion-color-medium)}div.div-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}div.div-logo.desktop[_ngcontent-%COMP%]{padding-top:1vh;padding-bottom:0vh;margin-bottom:0vh}div.form-verifica[_ngcontent-%COMP%]{width:320px;margin:auto;margin-bottom:8vh;text-align:center}div.form-verifica[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:white}div.form-verifica[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{display:inline;border-radius:15px;margin:2px;border:3px solid var(--ion-color-primary);text-align:center;font-family:Arial,Helvetica,sans-serif;color:var(--ion-color-medium);font-size:40px}div.form-verifica.desktop[_ngcontent-%COMP%]{margin-bottom:2vh}h6[_ngcontent-%COMP%]{font-size:small}a[_ngcontent-%COMP%], span.link[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:underline;cursor:pointer}"]}),r})();var C=(()=>{return(r=C||(C={}))[r.LOGIN=100]="LOGIN",r[r.CONTACT=210]="CONTACT",r[r.REGISTRATION=220]="REGISTRATION",r[r.VERIFY=230]="VERIFY",r[r.WELCOME=300]="WELCOME",C;var r})()},7217:(y,O,g)=>{g.d(O,{S:()=>i});var M=g(9808),a=g(4182),l=g(5362),T=g(2028),E=g(9662),h=g(2096);const t=[{path:"",component:E.w}];let m=(()=>{class u{}return u.\u0275fac=function(R){return new(R||u)},u.\u0275mod=h.oAB({type:u}),u.\u0275inj=h.cJS({imports:[[T.Bz.forChild(t)],T.Bz]}),u})(),i=(()=>{class u{}return u.\u0275fac=function(R){return new(R||u)},u.\u0275mod=h.oAB({type:u}),u.\u0275inj=h.cJS({imports:[[M.ez,l.Pc,m,a.u5,a.UX]]}),u})()},9662:(y,O,g)=>{g.d(O,{w:()=>Q});var M=g(655),a=g(1247),l=g(4182),T=g(2271),E=g(4021),h=g(5351),t=g(2096),m=g(5362),i=g(7652),u=g(9808);const v=["c1"],R=["c2"],N=["c3"],L=["c4"],U=["c5"];function b(_,w){1&_&&(t.TgZ(0,"span"),t._uU(1,"Indica una email o un numero cellulare utilizzato nella registrazione account, "),t._UZ(2,"br"),t._uU(3," e ti invieremo un pincode di recovery password"),t.qZA())}function V(_,w){1&_&&(t.TgZ(0,"span"),t._uU(1,"Indica una email utilizzata nella registrazione account, "),t._UZ(2,"br"),t._uU(3," e ti invieremo un pincode di recovery password"),t.qZA())}function D(_,w){1&_&&(t.TgZ(0,"span"),t._uU(1,"Indica un numero cellulare utilizzato nella registrazione account, "),t._UZ(2,"br"),t._uU(3," e ti invieremo un pincode di recovery password"),t.qZA())}function F(_,w){if(1&_){const s=t.EpF();t.TgZ(0,"div",9)(1,"form",10)(2,"ion-item"),t._UZ(3,"ion-icon",11)(4,"ion-input",12),t.qZA()(),t.TgZ(5,"ion-button",13),t.NdJ("click",function(){return t.CHM(s),t.oxw().onClickInviaCodice()}),t._uU(6," Invia Codice "),t.qZA(),t.TgZ(7,"div",14)(8,"p")(9,"span"),t._UZ(10,"ion-icon",15),t.qZA(),t.TgZ(11,"span"),t._uU(12,"\xa0"),t.qZA(),t.YNc(13,b,4,0,"span",8),t.YNc(14,V,4,0,"span",8),t.YNc(15,D,4,0,"span",8),t.qZA(),t.TgZ(16,"p")(17,"ion-text",16)(18,"span")(19,"i"),t._uU(20,"(contatta la struttura se non ricordi queste informazioni)"),t.qZA()()()()(),t.TgZ(21,"form",10)(22,"div",4)(23,"ion-segment")(24,"ion-input",17,18),t.NdJ("ionInput",function(d){return t.CHM(s),t.oxw().changeFocus(d)}),t.qZA(),t.TgZ(26,"ion-input",19,20),t.NdJ("ionInput",function(d){return t.CHM(s),t.oxw().changeFocus(d)}),t.qZA(),t.TgZ(28,"ion-input",21,22),t.NdJ("ionInput",function(d){return t.CHM(s),t.oxw().changeFocus(d)}),t.qZA(),t.TgZ(30,"ion-input",23,24),t.NdJ("ionInput",function(d){return t.CHM(s),t.oxw().changeFocus(d)}),t.qZA(),t.TgZ(32,"ion-input",25,26),t.NdJ("ionInput",function(d){return t.CHM(s),t.oxw().changeFocus(d)}),t.qZA()()()()()}if(2&_){const s=t.oxw();t.xp6(1),t.Q6J("formGroup",s.formContact),t.xp6(3),t.Q6J("placeholder",s.getPlaceHolder()),t.xp6(1),t.Q6J("disabled",!s.formContact.valid)("ngClass",s.isDesktop?"btn-send-code desktop":"btn-send-code"),t.xp6(8),t.Q6J("ngIf",s.canUseMail&&s.canUseMobile),t.xp6(1),t.Q6J("ngIf",s.canUseMail&&!s.canUseMobile),t.xp6(1),t.Q6J("ngIf",!s.canUseMail&&s.canUseMobile),t.xp6(6),t.Q6J("formGroup",s.formVerify),t.xp6(1),t.Q6J("ngClass",s.isDesktop?"form-verifica desktop":"form-verifica")}}function J(_,w){if(1&_&&(t.TgZ(0,"div",27)(1,"p"),t._UZ(2,"ion-icon",28),t._uU(3," Inserisci la nuova password per l'account "),t.qZA(),t.TgZ(4,"p")(5,"ion-text",0),t._uU(6),t.qZA()(),t.TgZ(7,"form",10)(8,"ion-list")(9,"ion-item"),t._UZ(10,"ion-icon",29)(11,"ion-input",30),t.qZA(),t.TgZ(12,"ion-item"),t._UZ(13,"ion-icon",29)(14,"ion-input",31),t.qZA()()()()),2&_){const s=t.oxw();t.xp6(6),t.hij(" ",s.descrUtente,""),t.xp6(1),t.Q6J("formGroup",s.formPsw)}}function G(_,w){if(1&_){const s=t.EpF();t.TgZ(0,"div")(1,"ion-button",32),t.NdJ("click",function(){return t.CHM(s),t.oxw().onClickVerifica()}),t._uU(2,"Verifica"),t.qZA()()}if(2&_){const s=t.oxw();t.xp6(1),t.Q6J("disabled",!s.formVerify.valid)}}function q(_,w){if(1&_){const s=t.EpF();t.TgZ(0,"div")(1,"ion-button",32),t.NdJ("click",function(){return t.CHM(s),t.oxw().onClickCambia()}),t._uU(2,"Cambia Password"),t.qZA()()}if(2&_){const s=t.oxw();t.xp6(1),t.Q6J("disabled",!s.formPsw.valid)}}let Q=(()=>{class _{constructor(s,c,d,I,A){this.modalController=s,this.startService=c,this.loadingController=d,this.toastController=I,this.cryptoService=A,this.canUseMail=!1,this.canUseMobile=!1,this.PageState=x,this.stato=x.richiestaCodice,this.docRichiestaCodici=new T.lA,this.docVerifica=new T.Rx,this.idUtente="",this.descrUtente=""}ngOnInit(){this.startConfig=this.startService.actualStartConfig,this.canUseMail=this.startConfig.gruppo.APPTIPOVERIFICA==E.Xo.noverifica||this.startConfig.gruppo.APPTIPOVERIFICA==E.Xo.verificaemail||this.startConfig.gruppo.APPTIPOVERIFICA==E.Xo.verificaemailsms,this.canUseMobile=this.startConfig.gruppo.APPTIPOVERIFICA==E.Xo.verificaemailsms||this.startConfig.gruppo.APPTIPOVERIFICA==E.Xo.verificasms,this.createVerifyForm(),this.createContactForm(),this.createPswForm()}close(){this.modalController.dismiss()}get isDesktop(){return this.startService.isDesktop}getPlaceHolder(){let s="";return this.canUseMail&&this.canUseMobile?s="Email o Cellulare":this.canUseMail&&!this.canUseMobile?s="Email":!this.canUseMail&&this.canUseMobile&&(s="Cellulare"),s}createVerifyForm(){this.formVerify=new l.cw({c1:new l.NI(null,{updateOn:"change",validators:[l.kI.required,l.kI.maxLength(1),l.kI.minLength(1)]}),c2:new l.NI(null,{updateOn:"change",validators:[l.kI.required,l.kI.maxLength(1),l.kI.minLength(1)]}),c3:new l.NI(null,{updateOn:"change",validators:[l.kI.required,l.kI.maxLength(1),l.kI.minLength(1)]}),c4:new l.NI(null,{updateOn:"change",validators:[l.kI.required,l.kI.maxLength(1),l.kI.minLength(1)]}),c5:new l.NI(null,{updateOn:"change",validators:[l.kI.required,l.kI.maxLength(1),l.kI.minLength(1)]})})}createContactForm(){let s=[l.kI.required];this.canUseMail&&this.canUseMobile||(this.canUseMail?s.push(l.kI.email):this.canUseMobile&&s.push(l.kI.pattern(/^(\+\d{1,3}[- ]?)?\d{10}$/))),this.formContact=new l.cw({contatto:new l.NI(null,{updateOn:"change",validators:s})})}createPswForm(){this.formPsw=new l.cw({psw:new l.NI(null,{updateOn:"change",validators:[l.kI.required]}),confirmPsw:new l.NI(null,{updateOn:"change",validators:[l.kI.required]})},this.pswValidator)}pswValidator(s){if(s.get("confirmPsw").value!=s.get("psw").value)return{invalid:!0}}changeFocus(s){switch(s.target.id){case"1":this.c2.setFocus();break;case"2":this.c3.setFocus();break;case"3":this.c4.setFocus();break;case"4":this.c5.setFocus()}}onClickInviaCodice(){this.sendServerRichiestaCodici()}onClickVerifica(){let s=!0,c="";this.docRichiestaCodici&&this.docRichiestaCodici.IDREFER&&0!=this.docRichiestaCodici.IDREFER.length?(this.docVerifica=new T.Rx,this.docVerifica.IDREFER=this.docRichiestaCodici.IDREFER,this.docVerifica.IDAREA=this.docRichiestaCodici.IDAREA,this.docRichiestaCodici.REQUESTEMAILCODE?this.docVerifica.EMAILPINCODE=this.getInputPin():this.docRichiestaCodici.REQUESTSMSCODE?this.docVerifica.SMSPINCODE=this.getInputPin():(s=!1,c="C'\xe8 stato un problema, richiedi un nuovo codice")):(s=!1,c="C'\xe8 stato un problema, richiedi un nuovo codice"),s?this.sendServerVerificaCodici():this.showMessage(c)}onClickCambia(){let s=this.docRichiestaCodici,c=new h.oD,d="",I="",A=[];c.ID=this.idUtente,d=this.formPsw.value.psw,I=d,A=this.cryptoService.mySplitPassword(I),A?(s.TOKEN=A[0],c.INPUTPASSWORD=A[1],c.SHAPASSWORD="",this.sendServerFinalize(c,s)):this.showMessage("Password non utilizzabile")}sendServerRichiestaCodici(){this.loadingController.create({message:"Invio codice in corso...",spinner:"circular",backdropDismiss:!0}).then(s=>{let c;s.present(),c=this.formContact.value.contatto,c.includes("@")?(this.docRichiestaCodici.EMAIL=c,this.docRichiestaCodici.TELEPHONE="",this.docRichiestaCodici.REQUESTEMAILCODE=!0,this.docRichiestaCodici.REQUESTSMSCODE=!1):(this.docRichiestaCodici.TELEPHONE=c,this.docRichiestaCodici.EMAIL="",this.docRichiestaCodici.REQUESTSMSCODE=!0,this.docRichiestaCodici.REQUESTEMAILCODE=!1),this.docRichiestaCodici.USE=E.I4.forRecovery,this.docRichiestaCodici.IDAREA=this.startService.areaSelectedValue.ID,this.startService.recoverySendCodici(this.docRichiestaCodici).then(d=>{s.dismiss(),d.result?(this.showMessage(d.message),this.docRichiestaCodici.IDREFER=d.idRefer):(this.showMessage(d.message),this.docRichiestaCodici.IDREFER="",console.log(d.message))}).catch(d=>{s.dismiss(),console.log(d),this.showMessage("Errore di connessione"),this.docRichiestaCodici.IDREFER=""})})}sendServerVerificaCodici(){this.docVerifica&&this.loadingController.create({message:"Verifica in corso...",spinner:"circular",backdropDismiss:!0}).then(s=>{s.present(),this.startService.recoveryVerifyCodici(this.docVerifica).then(c=>{s.dismiss(),c.result?(this.idUtente=c.idRefer,this.descrUtente=c.descrRefer,this.stato=x.cambioPsw,this.showMessage("Codice di verifica valido")):(this.idUtente="",this.showMessage("Codice di verifica non valido"))}).catch(c=>{s.dismiss(),this.idUtente="",console.log(c),this.showMessage("Errore di connessione")})})}sendServerFinalize(s,c){this.loadingController.create({message:"Cambio password",spinner:"circular",backdropDismiss:!0}).then(d=>{d.present(),this.startService.recoveryFinalize(s,c).then(I=>{d.dismiss(),I.result?(this.showMessage("Modifica della password confermata"),this.modalController.dismiss()):(this.showMessage(I.message),console.log(I.message))}).catch(I=>{d.dismiss(),console.log(I),this.showMessage("Errore di connessione")})})}showMessage(s){return(0,M.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:s,duration:3e3})).present()})}getInputPin(){return this.formVerify.value.c1+this.formVerify.value.c2+this.formVerify.value.c3+this.formVerify.value.c4+this.formVerify.value.c5}}return _.\u0275fac=function(s){return new(s||_)(t.Y36(m.IN),t.Y36(a.D),t.Y36(m.HT),t.Y36(m.yF),t.Y36(i.$))},_.\u0275cmp=t.Xpm({type:_,selectors:[["app-psw-recovery"]],viewQuery:function(s,c){if(1&s&&(t.Gf(v,5),t.Gf(R,5),t.Gf(N,5),t.Gf(L,5),t.Gf(U,5)),2&s){let d;t.iGM(d=t.CRH())&&(c.c1=d.first),t.iGM(d=t.CRH())&&(c.c2=d.first),t.iGM(d=t.CRH())&&(c.c3=d.first),t.iGM(d=t.CRH())&&(c.c4=d.first),t.iGM(d=t.CRH())&&(c.c5=d.first)}},decls:15,vars:6,consts:[["color","primary"],["slot","end"],[3,"click"],["name","close"],[3,"ngClass"],[3,"src"],["class","ion-padding-horizontal ion-text-center",4,"ngIf"],["class","ion-padding div-psw",4,"ngIf"],[4,"ngIf"],[1,"ion-padding-horizontal","ion-text-center"],[3,"formGroup"],["slot","start","name","at-outline"],["type","text","formControlName","contatto",3,"placeholder"],["color","primary",3,"disabled","ngClass","click"],[1,"ion-no-padding","div-message"],["name","information-circle-outline"],["color","danger"],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c1","id","1",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c1",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c2","id","2",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c2",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c3","id","3",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c3",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c4","id","4",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c4",""],["clearOnEdit","","type","tel","inputmode","numeric","minlength","1","maxlength","1","formControlName","c5","id","5",1,"ion-no-padding","ion-align-self-center",3,"ionInput"],["c5",""],[1,"ion-padding","div-psw"],["color","primary","name","information-circle-outline"],["slot","start","name","lock-closed-outline"],["placeholder","Nuova password","type","password","inputmode","password","formControlName","psw"],["placeholder","Conferma Password","type","password","inputmode","password","formControlName","confirmPsw"],["color","primary","expand","block",3,"disabled","click"]],template:function(s,c){1&s&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t._uU(3,"Recupero password"),t.qZA(),t.TgZ(4,"ion-buttons",1)(5,"ion-button",2),t.NdJ("click",function(){return c.close()}),t._UZ(6,"ion-icon",3),t.qZA()()()(),t.TgZ(7,"ion-content")(8,"div",4),t._UZ(9,"img",5),t.qZA(),t.YNc(10,F,34,9,"div",6),t.YNc(11,J,15,2,"div",7),t.qZA(),t.TgZ(12,"ion-footer"),t.YNc(13,G,3,1,"div",8),t.YNc(14,q,3,1,"div",8),t.qZA()),2&s&&(t.xp6(8),t.Q6J("ngClass",c.isDesktop?"ion-text-center div-logo desktop":"ion-text-center div-logo"),t.xp6(1),t.Q6J("src",c.startConfig.getUrlLogo(),t.LSH),t.xp6(1),t.Q6J("ngIf",c.stato==c.PageState.richiestaCodice),t.xp6(1),t.Q6J("ngIf",c.stato==c.PageState.cambioPsw),t.xp6(2),t.Q6J("ngIf",c.stato==c.PageState.richiestaCodice),t.xp6(1),t.Q6J("ngIf",c.stato==c.PageState.cambioPsw))},directives:[m.Gu,m.sr,m.wd,m.Sm,m.YG,m.gu,m.W2,u.mk,u.O5,l._Y,l.JL,l.sg,m.Ie,m.pK,m.j9,l.JJ,l.u,m.yW,m.cJ,m.QI,l.wO,l.nD,m.q_,m.fr],styles:["div.div-logo[_ngcontent-%COMP%]{background-color:#fff;padding-top:3vh;padding-bottom:3vh;margin-bottom:3vh}div.div-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:15vh}div.div-logo.desktop[_ngcontent-%COMP%]{margin-bottom:0vh}div.div-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}div.div-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}div.form-verifica[_ngcontent-%COMP%]{width:320px;margin:auto;margin-bottom:8vh;text-align:center}div.form-verifica[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:white}div.form-verifica[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{display:inline;border-radius:15px;margin:2px;border:3px solid var(--ion-color-primary);text-align:center;font-family:Arial,Helvetica,sans-serif;color:var(--ion-color-medium);font-size:40px}div.form-verifica.desktop[_ngcontent-%COMP%]{margin-bottom:2vh}ion-button.btn-send-code[_ngcontent-%COMP%]{margin-top:5vh;margin-bottom:5vh}ion-button.btn-send-code.desktop[_ngcontent-%COMP%]{margin-top:3vh;margin-bottom:1vh}div.ion-padding[_ngcontent-%COMP%]{margin-top:5vh}div.div-psw[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}"]}),_})();var x=(()=>{return(_=x||(x={}))[_.richiestaCodice=10]="richiestaCodice",_[_.cambioPsw=20]="cambioPsw",x;var _})()}}]);