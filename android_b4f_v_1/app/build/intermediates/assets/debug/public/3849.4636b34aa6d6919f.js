"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3849],{13849:(j,u,c)=>{c.r(u),c.d(u,{DetailPresenzaPageModule:()=>V});var _=c(69808),g=c(52382),r=c(7706),d=c(2840),p=c(69214),P=c(69129),m=c(59442),f=c(34021),h=c(75822),e=c(31223);function T(n,a){if(1&n&&(e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e._uU(3,"Spiacenti"),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-card-content")(7,"p"),e._uU(8,"Non \xe8 possibile operare con le presenze"),e.qZA()()()),2&n){const i=e.oxw(2);e.xp6(5),e.Oqu(i.messageError)}}function E(n,a){1&n&&(e.TgZ(0,"ion-item",21)(1,"ion-label"),e._uU(2,"Scheda Presenze Bloccata"),e.qZA()())}function x(n,a){if(1&n){const i=e.EpF();e.TgZ(0,"ion-button",22),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(3);return e.KtG(o.onSubmit())}),e._uU(1," Conferma Presenze "),e.qZA()}}function z(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"ion-item",14),e._UZ(2,"ion-icon",15),e.TgZ(3,"ion-label",16)(4,"h2"),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"h2"),e._uU(8),e.ALo(9,"date"),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"h1"),e._uU(12),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.ALo(15,"titlecase"),e.ALo(16,"titlecase"),e.qZA()()(),e.TgZ(17,"ion-item",14)(18,"p",17),e._UZ(19,"ion-icon",18),e._uU(20),e.qZA()(),e.YNc(21,E,3,0,"ion-item",19),e.YNc(22,x,2,0,"ion-button",20),e.qZA()),2&n){const i=e.oxw(2);e.xp6(5),e.Oqu(e.xi3(6,8,i.pianificazioneDoc.DATAORAINIZIO,"EEEE dd/MM/yyyy ")),e.xp6(3),e.AsE("",e.xi3(9,11,i.pianificazioneDoc.DATAORAINIZIO,"H.mm")," - ",e.xi3(10,14,i.pianificazioneDoc.DATAORAFINE,"H.mm"),""),e.xp6(4),e.Oqu(i.pianificazioneDoc._DENOMINAZIONE_Corso),e.xp6(2),e.Oqu(e.lcZ(15,17,i.pianificazioneDoc._DENOMINAZIONE_Location)+" - "+e.lcZ(16,19,i.pianificazioneDoc._DENOMINAZIONE_Campo)),e.xp6(6),e.hij(" ",i.pianificazioneDoc.msgCanUpdatePresenze(i.gapAggiornamentoPresenze)," "),e.xp6(1),e.Q6J("ngIf",!i.canUpdate),e.xp6(1),e.Q6J("ngIf",i.canUpdate)}}function A(n,a){if(1&n){const i=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-button",23),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.setAllPresenze(!0))}),e._UZ(3,"ion-icon",24),e._uU(4," Segna presenti "),e.qZA()(),e.TgZ(5,"ion-col")(6,"ion-button",25),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.setAllPresenze(!1))}),e._UZ(7,"ion-icon",26),e._uU(8," Segna assenti "),e.qZA()()()}}function Z(n,a){1&n&&(e.TgZ(0,"ion-item"),e._uU(1," Nessun iscritto al corso "),e.qZA())}function N(n,a){1&n&&e._UZ(0,"ion-icon",33)}function D(n,a){1&n&&e._UZ(0,"ion-icon",34)}function I(n,a){1&n&&e._UZ(0,"ion-icon",35)}function C(n,a){if(1&n&&(e.TgZ(0,"h4"),e._uU(1," Certificato medico: "),e.TgZ(2,"ion-badge",36),e._uU(3),e.ALo(4,"date"),e.qZA()()),2&n){const i=e.oxw().$implicit,t=e.oxw(3);e.xp6(2),e.Q6J("color",t.getColoreCertificato(i)),e.xp6(1),e.hij(" ",i.DATACERTIFICATOMEDICO?e.xi3(4,2,i.DATACERTIFICATOMEDICO,"dd/MM/yyyy"):"Non consegnato"," ")}}function w(n,a){if(1&n&&(e.TgZ(0,"ion-badge",37),e._uU(1),e.qZA()),2&n){const i=e.oxw().$implicit;e.Q6J("color",i.PRESENTE?"primary":"danger"),e.xp6(1),e.hij(" ",i.PRESENTE?"Presente":"Assente"," ")}}function M(n,a){if(1&n){const i=e.EpF();e.TgZ(0,"ion-item",28),e.NdJ("click",function(){const s=e.CHM(i).$implicit,l=e.oxw(3);return e.KtG(l.pianificazioneDoc.canUpdatePresenze(l.gapAggiornamentoPresenze)?l.onClickElement(s):{})}),e.YNc(1,N,1,0,"ion-icon",29),e.YNc(2,D,1,0,"ion-icon",30),e.YNc(3,I,1,0,"ion-icon",31),e.TgZ(4,"ion-label")(5,"h2"),e._uU(6),e.qZA(),e.YNc(7,C,5,5,"h4",6),e.qZA(),e.YNc(8,w,2,2,"ion-badge",32),e.qZA()}if(2&n){const i=a.$implicit,t=e.oxw(3);e.Q6J("button",t.pianificazioneDoc.canUpdatePresenze(t.gapAggiornamentoPresenze)),e.xp6(1),e.Q6J("ngIf",1==i.PRESENTE),e.xp6(1),e.Q6J("ngIf",0==i.PRESENTE),e.xp6(1),e.Q6J("ngIf",1!=i.PRESENTE&&0!=i.PRESENTE),e.xp6(3),e.Oqu(i.NOMINATIVO),e.xp6(1),e.Q6J("ngIf",t.tipoSocieta==t.TipoSocieta.sportiva),e.xp6(1),e.Q6J("ngIf",null!=i.PRESENTE&&null!=i.PRESENTE&&t.isDesktop)}}function O(n,a){1&n&&e._UZ(0,"ion-icon",33)}function S(n,a){1&n&&e._UZ(0,"ion-icon",34)}function U(n,a){1&n&&e._UZ(0,"ion-icon",35)}function b(n,a){if(1&n&&(e.TgZ(0,"h4"),e._uU(1," Certificato medico: "),e.TgZ(2,"ion-badge",36),e._uU(3),e.ALo(4,"date"),e.qZA()()),2&n){const i=e.oxw().$implicit,t=e.oxw(4);e.xp6(2),e.Q6J("color",t.getColoreCertificato(i)),e.xp6(1),e.hij(" ",i.DATACERTIFICATOMEDICO?e.xi3(4,2,i.DATACERTIFICATOMEDICO,"dd/MM/yyyy"):"Non consegnato"," ")}}function R(n,a){if(1&n&&(e.TgZ(0,"ion-badge",37),e._uU(1),e.qZA()),2&n){const i=e.oxw().$implicit;e.Q6J("color",i.PRESENTE?"primary":"danger"),e.xp6(1),e.hij(" ",i.PRESENTE?"Presente":"Assente"," ")}}function v(n,a){if(1&n){const i=e.EpF();e.TgZ(0,"ion-item",28),e.NdJ("click",function(){const s=e.CHM(i).$implicit,l=e.oxw(4);return e.KtG(l.pianificazioneDoc.canUpdatePresenze(l.gapAggiornamentoPresenze)?l.onClickElement(s):{})}),e.YNc(1,O,1,0,"ion-icon",29),e.YNc(2,S,1,0,"ion-icon",30),e.YNc(3,U,1,0,"ion-icon",31),e.TgZ(4,"ion-label")(5,"h2"),e._uU(6),e.qZA(),e.YNc(7,b,5,5,"h4",6),e.qZA(),e.YNc(8,R,2,2,"ion-badge",32),e.qZA()}if(2&n){const i=a.$implicit,t=e.oxw(4);e.Q6J("button",t.pianificazioneDoc.canUpdatePresenze(t.gapAggiornamentoPresenze)),e.xp6(1),e.Q6J("ngIf",1==i.PRESENTE),e.xp6(1),e.Q6J("ngIf",0==i.PRESENTE),e.xp6(1),e.Q6J("ngIf",1!=i.PRESENTE&&0!=i.PRESENTE),e.xp6(3),e.Oqu(i.NOMINATIVO),e.xp6(1),e.Q6J("ngIf",t.tipoSocieta==t.TipoSocieta.sportiva),e.xp6(1),e.Q6J("ngIf",null!=i.PRESENTE&&null!=i.PRESENTE&&t.isDesktop)}}function J(n,a){if(1&n&&(e.TgZ(0,"ion-list")(1,"ion-list-header"),e._uU(2," In Prova "),e.qZA(),e.YNc(3,v,9,7,"ion-item",27),e.qZA()),2&n){const i=e.oxw(3);e.xp6(3),e.Q6J("ngForOf",i.listPresenzeInProva)}}function y(n,a){if(1&n&&(e.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-list")(3,"ion-list-header"),e._uU(4," Partecipanti "),e.qZA(),e.YNc(5,Z,2,0,"ion-item",6),e.YNc(6,M,9,7,"ion-item",27),e.qZA(),e.YNc(7,J,4,1,"ion-list",6),e.qZA()()),2&n){const i=e.oxw(2);e.xp6(5),e.Q6J("ngIf",0==i.listPresenzeConfermate.length),e.xp6(1),e.Q6J("ngForOf",i.listPresenzeConfermate),e.xp6(1),e.Q6J("ngIf",i.listPresenzeInProva.length>0)}}function q(n,a){1&n&&(e.TgZ(0,"ion-item")(1,"ion-label",16),e._uU(2," Non \xe8 possibile aggiornare le note "),e.qZA()())}function Q(n,a){if(1&n&&(e.TgZ(0,"ion-label",16),e._uU(1),e.qZA()),2&n){const i=e.oxw(3);e.xp6(1),e.hij(" ",i.pianificazioneDoc.NOTETRAINER," ")}}function k(n,a){if(1&n){const i=e.EpF();e.TgZ(0,"ion-textarea",41),e.NdJ("ngModelChange",function(o){e.CHM(i);const s=e.oxw(3);return e.KtG(s.pianificazioneDoc.NOTETRAINER=o)}),e.qZA()}if(2&n){const i=e.oxw(3);e.Q6J("ngModel",i.pianificazioneDoc.NOTETRAINER)}}function Y(n,a){if(1&n&&(e.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-list")(3,"ion-list-header",38),e._uU(4," Alla segreteria "),e.qZA(),e.YNc(5,q,3,0,"ion-item",6),e.TgZ(6,"ion-item"),e.YNc(7,Q,2,1,"ion-label",39),e.YNc(8,k,1,1,"ion-textarea",40),e.qZA()()()()),2&n){const i=e.oxw(2);e.xp6(5),e.Q6J("ngIf",!i.canUpdate&&!i.containNoteTrainer),e.xp6(2),e.Q6J("ngIf",!i.canUpdate&&i.containNoteTrainer),e.xp6(1),e.Q6J("ngIf",i.canUpdate)}}function F(n,a){if(1&n&&(e.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-list")(3,"ion-list-header",38),e._uU(4," Ricevute dalla segreteria "),e.qZA(),e.TgZ(5,"ion-item"),e._UZ(6,"ion-icon",42),e.TgZ(7,"ion-label",16)(8,"p"),e._uU(9),e.qZA()()()()()()),2&n){const i=e.oxw(2);e.xp6(9),e.hij(" ",i.pianificazioneDoc.NOTEADMIN," ")}}function G(n,a){if(1&n){const i=e.EpF();e.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",7),e.YNc(3,T,9,1,"ion-card",6),e.YNc(4,z,23,21,"div",8),e.TgZ(5,"ion-segment",9),e.NdJ("ngModelChange",function(o){e.CHM(i);const s=e.oxw();return e.KtG(s.selectedView=o)}),e.TgZ(6,"ion-segment-button",10),e._UZ(7,"ion-icon",11),e.TgZ(8,"ion-label"),e._uU(9,"Presenze"),e.qZA()(),e.TgZ(10,"ion-segment-button",10),e._UZ(11,"ion-icon",12),e.TgZ(12,"ion-label"),e._uU(13,"Note"),e.qZA()()(),e.TgZ(14,"ion-grid"),e.YNc(15,A,9,0,"ion-row",6),e.YNc(16,y,8,3,"ion-row",6),e.YNc(17,Y,9,3,"ion-row",6),e.YNc(18,F,10,1,"ion-row",6),e.qZA()()()()}if(2&n){const i=e.oxw();e.xp6(3),e.Q6J("ngIf",i.loadingError),e.xp6(1),e.Q6J("ngIf",!i.loadingError),e.xp6(1),e.Q6J("ngModel",i.selectedView),e.xp6(1),e.Q6J("value",1),e.xp6(4),e.Q6J("value",2),e.xp6(5),e.Q6J("ngIf",i.canUpdate&&1==i.selectedView),e.xp6(1),e.Q6J("ngIf",1==i.selectedView),e.xp6(1),e.Q6J("ngIf",2==i.selectedView),e.xp6(1),e.Q6J("ngIf",i.showNoteFromBackoffice&&2==i.selectedView)}}const B=[{path:"",component:(()=>{class n{constructor(i,t,o,s,l){this.activatedRoute=i,this.navController=t,this.startService=o,this.toastController=s,this.loadingController=l,this.listPresenze=[],this.listPresenzeConfermate=[],this.listPresenzeInProva=[],this.pianificazioneDoc=new m.N,this.canUpdate=!1,this.selectedView=1,this.TipoSocieta=f.bI,this.showTabs=!0,this.selectedSegment=null,this.loadingError=!1,this.messageError="",this.loadingComplete=!1,this.tipoSocieta=this.startService.actualStartConfig.gruppo.TIPOGRUPPO,this.isDesktop=o.isDesktop,this.gapAggiornamentoPresenze=o.areaSelectedValue.APPGAPOREPRESENZE}ngOnInit(){this.activatedRoute.paramMap.subscribe(i=>{this.idPianificazione=i.get("pianificazioneCorsoId"),this.requestDocs().then(()=>{this.loadingComplete=!0,this.loadingError=!1,this.startService.presentToastMessage("Scheda presenze caricata")}).catch(t=>{if(this.loadingComplete=!0,this.loadingError=!0,"string"==typeof t)this.messageError=t;else try{this.messageError=t.message}catch(o){this.messageError="Errore nel recupero dei dati"}})})}requestDocs(){return new Promise((i,t)=>{this.idPianificazione&&0!=this.idPianificazione.length?this.startService.requestPianificazioneCorso(this.idPianificazione).then(o=>(this.pianificazioneDoc=o,this.canUpdate=o.canUpdatePresenze(this.gapAggiornamentoPresenze),o)).then(o=>this.startService.insertPresenzeIntoPianificazione(o)).then(o=>(this.listPresenze=o.CORSOPRESENZE,this.listPresenze)).then(o=>(this.listPresenzeConfermate=o.filter(s=>s.STATOISCRIZIONE==f.Pm.confermata),o)).then(o=>{this.listPresenzeInProva=o.filter(s=>s.STATOISCRIZIONE==f.Pm.inProva),i()}).catch(o=>{t(o)}):t("Data pianificazione non presente")})}get showNoteFromBackoffice(){let i=!1;if(this.pianificazioneDoc&&this.pianificazioneDoc.NOTEADMIN)return 0!=this.pianificazioneDoc.NOTEADMIN.length&&(i=!0),i}get containNoteTrainer(){let i=!1;if(this.pianificazioneDoc&&this.pianificazioneDoc.NOTETRAINER)return 0!=this.pianificazioneDoc.NOTETRAINER.length&&(i=!0),i}get backPathArray(){return["/","appstart-home","tab-agenda"]}get backButtonHref(){let i="";return i=this.backPathArray.join("/").substring(1),i}onGoToBack(){this.navController.navigateBack(this.backPathArray)}onClickGoBack(){this.pianificazioneDoc&&this.pianificazioneDoc.isModified(2)?this.startService.presentAlertMessage("Se esci senza confermare, le presenze non verranno salvate","Vuoi abbandonare ?",[{text:"Esci",handler:()=>{this.onGoToBack()}},{text:"Rimani",role:"cancel"}]):this.onGoToBack()}onClickElement(i){i.PRESENTE=null==i.PRESENTE||null==i.PRESENTE||!i.PRESENTE,this.selectedSegment=this.tuttiPresenti?"presente":this.tuttiAssenti?"assente":null}onSubmit(){this.pianificazioneDoc.isModified(2)?this.loadingController.create({message:"Caricamento",spinner:"circular",backdropDismiss:!0}).then(i=>{i.present(),this.startService.requestUpdatePresenze(this.pianificazioneDoc).then(t=>{i.dismiss(),t.result?(this.startService.presentToastMessage("Presenze aggiornate"),this.onGoToBack()):(P.M.consoleLog(t),this.startService.presentAlertMessage(t.message))}).catch(t=>{i.dismiss(),P.M.consoleLog(t,"error"),this.startService.presentToastMessage("Errore di connessione")})}):this.onGoToBack()}getColoreCertificato(i){let t,o,s;return t=new Date,o=p.GA.calcola(t,7,p.xH.days),s=i.DATACERTIFICATOMEDICO?p.GA.isBefore(i.DATACERTIFICATOMEDICO,t)?"danger":p.GA.isBefore(i.DATACERTIFICATOMEDICO,o)?"warning":"primary":"danger",s}showMessage(i){this.toastController.create({message:i,duration:3e3}).then(t=>{t.present()})}onScroll(i){i.detail.currentY<5?this.showTabs=!0:i.detail.deltaY>20?this.showTabs=!1:i.detail.deltaY<-20&&(this.showTabs=!0)}setAllPresenze(i){this.listPresenze&&this.listPresenze.forEach(t=>{t.PRESENTE=i})}get tuttiPresenti(){let i=!0;return this.listPresenze.forEach(t=>{t.PRESENTE||(i=!1)}),i}get tuttiAssenti(){let i=!0;return this.listPresenze.forEach(t=>{t.PRESENTE&&(i=!1)}),i}}return n.\u0275fac=function(i){return new(i||n)(e.Y36(d.gz),e.Y36(r.SH),e.Y36(h.D),e.Y36(r.yF),e.Y36(r.HT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-detail-presenza"]],decls:11,vars:1,consts:[["color","primary"],["slot","start"],["fill","clear",3,"click"],["name","arrow-back"],["scrollEvents","",3,"ionScroll"],[2,"height","1vh"],[4,"ngIf"],["sizeXs","12","sizeSm","12","sizeMd","12","sizeLg","6","offsetLg","3","sizeXl","6","offsetXl","3"],["class","ion-no-padding div-header",4,"ngIf"],["mode","md",3,"ngModel","ngModelChange"],[3,"value"],["name","people-circle-outline"],["name","document-text-outline"],[1,"ion-no-padding","div-header"],["lines","none","color","light"],["slot","start","name","school-outline","color","primary"],[1,"ion-text-wrap"],[1,"text-small"],["name","information-circle-outline","color","primary"],["color","danger",4,"ngIf"],["color","success","expand","full",3,"click",4,"ngIf"],["color","danger"],["color","success","expand","full",3,"click"],["expand","full","color","success",3,"click"],["name","thumbs-up"],["expand","full","color","danger",3,"click"],["name","thumbs-down"],[3,"button","click",4,"ngFor","ngForOf"],[3,"button","click"],["slot","start","name","thumbs-up-outline","color","primary",4,"ngIf"],["slot","start","name","thumbs-down-outline","color","danger",4,"ngIf"],["slot","start","color","","name","person-circle-outline",4,"ngIf"],["slot","end",3,"color",4,"ngIf"],["slot","start","name","thumbs-up-outline","color","primary"],["slot","start","name","thumbs-down-outline","color","danger"],["slot","start","color","","name","person-circle-outline"],[1,"custom-badge",3,"color"],["slot","end",3,"color"],["mode","ios"],["class","ion-text-wrap",4,"ngIf"],["lines","10","placeholder","Inserisci una nota","maxlength","200",3,"ngModel","ngModelChange",4,"ngIf"],["lines","10","placeholder","Inserisci una nota","maxlength","200",3,"ngModel","ngModelChange"],["slot","start","name","pencil-outline"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),e.NdJ("click",function(){return t.onClickGoBack()}),e._UZ(4,"ion-icon",3),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Presenze"),e.qZA()()(),e.TgZ(7,"ion-content",4),e.NdJ("ionScroll",function(s){return t.onScroll(s)}),e._UZ(8,"div",5),e.YNc(9,G,19,9,"ion-grid",6),e.qZA(),e._UZ(10,"ion-footer")),2&i&&(e.xp6(9),e.Q6J("ngIf",t.loadingComplete))},dependencies:[_.sg,_.O5,g.JJ,g.nD,g.On,r.yp,r.YG,r.Sm,r.PM,r.FN,r.Zi,r.tO,r.Dq,r.wI,r.W2,r.fr,r.jY,r.Gu,r.gu,r.Ie,r.Q$,r.q_,r.yh,r.Nd,r.cJ,r.GO,r.g2,r.wd,r.sr,r.QI,r.j9,_.rS,_.uU],styles:["div.div-header[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{margin-right:15px;font-size:50px}ion-badge.custom-badge[_ngcontent-%COMP%]{font-size:10px;padding:3px;display:ruby-base;margin-left:8px}ion-item-group[_ngcontent-%COMP%]{padding:10px}div.info[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{color:gray;font-size:12px;margin-bottom:0;font-style:italic}.notes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-style:italic}.notes[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{font-style:italic!important;color:gray!important}ion-item-group[_ngcontent-%COMP%]{padding-left:0;padding-right:0}"]}),n})()}];let H=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.Bz.forChild(B),d.Bz]}),n})(),V=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[_.ez,g.u5,r.Pc,H]}),n})()}}]);