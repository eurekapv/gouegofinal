"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8174],{18174:(Ee,S,r)=>{r.r(S),r.d(S,{LocationBookingPageModule:()=>ze});var p=r(69808),a=r(7706),f=r(2840),e=r(31223),w=r(75822),k=r(62843),Z=r(70262),E=r(14898),C=r(42274),b=r(58698),y=r(37708),d=r(34021),N=r(73951),O=r(48622),c=r(69129),R=r(97952),F=r(24737);function B(o,l){if(1&o&&(e.TgZ(0,"ion-col",13)(1,"ion-label",26)(2,"small"),e._uU(3),e.qZA()()()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.DESCR)}}function U(o,l){1&o&&(e.TgZ(0,"ion-col",19)(1,"ion-badge",20)(2,"small"),e._uU(3,"GRATUITA"),e.qZA()()())}function J(o,l){1&o&&(e.TgZ(0,"p")(1,"small"),e._uU(2,"(prezzo escluso imposte)"),e.qZA()())}function Y(o,l){if(1&o&&(e.TgZ(0,"ion-col",13)(1,"ion-label",26)(2,"small"),e._uU(3),e.qZA(),e.YNc(4,J,3,0,"p",21),e.qZA()()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.DESCR),e.xp6(1),e.Q6J("ngIf",0!=t.ALIQUOTA)}}function q(o,l){if(1&o&&(e.TgZ(0,"ion-col",19)(1,"ion-label",26)(2,"small"),e._uU(3),e.ALo(4,"currency"),e.qZA()()()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(e.xi3(4,1,t.IMPONIBILE,"EUR"))}}function Q(o,l){if(1&o&&(e.TgZ(0,"ion-row"),e.YNc(1,B,4,1,"ion-col",29),e.YNc(2,U,4,0,"ion-col",30),e.YNc(3,Y,5,2,"ion-col",29),e.YNc(4,q,5,4,"ion-col",30),e.qZA()),2&o){const t=l.$implicit;e.xp6(1),e.Q6J("ngIf",t.GRATUITA),e.xp6(1),e.Q6J("ngIf",t.GRATUITA),e.xp6(1),e.Q6J("ngIf",!t.GRATUITA),e.xp6(1),e.Q6J("ngIf",!t.GRATUITA)}}function G(o,l){if(1&o&&(e.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-accordion-group")(3,"ion-accordion",24)(4,"ion-item",25)(5,"ion-label",26),e._uU(6),e.qZA()(),e.TgZ(7,"div",27),e._uU(8," Il totale \xe8 comprensivo della emissione/rinnovo delle seguenti tessere "),e.TgZ(9,"ion-grid"),e.YNc(10,Q,5,4,"ion-row",28),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.activePrenotazione?null:t.activePrenotazione.NOTES,""),e.xp6(4),e.Q6J("ngForOf",t.collTesseramenti)}}let M=(()=>{class o{constructor(t,i,n,s,h,u,m){this.startService=t,this.navController=i,this.loadingController=n,this.toastCtrl=s,this.navParams=h,this.modalCtrl=u,this.alertCtrl=m,this.idPrenotazione="",this.idLocation="",this.checkBookId=!0,this.disclaimer=!0,this.docArea=this.startService.areaSelectedValue,this.setListPayment()}ngOnInit(){this.disclaimer=!0;let t=!0,i="";this.idLocation=this.navParams.get("locationId"),0!==this.idLocation.length?(this.selectedLocation=this.startService.findLocationByID(this.idLocation),this.selectedLocation||(t=!1,i="Location null")):(t=!1,i="idLocation Empty"),t&&(this.idPrenotazione=this.navParams.get("bookId"),this.idPrenotazione?this.recuperaPrenotazione():t=!1),t&&(this.subUserLogged=this.startService.flagUtenteIsLoggato$.subscribe(n=>{this.userLogged=n}),this.subDocUtente=this.startService.activeUtenteDoc$.subscribe(n=>{this.docUtente=n}),this.selectedCampo=this.startService.getSelectedCampoPrenotazione()),t||(i="ngOnInit Failed "+i,c.M.consoleLog(i,"error"),this.onBookIdWrong())}ngOnDestroy(){this.subUserLogged&&this.subUserLogged.unsubscribe(),this.subActivePrenotazione&&this.subActivePrenotazione.unsubscribe(),this.subDocUtente&&this.subDocUtente.unsubscribe(),this.subPaymentResult&&this.subPaymentResult.unsubscribe()}get showGroupTesseramenti(){let t=!1;return this.collTesseramenti&&0!=this.collTesseramenti.length&&(t=!0),t}get collTesseramenti(){let t;return this.activePrenotazione&&this.activePrenotazione.PRENOTATESSERAMENTO&&(t=this.activePrenotazione.PRENOTATESSERAMENTO),t}recuperaPrenotazione(){this.subActivePrenotazione=this.startService.activePrenotazione.subscribe(t=>{this.activePrenotazione=t,this.docPianificazione=this.activePrenotazione.getPianificazione(),this.checkBookId&&(this.checkBookId=!1,null==this.activePrenotazione?(c.M.consoleLog("activePrenotazione null"),this.onBookIdWrong()):this.idPrenotazione!=this.activePrenotazione.ID?(c.M.consoleLog("idPrenotazione <> activePrenotazione.ID","error"),c.M.consoleLog(`idPrenotazione: ${this.idPrenotazione} - activePrenotazione ${this.activePrenotazione.ID}`,"error"),this.onBookIdWrong()):null==this.docPianificazione&&(c.M.consoleLog("docPianificazione null","error"),this.onBookIdWrong()))})}onBookIdWrong(){this.showMessage("Errore dati prenotazione"),this.closeModal()}closeModal(){this.modalCtrl.dismiss()}onChangedNumPlayer(t){this.docPianificazione.NUMPARTECIPANTI=t,this.calcolaTotale()}calcolaTotale(){this.loadingController.create({message:"Ricalcolo importo...",spinner:"circular"}).then(t=>{t.present(),this.startService.requestImportoPrenotazione().subscribe(i=>{t.dismiss();let n=b.i.getPrenotazioneFromJson(i);this.startService.setActivePrenotazione(n),n.ISVALID||this.showMessage(n.MSGINVALID)},i=>{t.dismiss(),this.showMessage(i)})})}getAddressLocation(){let t="";return this.selectedLocation&&(this.selectedLocation.INDIRIZZO&&0!==this.selectedLocation.INDIRIZZO.length?t=this.selectedLocation.INDIRIZZO:this.selectedLocation.COMUNE&&0!==this.selectedLocation.COMUNE.length&&(t=this.selectedLocation.COMUNE)),t}onConfirm(){this.onExecPayment()}onAfterSavePrenotazione(){this.showMessage("Prenotazione confermata"),this.modalCtrl.dismiss().then(t=>{if(t){let i=this.docPianificazione.getIdentifier(),n=this.startService.getUrlPageHistoryPersonal("book",i);this.navController.navigateBack(n)}})}setListPayment(){this.myListPayment=[],this.docArea&&(this.myListPayment=this.docArea.getPaymentFor(d.O4.settorePagamentoPrenotazione),this.mySelectedPayment=this.myListPayment&&0!=this.myListPayment.length?this.myListPayment[0]:null)}onPaymentSelected(t){this.mySelectedPayment=t}onPaymentModeSelected(t){this.myPaymentMode=t}onExecPayment(){if(0!=this.activePrenotazione.TOTALE)if([d.x6.pagaAdesso,d.x6.pagaBonifico,d.x6.pagaStruttura].includes(this.myPaymentMode))if(this.myPaymentMode==d.x6.pagaBonifico||this.myPaymentMode==d.x6.pagaStruttura){let i=new y.b(this.myPaymentMode);this.onPaymentSuccess(i)}else{let i=new y.b(this.myPaymentMode);i.amount=this.activePrenotazione.RESIDUO,i.description="Pagamento Prenotazione",i.currency="EUR",this.modalCtrl.create({component:O.t,componentProps:{paymentData:i,listAreaPaymentSettings:this.myListPayment}}).then(n=>(n.present(),n.onDidDismiss())).then(n=>{let s=n.data;s?s.processResult?this.onPaymentSuccess(s):this.onPaymentFailed(s):(s=new y.b(this.myPaymentMode),s.processResult=!1,s.messageResult="Pagamento fallito",this.onPaymentFailed(s))})}else this.showMessage("E' necessario selezionare un pagamento");else this.showMessage("Contattare la struttura. Prenotazioni gratuite concluse")}onPaymentSuccess(t){t&&t.processResult&&(0==t.idElectronicResult.length?(this.activePrenotazione.IDTRANSACTION="",this.activePrenotazione.IDORDER="",this.activePrenotazione.CHANNELPAYMENT=t.channelPayment,this.activePrenotazione.RESIDUO=this.activePrenotazione.TOTALE,this.activePrenotazione.INCASSATO=0):(this.activePrenotazione.RESIDUO=0,this.activePrenotazione.INCASSATO=this.activePrenotazione.TOTALE,this.activePrenotazione.IDTRANSACTION="",this.activePrenotazione.IDORDER=t.idElectronicResult,this.activePrenotazione.CHANNELPAYMENT=t.channelPayment),this.loadingController.create({message:"Salvataggio Prenotazione",spinner:"circular"}).then(i=>{i.present(),this.startService.requestSavePrenotazione().then(n=>{i.dismiss(),this.activePrenotazione=n,n.ISVALID?this.docPianificazione=this.activePrenotazione.PRENOTAZIONEPIANIFICAZIONE[0]:this.showMessage(n.MSGINVALID),this.onAfterSavePrenotazione()}).catch(n=>{i.dismiss(),this.showMessage(n)})}))}onPaymentFailed(t){let i="Si sono verificati errori nel pagamento";t&&t.messageResult&&(i=t.messageResult),this.showAlert(i,"Pagamento Fallito")}showMessage(t){this.toastCtrl.create({message:t,duration:3e3}).then(i=>{i.present()})}showAlert(t,i,n){(!n||0==n.length)&&(n=[]).push("Ok"),this.alertCtrl.create({header:i||"Attenzione",message:t,buttons:n}).then(s=>{s.present()})}openLink(t){N.A.open({url:t})}onClickCondizioniVendita(){let t;this.docArea&&(t=this.docArea.findAreaLinkByPageType(d.GV.condizioniVenditaPrenotazioni),t&&t.REFERURL&&this.openLink(t.REFERURL))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(w.D),e.Y36(a.SH),e.Y36(a.HT),e.Y36(a.yF),e.Y36(a.X1),e.Y36(a.IN),e.Y36(a.Br))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-location-booking-finalize"]],decls:94,vars:48,consts:[["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","ios","close","md","close"],[2,"background-color","#EFF1F8"],[1,"griglia-principale"],["color","danger","expand","block",1,"full-buttons",3,"click"],["size","12","size-xl","6","size-sm","12"],[1,"ion-margin-horizontal"],[1,"ion-align-items-center"],["size","3",1,"ion-text-center","left-col"],[1,"ion-no-margin"],[1,"ion-no-margin",2,"margin-top","0px","margin-bottom","0px"],["size","9"],[1,"ion-no-margin","ion-text-bold"],[3,"numPlayer","changeNumPlayer"],["size","5",1,"ion-text-center","left-col"],["size","7"],[1,"ion-no-margin","ion-text-right","ion-text-bold"],["size","3",1,"ion-text-right"],["color","success"],[4,"ngIf"],[3,"iconMode","arPayment","onPaymentModeChoosed"],["color","tertiary","expand","block",1,"full-buttons",3,"disabled","click"],["value","notes"],["slot","header","color","warning"],[1,"ion-text-wrap"],["slot","content",1,"ion-padding"],[4,"ngFor","ngForOf"],["size","9",4,"ngIf"],["size","3","class","ion-text-right",4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),e.NdJ("click",function(){return i.closeModal()}),e._UZ(4,"ion-icon",3),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Finalizza"),e.qZA()()(),e.TgZ(7,"ion-content")(8,"div",4)(9,"ion-grid",5)(10,"ion-row")(11,"ion-col")(12,"ion-button",6),e.NdJ("click",function(){return i.closeModal()}),e._uU(13," Aspetta, voglio modificare "),e.qZA()()(),e.TgZ(14,"ion-grid")(15,"ion-row")(16,"ion-col",7)(17,"ion-grid")(18,"ion-row")(19,"ion-col")(20,"ion-card",8)(21,"ion-grid")(22,"ion-row",9)(23,"ion-col",10)(24,"h6",11),e._uU(25),e.ALo(26,"uppercase"),e.ALo(27,"date"),e.qZA(),e.TgZ(28,"h4",12),e._uU(29),e.ALo(30,"date"),e.qZA(),e.TgZ(31,"p",11),e._uU(32),e.ALo(33,"titlecase"),e.ALo(34,"date"),e.ALo(35,"titlecase"),e.ALo(36,"date"),e.qZA()(),e.TgZ(37,"ion-col",13)(38,"h6"),e._uU(39),e.qZA(),e.TgZ(40,"h4"),e._uU(41),e.qZA(),e.TgZ(42,"h6"),e._uU(43),e.ALo(44,"titlecase"),e.qZA()()()()()()(),e.TgZ(45,"ion-row")(46,"ion-col")(47,"ion-card",8)(48,"ion-grid")(49,"ion-row",9)(50,"ion-col",10)(51,"h6",14),e._uU(52),e.ALo(53,"uppercase"),e.ALo(54,"date"),e.qZA(),e.TgZ(55,"h6",14),e._uU(56),e.ALo(57,"date"),e.qZA()(),e.TgZ(58,"ion-col",13)(59,"h5",11),e._uU(60),e.qZA()()()()()()(),e.TgZ(61,"ion-row")(62,"ion-col")(63,"app-player-number",15),e.NdJ("changeNumPlayer",function(s){return i.onChangedNumPlayer(s)}),e.qZA()()()()(),e.TgZ(64,"ion-col",7)(65,"ion-grid")(66,"ion-row")(67,"ion-col")(68,"ion-card",8)(69,"ion-grid")(70,"ion-row",9)(71,"ion-col",16)(72,"h6",14),e._uU(73,"Totale Prenotazione"),e.qZA()(),e.TgZ(74,"ion-col",17)(75,"h5",18),e._uU(76),e.ALo(77,"currency"),e.qZA()()(),e.TgZ(78,"ion-row",2),e.NdJ("click",function(){return i.onClickCondizioniVendita()}),e.TgZ(79,"ion-col",13)(80,"small"),e._uU(81,"procedendo con l'acquisto si accettano le condizioni di vendita"),e.qZA()(),e.TgZ(82,"ion-col",19)(83,"ion-badge",20)(84,"small"),e._uU(85,"LEGGI"),e.qZA()()()(),e.YNc(86,G,11,2,"ion-row",21),e.TgZ(87,"app-payment-mode",22),e.NdJ("onPaymentModeChoosed",function(s){return i.onPaymentModeSelected(s)}),e.qZA()()()()()()()()()()()(),e.TgZ(88,"ion-footer")(89,"ion-grid")(90,"ion-row")(91,"ion-col")(92,"ion-button",23),e.NdJ("click",function(){return i.onConfirm()}),e._uU(93," Conferma Prenotazione "),e.qZA()()()()()),2&t&&(e.xp6(25),e.Oqu(e.lcZ(26,17,e.xi3(27,19,null==i.docPianificazione?null:i.docPianificazione.DATAORAINIZIO,"EEE"))),e.xp6(4),e.Oqu(e.xi3(30,22,null==i.docPianificazione?null:i.docPianificazione.DATAORAINIZIO,"dd")),e.xp6(3),e.AsE("",e.lcZ(33,25,e.xi3(34,27,null==i.docPianificazione?null:i.docPianificazione.DATAORAINIZIO,"MMM"))," '",e.lcZ(35,30,e.xi3(36,32,null==i.docPianificazione?null:i.docPianificazione.DATAORAINIZIO,"YY")),""),e.xp6(7),e.Oqu(null==i.docPianificazione?null:i.docPianificazione._DESCRSPORT),e.xp6(2),e.Oqu(null==i.selectedCampo?null:i.selectedCampo.DENOMINAZIONE),e.xp6(2),e.Oqu(e.lcZ(44,35,i.getAddressLocation())),e.xp6(9),e.Oqu(e.lcZ(53,37,e.xi3(54,39,null==i.docPianificazione?null:i.docPianificazione.DATAORAINIZIO,"HH:mm"))),e.xp6(4),e.Oqu(e.xi3(57,42,null==i.docPianificazione?null:i.docPianificazione.DATAORAFINE,"HH:mm")),e.xp6(4),e.AsE(" ",(null==i.docPianificazione?null:i.docPianificazione.DURATAORE)>1?null==i.docPianificazione?null:i.docPianificazione.DURATAORE:60*(null==i.docPianificazione?null:i.docPianificazione.DURATAORE)," ",(null==i.docPianificazione?null:i.docPianificazione.DURATAORE)>1?"Ore":"Min."," "),e.xp6(3),e.Q6J("numPlayer",null==i.docPianificazione?null:i.docPianificazione.NUMPARTECIPANTI),e.xp6(13),e.Oqu(e.xi3(77,45,null==i.activePrenotazione?null:i.activePrenotazione.TOTALE,"EUR")),e.xp6(10),e.Q6J("ngIf",i.showGroupTesseramenti),e.xp6(1),e.Q6J("iconMode",!0)("arPayment",i.myListPayment),e.xp6(5),e.Q6J("disabled",!i.disclaimer||!(null!=i.activePrenotazione&&i.activePrenotazione.ISVALID)||!i.mySelectedPayment))},dependencies:[p.sg,p.O5,a.We,a.eh,a.yp,a.YG,a.Sm,a.PM,a.wI,a.W2,a.fr,a.jY,a.Gu,a.gu,a.Ie,a.Q$,a.Nd,a.wd,a.sr,R.e,F.E,p.gd,p.rS,p.H9,p.uU],styles:[".griglia-principale[_ngcontent-%COMP%] > ion-row[_ngcontent-%COMP%] > ion-col[_ngcontent-%COMP%]{padding:0}h6[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:4px;font-size:15px}h4[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:5px;font-weight:600}.left-col[_ngcontent-%COMP%]{border-right-style:solid;border-width:thin;border-color:#eff1f8}p[_ngcontent-%COMP%]{font-size:13px}ion-button.full-buttons[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}#item-totale[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:20px}ion-label.ion-text-small[_ngcontent-%COMP%]{font-size:.8em}ion-card.ion-margin-horizontal[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}"]}),o})();var H=r(97582),I=r(42041),g=r(69214),V=r(5346);const $=["swiperDays"];function j(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw();return e.KtG(s.onClickButton(n))}),e._uU(1),e._UZ(2,"br"),e._uU(3),e.ALo(4,"date"),e.qZA()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("fill",i.getFillButton(t)),e.xp6(1),e.hij(" ",t.numValue," "),e.xp6(2),e.hij(" ",e.xi3(4,3,t.dateValue,"EEEEE")," ")}}function W(o,l){if(1&o&&(e.TgZ(0,"swiper-slide"),e.YNc(1,j,5,6,"ion-button",16),e.qZA()),2&o){const t=l.$implicit;e.xp6(1),e.Q6J("ngIf","day"==t.type)}}I.tq.use([I.W_]);let X=(()=>{class o{constructor(t){this.pickController=t,this.activeDay=new Date,this.onChangeActiveDay=new e.vpe,this.listDay=[],this.listMesi=[],this.sliderOpts={navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},slidesPerView:15,spaceBetween:3,initialSlide:1,breakpoints:{320:{slidesPerView:5,spaceBetween:1},480:{slidesPerView:5,spaceBetween:3},640:{slidesPerView:5,spaceBetween:1},1e3:{slidesPerView:8,spaceBetween:1}}},this.listMesi=d.Gs.getArray(d.oO)}swiperReady(){var t;c.M.consoleLog("Swiper Ready","warn"),this.swiper=null===(t=this.swiperRef)||void 0===t?void 0:t.nativeElement.swiper,this.setStartSlide()}setSwiperProp(t,i){var n;let s=null===(n=this.swiperRef)||void 0===n?void 0:n.nativeElement;s&&s.setAttribute(t,i)}setStartSlide(){let t=this.activeDay.getDate()-1;t-=2,t<0&&(t=0),setTimeout(()=>{this.goToSlide(t)},300)}goToSlide(t){var i;this.swiper&&(null===(i=this.swiper)||void 0===i||i.slideTo(t))}ngOnInit(){this.setListDay()}setListDay(){let i,t=30;i=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1),i=g.GA.calcola(i,1,g.xH.months),i=g.GA.calcola(i,-1,g.xH.days),t=i.getDate(),this.listDay=[],t+=1;for(let n=1;n<t;n++){let s=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),n);this.listDay.push({type:"day",dateValue:s,numValue:n})}}getFillButton(t){let i="outline";return t&&this.activeDay.getDate()==t.numValue&&(i="solid"),i}onClickButton(t){let i;if(t)if("day"==t.type)this.activeDay=t.dateValue,this.onChangeActiveDay.emit(this.activeDay);else switch(t.type){case"next":i=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1),i=g.GA.calcola(i,1,g.xH.months),this.setNewActiveDateFromPicker(i.getFullYear(),i.getMonth()+1,i.getDate());break;case"prev":i=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1),i=g.GA.calcola(i,-1,g.xH.days),this.setNewActiveDateFromPicker(i.getFullYear(),i.getMonth()+1,i.getDate())}}onClickMonthButton(t){let i;switch(t){case"next":i=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1),i=g.GA.calcola(i,1,g.xH.months),this.setNewActiveDateFromPicker(i.getFullYear(),i.getMonth()+1,i.getDate());break;case"prev":i=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1),i=g.GA.calcola(i,-1,g.xH.days),this.setNewActiveDateFromPicker(i.getFullYear(),i.getMonth()+1,i.getDate())}}initColumnMesi(t){let i=[];for(let n=0;n<this.listMesi.length;n++){const s=this.listMesi[n];i.push({text:s.description,value:s.value,disabled:!(n>=t)})}return i}initColumnAnni(){let t=[],i=(new Date).getFullYear();for(let n=i;n<i+5;n++)t.push({text:n+"",value:n});return t}initColumnsPicker(t,i,n,s){return[{name:"mese",options:t,selectedIndex:i},{name:"anno",options:n,selectedIndex:s}]}showPickerDate(){let t=this,n=t.activeDay.getFullYear()-(new Date).getFullYear();const s=(new Date).getMonth();let h=[{text:"Conferma",handler:_=>{t.setNewActiveDateFromPicker(_.anno.value,_.mese.value)}},{role:"cancel",text:"Annulla"}],u=this.initColumnMesi(s),m=[];m=this.initColumnAnni();let xe={columns:this.initColumnsPicker(u,0,m,n),buttons:h,keyboardClose:!0};this.pickController.create(xe).then(_=>{_.addEventListener("ionPickerColChange",v=>(0,H.mG)(this,void 0,void 0,function*(){const P=v.detail;if("anno"==P.name){const De=(new Date).getFullYear(),ke=(new Date).getMonth();let A=[],z=[],x=[];const D=P.selectedIndex,Ze=P.options[D].value;z=this.initColumnAnni(),A=this.initColumnMesi(Ze==De?ke:0),x=this.initColumnsPicker(A,0,z,D),_.columns=x}})),_.present()})}setNewActiveDateFromPicker(t,i,n=0){let s=this.activeDay.getMonth(),h=this.activeDay.getFullYear(),u=this.activeDay.getDate(),m=new Date;(i-1!==s||t!==h)&&(u=i-1==m.getMonth()&&t==m.getFullYear()?m.getDate():1,0!=n&&(u=n),this.activeDay=new Date(t,i-1,u),this.setListDay(),this.goToSlide(this.activeDay.getDate()-1),this.onChangeActiveDay.emit(this.activeDay))}getMaxDayInMont(t,i){let n=new Date(i,t,1),s=1;return t>=0&&t<=11&&i>1900&&(n=new Date(i,t,1),n=g.GA.calcola(n,1,g.xH.months),n=g.GA.calcola(n,-1,g.xH.days),s=n.getDate()),s}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(a.up))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-calendarscroll"]],viewQuery:function(t,i){if(1&t&&e.Gf($,5),2&t){let n;e.iGM(n=e.CRH())&&(i.swiperRef=n.first)}},inputs:{activeDay:"activeDay"},outputs:{onChangeActiveDay:"onChangeActiveDay"},decls:23,vars:8,consts:[[1,"picker-month","ion-no-padding","ion-no-margin"],["size","2",1,"ion-text-center"],["shape","round","size","medium","fill","clear","color","primary",1,"ion-no-padding","ion-no-margin",3,"click"],["slot","icon-only","name","play-back-outline"],["size","8",1,"ion-text-center",3,"click"],["color","primary","expand","block","fill","clear","size","medium"],["slot","icon-only","name","play-forward-outline"],[1,"picker-day","ion-no-margin"],[1,"ion-no-margin","ion-padding-horizontal"],[1,"swiper_wrap"],[1,"slider-wrapper"],[1,"swiper-button-prev"],["navigation","true","appSwiper","","init","false",3,"config","afterinit"],["swiperDays",""],[4,"ngFor","ngForOf"],[1,"swiper-button-next"],["class","ion-no-padding ion-no-margin btn-day","shape","round","size","large","color","secondary",3,"fill","click",4,"ngIf"],["shape","round","size","large","color","secondary",1,"ion-no-padding","ion-no-margin","btn-day",3,"fill","click"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-grid",0)(1,"ion-row")(2,"ion-col",1)(3,"ion-button",2),e.NdJ("click",function(){return i.onClickMonthButton("prev")}),e._UZ(4,"ion-icon",3),e.qZA()(),e.TgZ(5,"ion-col",4),e.NdJ("click",function(){return i.showPickerDate()}),e.TgZ(6,"ion-button",5),e._uU(7),e.ALo(8,"uppercase"),e.ALo(9,"date"),e.qZA()(),e.TgZ(10,"ion-col",1)(11,"ion-button",2),e.NdJ("click",function(){return i.onClickMonthButton("next")}),e._UZ(12,"ion-icon",6),e.qZA()()()(),e.TgZ(13,"ion-grid",7)(14,"ion-row",8)(15,"ion-col")(16,"div",9)(17,"div",10),e._UZ(18,"div",11),e.TgZ(19,"swiper-container",12,13),e.NdJ("afterinit",function(){return i.swiperReady()}),e.YNc(21,W,2,1,"swiper-slide",14),e.qZA(),e._UZ(22,"div",15),e.qZA()()()()()),2&t&&(e.xp6(7),e.hij(" ",e.lcZ(8,3,e.xi3(9,5,i.activeDay,"EEEE dd MMMM yyyy"))," "),e.xp6(12),e.Q6J("config",i.sliderOpts),e.xp6(2),e.Q6J("ngForOf",i.listDay))},dependencies:[a.YG,a.wI,a.jY,a.gu,a.Nd,p.sg,p.O5,V.T,p.gd,p.uU],styles:["ion-grid.picker-month[_ngcontent-%COMP%]{background-color:#fff}ion-grid.picker-month[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding-top:10px}ion-grid.picker-day[_ngcontent-%COMP%]{background-color:#fff}ion-grid.picker-day[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]{max-width:55px}ion-grid.picker-day[_ngcontent-%COMP%]   .swiper_wrap[_ngcontent-%COMP%]{padding:0 25px;height:100%;width:100%;position:relative;display:block;text-align:left}ion-grid.picker-day[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%]{margin-top:0;position:absolute;top:50%;right:-20px;width:45px;height:45px;transform:translateY(-50%);background-image:none}ion-grid.picker-day[_ngcontent-%COMP%]   .swiper-button-next[_ngcontent-%COMP%]:after{color:var(--ion-color-primary);font-weight:700;font-size:1.2em}ion-grid.picker-day[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]{position:absolute;top:50%;left:-20px;width:45px;height:45px;transform:translateY(-50%);margin-top:0;background-image:none}ion-grid.picker-day[_ngcontent-%COMP%]   .swiper-button-prev[_ngcontent-%COMP%]:after{color:var(--ion-color-primary);font-weight:700;font-size:1.2em}a[_ngcontent-%COMP%]{text-decoration:none;cursor:pointer}ion-button.btn-day[_ngcontent-%COMP%]{width:50px;height:50px;min-width:50px;min-height:50px}ion-button.btn-day.button-inner[_ngcontent-%COMP%]{font-size:16px;flex-flow:column}.flessibile[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.circle[_ngcontent-%COMP%]{border-radius:50%;border-style:solid;border-width:thin;border-color:var(--ion-color-light-shade);width:50px;height:50px}.icon-calendar[_ngcontent-%COMP%]{font-size:25px}.custom-h5[_ngcontent-%COMP%]{display:flex;align-items:center}.custom-div[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center}.custom-div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:3px}"]}),o})(),K=(()=>{class o{constructor(){this.clickPrenota=new e.vpe}ngOnInit(){}onClickPrenota(){this.clickPrenota.emit(this.myPrenotaPianifica)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-footbooked"]],inputs:{myPrenotaPianifica:"myPrenotaPianifica"},outputs:{clickPrenota:"clickPrenota"},decls:14,vars:14,consts:[["color","tertiary"],["lines","none","detail","false"],["slot","start","name","calendar","color","tertiary"],["slot","end","color","tertiary","expand","block","size","default",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-list",0)(1,"ion-item",1),e._UZ(2,"ion-icon",2),e.TgZ(3,"ion-label")(4,"h2"),e._uU(5),e.ALo(6,"titlecase"),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"p"),e._uU(9),e.ALo(10,"date"),e.ALo(11,"date"),e.qZA()(),e.TgZ(12,"ion-button",3),e.NdJ("click",function(){return i.onClickPrenota()}),e._uU(13,"Prenota"),e.qZA()()()),2&t&&(e.xp6(5),e.hij(" ",e.lcZ(6,3,e.xi3(7,5,null==i.myPrenotaPianifica?null:i.myPrenotaPianifica.DATAORAINIZIO,"EEE dd/MM/yyyy"))," "),e.xp6(4),e.AsE(" dalle ",e.xi3(10,8,null==i.myPrenotaPianifica?null:i.myPrenotaPianifica.DATAORAINIZIO,"HH:mm")," alle ",e.xi3(11,11,null==i.myPrenotaPianifica?null:i.myPrenotaPianifica.DATAORAFINE,"HH:mm")," "))},dependencies:[a.YG,a.gu,a.Ie,a.Q$,a.q_,p.rS,p.uU],styles:["ion-icon[_ngcontent-%COMP%]{margin-right:16px}ion-button[_ngcontent-%COMP%]{margin-left:16px}"]}),o})();function ee(o,l){if(1&o&&e._UZ(0,"ion-icon",9),2&o){const t=e.oxw();e.Q6J("name",t.getIconButton())}}r(36797);let te=(()=>{class o{constructor(){this.clickSlot=new e.vpe,this.captionBtn="",this.readOnly=!1}ngOnInit(){}getClassButton(){let t="";return t=this.readOnly?"slot-read-only":this.mySlot.STATO==d.fu.occupato?"slot-busy":this.mySlot.STATO==d.fu.chiuso?"slot-read-only":this.mySlot.STATO==d.fu.contattare?"slot-free-contact":this.mySlot.selected?"slot-selected":"slot-free",t}getDisableButton(){let t=!1;return(this.mySlot.STATO==d.fu.occupato||this.mySlot.STATO==d.fu.chiuso||this.readOnly)&&(t=!0),t}getCaptionButton(){let t="";if(!this.readOnly)if(this.mySlot.selected)t=this.captionBtn;else switch(this.mySlot.STATO){case d.fu.occupato:t="occupato";break;case d.fu.contattare:t="contattare";break;case d.fu.chiuso:t=""}return t}getIconButton(){let t="";if(!this.readOnly)if(this.mySlot.selected)t="checkmark";else switch(this.mySlot.STATO){case d.fu.occupato:t="thumbs-down";break;case d.fu.contattare:t="call";break;default:t=""}return t}showIconButton(){let t=!1;if(!this.readOnly)if(this.mySlot.selected)t=!0;else switch(this.mySlot.STATO){case d.fu.occupato:case d.fu.contattare:t=!0;break;default:t=!1}return t}chooseSlot(){this.clickSlot.emit(this.mySlot)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-slottime"]],inputs:{mySlot:"mySlot",captionBtn:"captionBtn",readOnly:"readOnly"},outputs:{clickSlot:"clickSlot"},decls:20,vars:12,consts:[[1,"ion-align-items-center"],["size","2","size-xs","3","id","col-orari",1,"ion-no-padding"],[1,"ion-no-margin"],[1,"ion-text-center"],[1,"orario-black"],[1,"orario-light"],["size-xs","9","size","10","id","col-slot",1,"ion-padding-horizontal"],["expand","block",3,"ngClass","disabled","click"],["slot","start",3,"name",4,"ngIf"],["slot","start",3,"name"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-card")(1,"ion-row",0)(2,"ion-col",1)(3,"ion-grid",2)(4,"ion-row")(5,"ion-col")(6,"div",3)(7,"span",4),e._uU(8),e.ALo(9,"date"),e.qZA()()()(),e.TgZ(10,"ion-row")(11,"ion-col")(12,"div",3)(13,"span",5),e._uU(14),e.ALo(15,"date"),e.qZA()()()()()(),e.TgZ(16,"ion-col",6)(17,"ion-button",7),e.NdJ("click",function(){return i.chooseSlot()}),e.YNc(18,ee,1,1,"ion-icon",8),e._uU(19),e.qZA()()()()),2&t&&(e.xp6(8),e.hij(" ",e.xi3(9,6,i.mySlot.START,"HH:mm")," "),e.xp6(6),e.hij(" ",e.xi3(15,9,i.mySlot.END,"HH:mm")," "),e.xp6(3),e.Q6J("ngClass",i.getClassButton())("disabled",i.getDisableButton()),e.xp6(1),e.Q6J("ngIf",i.showIconButton()),e.xp6(1),e.hij(" ",i.getCaptionButton()," "))},dependencies:[a.YG,a.PM,a.wI,a.jY,a.gu,a.Nd,p.mk,p.O5,p.uU],styles:['@import"https://fonts.googleapis.com/css?family=Roboto&display=swap";ion-card[_ngcontent-%COMP%]{background-color:#fff;min-height:50px;margin:5px 16px}#col-orari[_ngcontent-%COMP%]{border-right-style:solid;border-width:thin;border-color:#eff1f8}.orario-black[_ngcontent-%COMP%]{font-family:Roboto;font-size:medium;color:#000}.orario-light[_ngcontent-%COMP%]{font-family:Roboto;font-size:medium;color:#9da2b3}.slot-busy[_ngcontent-%COMP%]{--background: var(--ion-color-danger)}.slot-free[_ngcontent-%COMP%]{--background: var(--ion-color-success)}.slot-free-contact[_ngcontent-%COMP%]{--background: var(--ion-color-success-tint)}.slot-selected[_ngcontent-%COMP%]{--background: var(--ion-color-secondary)}.slot-read-only[_ngcontent-%COMP%]{--background: lightgray}']}),o})();r(60253);const ie=["sliderSport"];function oe(o,l){1&o&&(e.TgZ(0,"ion-row",3)(1,"ion-col")(2,"ion-item",4)(3,"ion-label",5),e._uU(4," Non sono previste attivit\xe0 nel centro "),e.qZA(),e._UZ(5,"ion-icon",6),e.qZA()()())}function ne(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"swiper-slide")(1,"ion-card",10),e.NdJ("click",function(){const s=e.CHM(t).$implicit,h=e.oxw(2);return e.KtG(h.onChangeSport(s))}),e.TgZ(2,"ion-grid")(3,"ion-row",11)(4,"ion-col",12)(5,"i",13),e._UZ(6,"span",14),e.qZA()(),e.TgZ(7,"ion-col")(8,"ion-label")(9,"h3",15),e._uU(10),e.qZA()()()()()()()}if(2&o){const t=l.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("color",i.getColor(t)),e.xp6(5),e.Q6J("innerHTML",t.htmlIconHex,e.oJD),e.xp6(4),e.Oqu(t.DENOMINAZIONE)}}function ae(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col")(2,"swiper-container",7,8),e.NdJ("afterInit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.swiperReady())}),e.YNc(4,ne,11,3,"swiper-slide",9),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t._listAvailableSports)}}let se=(()=>{class o{constructor(){this.sportChanged=new e.vpe,this._flagAvailableSports=!1,this._direction="horizontal"}set sportList(t){this._listAvailableSports=t,this._flagAvailableSports=0!=this._listAvailableSports.length,this.setSwiperParams()}set direction(t){this._direction=t,this.setSwiperParams()}get numSlidesPerView(){let t=2.5;switch(this._listAvailableSports.length){case 1:t=1;break;case 2:t=2;break;default:t=2.5}return t}ngOnInit(){}swiperReady(){var t;this.swiper=null===(t=this.swiperRef)||void 0===t?void 0:t.nativeElement.swiper,this.setSwiperParams()}setSwiperParams(){setTimeout(()=>{this.setSwiperProp("slides-per-view",this.numSlidesPerView),this.setSwiperProp("direction",this._direction)},300)}setSwiperProp(t,i){var n;let s=null===(n=this.swiperRef)||void 0===n?void 0:n.nativeElement;s&&s.setAttribute(t,i)}getSwiperObject(){var t;let i=null===(t=this.swiperRef)||void 0===t?void 0:t.nativeElement,n=null;if(i)try{n=i.swiper}catch(s){n=null}return n}goToSlide(t){var i;null===(i=this.swiper)||void 0===i||i.slideTo(t)}onChangeSport(t){let i=this.getIndexSport(t);-1!=i&&this.goToSlide(i),this.sportChanged.emit(t)}getColor(t){let i="light";return this.selectedSport&&t&&this.selectedSport.ID==t.ID&&(i="secondary"),i}getIndexSport(t){let i=-1;return t&&(i=this._listAvailableSports.findIndex(n=>n.ID==t.ID)),i}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-sport-scroll"]],viewQuery:function(t,i){if(1&t&&e.Gf(ie,5),2&t){let n;e.iGM(n=e.CRH())&&(i.swiperRef=n.first)}},inputs:{selectedSport:"selectedSport",sportList:"sportList",direction:"direction"},outputs:{sportChanged:"sportChanged"},decls:3,vars:2,consts:[[1,"ion-no-margin","ion-no-padding"],["class","ion-text-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center","ion-align-items-center"],["color","light","lines","none"],[1,"ion-text-wrap"],["slot","start","name","ban","color","danger"],["slides-per-view","1",3,"afterInit"],["sliderSport",""],[4,"ngFor","ngForOf"],["mode","md","button","",1,"card-sport",3,"color","click"],[1,"ion-align-items-center"],["size","4"],[1,"icon-sport"],[3,"innerHTML"],[1,"text-sport"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-grid",0),e.YNc(1,oe,6,0,"ion-row",1),e.YNc(2,ae,5,1,"ion-row",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",0==i._flagAvailableSports),e.xp6(1),e.Q6J("ngIf",i._flagAvailableSports))},dependencies:[a.PM,a.wI,a.jY,a.gu,a.Ie,a.Q$,a.Nd,p.sg,p.O5],styles:["swiper-slide[_ngcontent-%COMP%]{max-height:80px}.icon-sport[_ngcontent-%COMP%]{font-size:30px;font-family:sports}.text-sport[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.card-sport[_ngcontent-%COMP%]{width:90%}"]}),o})();r(15383),r(16667);const le=["sliderCampi"];function re(o,l){if(1&o&&(e.TgZ(0,"ion-row",2)(1,"ion-col")(2,"ion-item",3)(3,"ion-label",4),e._uU(4," Il centro "),e.TgZ(5,"ion-text",5),e._uU(6),e.qZA(),e._uU(7," non dispone di campi prenotabili "),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(6),e.Oqu(t.selectedLocation.DENOMINAZIONE)}}function ce(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"swiper-slide")(1,"ion-button",11),e.NdJ("click",function(){const s=e.CHM(t).$implicit,h=e.oxw(3);return e.KtG(h.onChangeCampo(s))}),e._UZ(2,"ion-icon",12),e.TgZ(3,"ion-label",13)(4,"p",14),e._uU(5),e.qZA()()()()}if(2&o){const t=l.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("fill",i.getFill(t))("color",i.getColor(t))("disabled",!i.canChoose),e.xp6(1),e.Q6J("name",i.isSelected(t)?"location-outline":"locate-outline"),e.xp6(3),e.Oqu(t.DENOMINAZIONE)}}function pe(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"swiper-container",8,9),e.NdJ("afterInit",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.swiperReady())}),e.YNc(2,ce,6,5,"swiper-slide",10),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t._listAvailableCampi)}}function de(o,l){if(1&o&&(e.TgZ(0,"ion-row")(1,"ion-col",6),e.YNc(2,pe,3,1,"swiper-container",7),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t._flagAvailableCampi)}}let ge=(()=>{class o{constructor(){this.campoChanged=new e.vpe,this._flagAvailableCampi=!1,this.styleInfoMessage=2,this._direction="horizontal"}set campiList(t){var i;this._listAvailableCampi=t,this._flagAvailableCampi=!!this._listAvailableCampi&&0!=(null===(i=this._listAvailableCampi)||void 0===i?void 0:i.length),this.setSwiperParams()}set direction(t){this._direction=t,this.setSwiperParams()}ngOnInit(){}get showInfoField(){let t=!1;return this.selectedCampo&&this.selectedLocation&&(t=!0),t}get numSlidesPerView(){let t=2.5;switch(this._listAvailableCampi.length){case 1:t=1;break;case 2:t=2;break;default:t=2.5}return t}goToSlide(t){var i;this.swiper&&(null===(i=this.swiper)||void 0===i||i.slideTo(t))}swiperReady(){var t;this.swiper=null===(t=this.swiperRef)||void 0===t?void 0:t.nativeElement.swiper,this.setSwiperParams()}setSwiperParams(){setTimeout(()=>{this.setSwiperProp("slides-per-view",this.numSlidesPerView),this.setSwiperProp("direction",this._direction)},400)}setSwiperProp(t,i){var n;let s=null===(n=this.swiperRef)||void 0===n?void 0:n.nativeElement;s&&s.setAttribute(t,i)}getSwiperObject(){var t;let i=null===(t=this.swiperRef)||void 0===t?void 0:t.nativeElement,n=null;if(i)try{n=i.swiper}catch(s){n=null}return n}onChangeCampo(t){let i=this.getIndexCampo(t);-1!=i&&this.goToSlide(i),this.campoChanged.emit(t)}getIndexCampo(t){let i=-1;return t&&(i=this._listAvailableCampi.findIndex(n=>n.ID==t.ID)),i}getColor(t){let i="primary";return this.selectedCampo&&t&&this.selectedCampo.ID==t.ID&&(i="tertiary"),i}getFill(t){let i="outline";return this.selectedCampo&&t&&this.selectedCampo.ID==t.ID&&(i="solid"),i}isSelected(t){let i=!1;return this.selectedCampo&&t&&this.selectedCampo.ID==t.ID&&(i=!0),i}onChangeInfoStyle(){this.styleInfoMessage=1==this.styleInfoMessage?2:1}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-campi-scroll"]],viewQuery:function(t,i){if(1&t&&e.Gf(le,5),2&t){let n;e.iGM(n=e.CRH())&&(i.swiperRef=n.first)}},inputs:{selectedCampo:"selectedCampo",campiList:"campiList",selectedLocation:"selectedLocation",canChoose:"canChoose",direction:"direction"},outputs:{campoChanged:"campoChanged"},decls:3,vars:2,consts:[["class","ion-text-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center","ion-align-items-center"],["color","light","lines","none"],[1,"ion-text-danger","ion-text-wrap"],[1,"ion-text-bold"],["size","12"],["slides-per-view","1",3,"afterInit",4,"ngIf"],["slides-per-view","1",3,"afterInit"],["sliderCampi",""],[4,"ngFor","ngForOf"],["expand","block","size","large","shape","round","mode","ios",3,"fill","color","disabled","click"],["slot","start",3,"name"],[1,"ion-text-wrap"],[1,"ion-text-bold","ion-text-primary"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-grid"),e.YNc(1,re,8,1,"ion-row",0),e.YNc(2,de,3,1,"ion-row",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!i._flagAvailableCampi),e.xp6(1),e.Q6J("ngIf",i._flagAvailableCampi))},dependencies:[a.YG,a.wI,a.jY,a.gu,a.Ie,a.Q$,a.Nd,a.yW,p.sg,p.O5],styles:["swiper-slide[_ngcontent-%COMP%]{max-height:80px}ion-button[_ngcontent-%COMP%]{width:90%}"]}),o})();var he=r(10004);const ue=["gridcontainer"];function me(o,l){1&o&&e._UZ(0,"ion-spinner",20)}function fe(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"ion-col",21)(1,"app-slottime",22),e.NdJ("clickSlot",function(n){e.CHM(t);const s=e.oxw(3);return e.KtG(s.myClickSlot(n))}),e.qZA()()}if(2&o){const t=l.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("mySlot",t)("readOnly",i.actualSlotDay._TEMPLATELOCK)}}function _e(o,l){if(1&o&&(e.TgZ(0,"ion-row",15)(1,"ion-col")(2,"ion-grid",6)(3,"ion-row")(4,"ion-col")(5,"ion-item",16)(6,"ion-label",17),e._uU(7),e.qZA(),e.YNc(8,me,1,0,"ion-spinner",18),e.qZA()()(),e.TgZ(9,"ion-row"),e.YNc(10,fe,2,2,"ion-col",19),e.qZA()()()()),2&o){const t=e.oxw(2);e.xp6(7),e.hij(" ",t.descriptionScelta," "),e.xp6(1),e.Q6J("ngIf",t.actualSlotDay._TEMPLATELOCK),e.xp6(2),e.Q6J("ngForOf",t.actualSlotDay.SLOTTIMES)}}function Pe(o,l){if(1&o&&(e.TgZ(0,"ion-row")(1,"ion-col"),e._UZ(2,"app-card-image",23),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("text","Le prenotazioni non risultano disponibili presso "+(null==t.selectedLocation?null:t.selectedLocation.DENOMINAZIONE)+", con i parametri inseriti.  Modificare Data/Centro per ricercare slot liberi")}}function Ce(o,l){if(1&o&&(e.TgZ(0,"ion-row",15)(1,"ion-col"),e._UZ(2,"app-card-image",24),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("text","Le prenotazioni non risultano abilitate presso "+(null==t.selectedLocation?null:t.selectedLocation.DENOMINAZIONE)+".  Modificare Data/Centro per ricercare slot liberi")}}function ye(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"ion-grid",6,7)(2,"ion-row")(3,"ion-col",8)(4,"ion-grid",6)(5,"ion-row")(6,"ion-col")(7,"app-sport-scroll",9),e.NdJ("sportChanged",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onChangeSport(n))}),e.qZA()()(),e.TgZ(8,"ion-row")(9,"ion-col")(10,"app-campi-scroll",10),e.NdJ("campoChanged",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onChangeCampo(n))}),e.qZA()()()()(),e.TgZ(11,"ion-col",11)(12,"ion-grid",6)(13,"ion-row",12)(14,"ion-col")(15,"app-calendarscroll",13),e.NdJ("onChangeActiveDay",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.onChangeBookDay(n))}),e.qZA()()(),e.YNc(16,_e,11,3,"ion-row",14),e.YNc(17,Pe,3,1,"ion-row",5),e.YNc(18,Ce,3,1,"ion-row",14),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(7),e.Q6J("selectedSport",t.selectedSport)("sportList",t.listLocationSport)("direction",t.directionSliderSportCampi),e.xp6(3),e.Q6J("selectedCampo",t.selectedCampo)("campiList",t.availableFields)("direction",t.directionSliderSportCampi)("canChoose",t.flagDatiRicevuti&&t.flagPrenotazioneDisponibile)("selectedLocation",t.selectedLocation),e.xp6(5),e.Q6J("activeDay",t.actualBookDay),e.xp6(1),e.Q6J("ngIf",t.flagDatiRicevuti&&t.flagPrenotazioneDisponibile&&t.actualSlotDay.APERTOCHIUSO),e.xp6(1),e.Q6J("ngIf",t.flagDatiRicevuti&&t.flagPrenotazioneDisponibile&&!t.actualSlotDay.APERTOCHIUSO),e.xp6(1),e.Q6J("ngIf",!t.flagPrenotazioneDisponibile)}}function ve(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"ion-footer")(1,"app-footbooked",25),e.NdJ("clickPrenota",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.myClickPrenota(n))}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("myPrenotaPianifica",t.actualPlanning)}}const Ae=[{path:"",component:(()=>{class o{constructor(t,i,n,s,h){this.router=t,this.startService=i,this.navController=n,this.loadingController=s,this.modalCtrl=h,this.idLocation="",this.versionBooking="manual",this.listLocationSport=[],this.flagPrenotazioneDisponibile=!1,this.templateWeekSlot=new E.C,this.actualBookDay=new Date,this.actualCaptionButtonSelected="",this.actualPlanning=new C._,this.availableFields=[],this.indexCount=0,this.showExtraToolbar=!0,this.isOnAppleSystem=!1,this.actualPlanning=new C._,c.M.consoleLog("Constructor Booking Page"),c.M.consoleLog(this.actualPlanning),this.isOnAppleSystem=this.startService.isOnAppleSystem,this.onListenListaSport()}ngOnInit(){this.loadingController.create({message:"Caricamento",spinner:"circular",backdropDismiss:!0}).then(t=>{c.M.consoleLog("Presentazione Loading"),t.present(),this.flagDatiRicevuti=!1,this.flagPrenotazioneDisponibile=!1,this.router.paramMap.subscribe(i=>{c.M.consoleLog("Controllo Routing locationId"),i.has("locationId")?(c.M.consoleLog("locationId trovata"),this.idLocation=i.get("locationId"),this.idLocation&&0!=this.idLocation.length?(c.M.consoleLog("locationId: "+this.idLocation),c.M.consoleLog("Richiesta al server Sport Praticati nella location "),this.startService.requestLocationSport(this.idLocation),c.M.consoleLog("Richiesta al server Location, Campi e CampiSport "),this.startService.requestLocationByID(this.idLocation,3).then(()=>{this.flagDatiRicevuti=!0,t.dismiss()},()=>{t.dismiss(),this.showMessage("Errore di connessione","toast")}),this.sottoscrizioneLocationCampi(),this.subUserLogged=this.startService.flagUtenteIsLoggato$.subscribe(n=>{this.userLogged=n}),this.subDocUtente=this.startService.activeUtenteDoc$.subscribe(n=>{this.docUtente=n}),this.subActualSlotDay=this.startService.docOccupazione.subscribe(n=>{c.M.consoleLog("Variazione Slot Day"),this.actualSlotDay=n,c.M.consoleLog(n)}),this.subActivePrenotazione=this.startService.activePrenotazione.subscribe(n=>{this.activePrenotazione=n})):(t.dismiss(),this.flagPrenotazioneDisponibile=!1,this.flagDatiRicevuti=!0)):(t.dismiss(),this.onGoToBack())})})}updateAvailableFields(){this.selectedLocation&&this.selectedLocation.CAMPO&&(this.availableFields=this.selectedLocation.CAMPO.filter(t=>{let i=!1;if(this.selectedSport)for(const n of t.CAMPOSPORT)if(n.IDSPORT==this.selectedSport.ID){i=!0;break}return i}))}ngOnDestroy(){this.subSelectedLocation&&this.subSelectedLocation.unsubscribe(),this.subUserLogged&&this.subUserLogged.unsubscribe(),this.subDocUtente&&this.subDocUtente.unsubscribe(),this.subActualSlotDay&&this.subActualSlotDay.unsubscribe(),this.subActivePrenotazione&&this.subActivePrenotazione.unsubscribe(),this.subListLocationSport&&this.subListLocationSport.unsubscribe()}get backPathArray(){return["/","appstart-home","tab-home"]}get backButtonHref(){let t="";return t=this.backPathArray.join("/").substring(1),t}onGoToBack(){this.navController.navigateBack(this.backPathArray)}get directionSliderSportCampi(){let t="horizontal";if(this.refGridContainer&&this.refGridContainer.nativeElement)try{const n=this.startService.getDefaultBreakpoint(this.refGridContainer.nativeElement.offsetWidth);["md","lg","xl"].includes(n)&&(t="vertical")}catch(i){t="horizontal"}return t}get descriptionScelta(){let t="";return this.selectedSport&&(t=this.selectedSport.DENOMINAZIONE),this.selectedCampo&&(t+=` su ${this.selectedCampo.DENOMINAZIONE}`),this.selectedLocation&&(t+=` in ${this.selectedLocation.DENOMINAZIONE}`),0==t.length&&(t="SCEGLI ORARIO: "),t}sottoscrizioneLocationCampi(){c.M.consoleLog("Sottoscrizione Location, Campi e CampiSport "),this.subSelectedLocation=this.startService.activeLocation.subscribe(t=>{this.selectedLocation=t,this.selectedLocation&&!this.selectedLocation.do_inserted&&0!==this.selectedLocation.CAMPO.length?(c.M.consoleLog("Ricezione Location, Campi e CampiSport "),this.getTemplateWeek(this.selectedLocation),this.onRefresh()):this.selectedLocation&&this.selectedLocation.CAMPO?(c.M.consoleLog("Location"),c.M.consoleLog(this.selectedLocation),c.M.consoleLog(this.selectedLocation.CAMPO)):c.M.consoleLog("Non ho la location oppure i campi ")})}onListenListaSport(){this.subListLocationSport=this.startService.listLocationSport.subscribe(t=>{this.listLocationSport=t,this.selectedSport=this.listLocationSport&&0!==this.listLocationSport.length?this.listLocationSport[0]:void 0,this.onRefresh()})}onChangeVersion(t){this.versionBooking=t}onRefresh(){this.selectedSport&&this.selectedLocation?(this.availableFields=this.selectedLocation.getAvalaibleFields(this.selectedSport.ID),0!==this.availableFields.length&&(this.selectedCampo=this.availableFields[0]),this.selectedCampo?(c.M.consoleLog("Richiesto Refresh success, getOccupazioni"),this.flagPrenotazioneDisponibile=!!this.selectedCampo,this.getOccupazioni()):c.M.consoleLog("Richiesto Refresh failed NO SELECTED CAMPO")):c.M.consoleLog("Richiesto Refresh failed NO SELECTED SPORT")}onChangeCampo(t){this.selectedCampo=t,this.getOccupazioni()}onChangeBookDay(t){this.actualBookDay=t,this.getOccupazioni()}onChangeSport(t){t&&(this.selectedSport=t,this.onRefresh())}getTemplateWeek(t){this.templateWeekSlot=this.startService.getTemplateSlotWeek(t)}getOccupazioni(){this.actualSlotDay=this.templateWeekSlot.getCopySlotDay(this.actualBookDay,!0),c.M.consoleLog("Richiesta Slot Occupazioni"),this.startService.requestSlotOccupazioni(this.actualSlotDay,this.selectedLocation,this.selectedCampo,this.actualBookDay).then(()=>{1==this.actualSlotDay.APERTOCHIUSO&&(this.actualSlotDay.APERTOCHIUSO=!this.startService.isFestivita(this.actualBookDay,this.selectedLocation.IDAREAOPERATIVA,this.selectedLocation.ID,this.selectedCampo.ID))}).catch(t=>{c.M.consoleLog(t)}),this.actualPlanning=new C._}myClickSlot(t){t&&(t.STATO==d.fu.contattare?this.showAlertContattaStruttura():(this.actualPlanning=this.actualSlotDay.changeSelectionSlotTime(t),console.log(this.actualPlanning)))}showAlertContattaStruttura(){let t=[],i="";i="Per la prenotazione dello slot \xe8 necessario contattare la struttura telefonicamente",t=[{text:"OK",role:"cancel"}],this.selectedLocation.TELEFONO&&this.selectedLocation.TELEFONO.length>0&&(i=i+" al "+this.selectedLocation.TELEFONO,this.startService.isDesktop||(t=[{text:"OK",role:"cancel"},{text:"Chiama",handler:()=>{const n=this.selectedLocation.TELEFONO,s=document.createElement("a");s.setAttribute("href",`tel:${n}`),s.click()}}])),this.startService.presentAlertMessage(i,"Contattare la struttura",t)}visibleFooter(){let t=!1;return this.actualPlanning&&this.actualPlanning.DATAORAINIZIO&&this.actualPlanning.DATAORAFINE&&(t=!0),t}myClickPrenota(t){this.userLogged?this.startService.onVerificationUserData().then(i=>{0==i&&this.execPrenotazione(t)}):(this.startService.setIdAreaForcedForLogin(),this.startService.openFormLogin())}execPrenotazione(t){this.startService.initActivePrenotazione(this.selectedLocation.IDAREAOPERATIVA),this.startService.setIDUtenteActivePrenotazione(this.docUtente),t.IDAREAOPERATIVA=this.selectedLocation.IDAREAOPERATIVA,t.IDLOCATION=this.selectedLocation.ID,t.IDCAMPO=this.selectedCampo.ID,t.IDSPORT=this.selectedSport.ID,t._DESCRCAMPO=this.selectedCampo.DENOMINAZIONE,t._DESCRSPORT=this.selectedSport.DENOMINAZIONE,this.startService.setPianificazioneSingola(t),this.startService.setSelectedCampoPrenotazione(this.selectedCampo),this.calcolaTotale()}calcolaTotale(){this.loadingController.create({message:"Verifica Prenotazione...",spinner:"circular"}).then(t=>{t.present(),this.startService.requestImportoPrenotazione().pipe((0,Z.K)(this.handleError)).subscribe(i=>{t.dismiss();let n=b.i.getPrenotazioneFromJson(i);if(!0===n.ISVALID){let s=n.PRENOTAZIONEPIANIFICAZIONE[0];s._DESCRCAMPO=this.selectedCampo.DENOMINAZIONE,s._DESCRSPORT=this.selectedSport.DENOMINAZIONE,this.startService.setActivePrenotazione(n),this.goToFinalizza()}else this.showMessage(n.MSGINVALID?n.MSGINVALID:"Errore comunicazione imprevisto","alert")},i=>{t.dismiss(),this.showMessage(i,"alert")})})}goToFinalizza(){this.modalCtrl.create({component:M,cssClass:"modal-xl-class",componentProps:{bookId:this.activePrenotazione.ID,locationId:this.selectedLocation.ID}}).then(t=>t.present())}showMessage(t,i="alert"){"alert"==i?this.startService.presentAlertMessage(t):"toast"==i&&this.startService.presentToastMessage(t)}handleError(t){return t.error instanceof ErrorEvent?c.M.consoleLog("Errore di chiamata:"+t.error.message,"error"):c.M.consoleLog(`Errore Backend Codice ${t.status}, Body: ${t.error}`,"error"),(0,k._)("Si sono verificati errori. Riprovare AHIME.")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.gz),e.Y36(w.D),e.Y36(a.SH),e.Y36(a.HT),e.Y36(a.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-location-booking"]],viewQuery:function(t,i){if(1&t&&e.Gf(ue,5,e.SBq),2&t){let n;e.iGM(n=e.CRH())&&(i.refGridContainer=n.first)}},decls:10,vars:3,consts:[["headBook",""],["color","primary"],["slot","start"],[3,"defaultHref"],["class","ion-no-margin ion-no-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-no-margin","ion-no-padding"],["gridcontainer",""],["sizeXs","12","sizeSm","12","sizeMd","4","sizeLg","4","sizeXl","4"],[3,"selectedSport","sportList","direction","sportChanged"],[3,"selectedCampo","campiList","direction","canChoose","selectedLocation","campoChanged"],["sizeXs","12","sizeSm","12","sizeMd","8","sizeLg","8","sizeXl","8"],[1,"ion-margin-top","ion-margin-bottom"],[3,"activeDay","onChangeActiveDay"],["class","ion-no-margin",4,"ngIf"],[1,"ion-no-margin"],["color","success"],[1,"ion-no-padding","ion-text-bold"],["slot","end","name","circular","color","primary",4,"ngIf"],["class","ion-no-margin ion-no-padding","size","6","sizeXl","6","sizeLg","6","sizeMd","6","sizeSm","12","sizeXs","12",4,"ngFor","ngForOf"],["slot","end","name","circular","color","primary"],["size","6","sizeXl","6","sizeLg","6","sizeMd","6","sizeSm","12","sizeXs","12",1,"ion-no-margin","ion-no-padding"],[3,"mySlot","readOnly","clickSlot"],["src","assets/boysplaying_small.png","title","Spiacenti","subtitle","Prenotazione non effettuabile",3,"text"],["src","assets/boysplaying_small.png","title","Spiacenti","subtitle","Prenotazione non disponibile",3,"text"],[3,"myPrenotaPianifica","clickPrenota"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header",null,0)(2,"ion-toolbar",1)(3,"ion-buttons",2),e._UZ(4,"ion-back-button",3),e.qZA(),e.TgZ(5,"ion-title"),e._uU(6,"Prenota"),e.qZA()()(),e.TgZ(7,"ion-content"),e.YNc(8,ye,19,12,"ion-grid",4),e.qZA(),e.YNc(9,ve,2,1,"ion-footer",5)),2&t&&(e.xp6(4),e.Q6J("defaultHref",i.backButtonHref),e.xp6(4),e.Q6J("ngIf",i.flagDatiRicevuti),e.xp6(1),e.Q6J("ngIf",i.visibleFooter()))},dependencies:[p.sg,p.O5,a.oU,a.Sm,a.wI,a.W2,a.fr,a.jY,a.Gu,a.Ie,a.Q$,a.Nd,a.PQ,a.wd,a.sr,a.cs,X,K,te,se,ge,he.Z],styles:["ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light-tint)}ion-content[_ngcontent-%COMP%] > ion-grid[_ngcontent-%COMP%]{--background: var(--ion-color-light-tint)}ion-segment[_ngcontent-%COMP%]{--background: white}.item-campo[_ngcontent-%COMP%], .item-transparent[_ngcontent-%COMP%]{--background: var(--ion-color-light-tint)}.item-campo[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%], .item-transparent[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#999}ion-slide[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}.label-header[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}app-sport-scroll[_ngcontent-%COMP%]{--background: white}.nofind-cnt[_ngcontent-%COMP%]{padding-top:15px}ion-footer[_ngcontent-%COMP%]{border-top:var(--ion-color-tertiary) solid 2px}.custom-toolbar[_ngcontent-%COMP%]{background-color:#fff}"]}),o})()}];let Se=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(Ae),f.Bz]}),o})();var T=r(52382);const we=[{path:"",component:M}];let be=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(we),f.Bz]}),o})();const Oe=[{path:"",component:O.t}];let Me=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(Oe),f.Bz]}),o})(),Ie=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.ez,T.u5,a.Pc,Me]}),o})();var L=r(46939);let Te=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.ez,T.u5,a.Pc,be,Ie,L.q]}),o})();var Le=r(96683);let ze=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.ez,a.Pc,Se,Te,Le.UserDataVerificationPageModule,L.q]}),o})()}}]);