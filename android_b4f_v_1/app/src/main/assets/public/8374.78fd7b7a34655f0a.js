"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8374],{47158:(b,C,l)=>{l.d(C,{z:()=>o});var r=l(69808),A=l(52382),T=l(7706),d=l(2840),u=l(58595),h=l(31223);const P=[{path:"",component:u.W}];let m=(()=>{class c{}return c.\u0275fac=function(I){return new(I||c)},c.\u0275mod=h.oAB({type:c}),c.\u0275inj=h.cJS({imports:[d.Bz.forChild(P),d.Bz]}),c})();var D=l(24586),a=l(46939);let o=(()=>{class c{}return c.\u0275fac=function(I){return new(I||c)},c.\u0275mod=h.oAB({type:c}),c.\u0275inj=h.cJS({imports:[r.ez,A.u5,T.Pc,m,D.D,a.q]}),c})()},58595:(b,C,l)=>{l.d(C,{W:()=>V});var r=l(13396),A=l(52015),T=l(16667),d=l(37708),u=l(34021),h=l(48622),P=l(75822),m=l(16905),D=l(34370),a=l(69129),o=l(31223),c=l(7706),f=l(69808),I=l(52382),x=l(97952),O=l(61626);function S(t,_){if(1&t&&(o.TgZ(0,"ion-text"),o._uU(1),o._UZ(2,"br"),o._uU(3),o.qZA()),2&t){const e=o.oxw(2);o.xp6(1),o.AsE(" per un totale di\xa0",e.corsoDoc.NUMEROLEZIONI,"\xa0",e.corsoDoc.NUMEROLEZIONI>1?"Incontri":"Incontro "," "),o.xp6(2),o.AsE("della durata di\xa0",e.corsoDoc.ORELEZIONE," ",e.corsoDoc.ORELEZIONE>1?"Ore":"Ora"," ")}}function E(t,_){if(1&t&&(o.TgZ(0,"ion-list")(1,"ion-item",41)(2,"ion-label"),o._uU(3),o.ALo(4,"uppercase"),o.qZA()()()),2&t){const e=_.$implicit;o.xp6(3),o.Oqu(o.lcZ(4,1,e.label))}}function Z(t,_){if(1&t&&(o.TgZ(0,"ion-accordion-group")(1,"ion-accordion")(2,"ion-item",37)(3,"ion-label",12),o._uU(4," Lezioni Settimanali "),o.qZA(),o.TgZ(5,"ion-badge",38),o._uU(6),o.qZA()(),o.TgZ(7,"div",39),o.YNc(8,E,5,3,"ion-list",40),o.TgZ(9,"ion-item")(10,"ion-label",12),o._uU(11," controllare il calendario dettagliato per orari e giornate di corso "),o.qZA()()()()()),2&t){const e=o.oxw(2);o.xp6(6),o.hij(" \xa0",null==e.onlyDaysCorso?null:e.onlyDaysCorso.length,"\xa0 "),o.xp6(2),o.Q6J("ngForOf",e.onlyDaysCorso)}}function M(t,_){if(1&t&&(o.TgZ(0,"ion-item",14),o._UZ(1,"ion-icon",42),o.TgZ(2,"ion-label"),o._uU(3),o.ALo(4,"targetSesso"),o.qZA()()),2&t){const e=o.oxw(2);o.xp6(1),o.Q6J("color",e.iconColor),o.xp6(2),o.Oqu(o.lcZ(4,2,e.corsoDoc.TARGETSESSO))}}function y(t,_){if(1&t&&(o.TgZ(0,"ion-item",14),o._UZ(1,"ion-icon",44),o.TgZ(2,"ion-label"),o._uU(3),o.qZA()()),2&t){const e=o.oxw(3);o.xp6(1),o.Q6J("color",e.iconColor),o.xp6(2),o.Oqu(null==e.locationDoc?null:e.locationDoc.COMUNE)}}function L(t,_){if(1&t&&(o.TgZ(0,"ion-item",14),o._UZ(1,"ion-icon",45),o.TgZ(2,"ion-label"),o._uU(3),o.qZA()()),2&t){const e=o.oxw(3);o.xp6(1),o.Q6J("color",e.iconColor),o.xp6(2),o.hij(" ",null==e.locationDoc?null:e.locationDoc.INDIRIZZO," ")}}function v(t,_){if(1&t&&(o.TgZ(0,"ion-item",14),o._UZ(1,"ion-icon",46),o.TgZ(2,"ion-label"),o._uU(3),o.qZA()()),2&t){const e=o.oxw(3);o.xp6(1),o.Q6J("color",e.iconColor),o.xp6(2),o.Oqu(null==e.locationDoc?null:e.locationDoc.TELEFONO)}}function N(t,_){if(1&t&&(o.TgZ(0,"ion-accordion-group")(1,"ion-accordion",18)(2,"ion-item",19),o._UZ(3,"ion-icon",43),o.TgZ(4,"ion-label",12),o._uU(5,"dove si svolge"),o.qZA()(),o.TgZ(6,"div",21)(7,"ion-list",15),o.YNc(8,y,4,2,"ion-item",24),o.YNc(9,L,4,2,"ion-item",24),o.YNc(10,v,4,2,"ion-item",24),o.qZA()()()()),2&t){const e=o.oxw(2);o.xp6(8),o.Q6J("ngIf",null==e.locationDoc?null:e.locationDoc.COMUNE),o.xp6(1),o.Q6J("ngIf",null==e.locationDoc?null:e.locationDoc.INDIRIZZO),o.xp6(1),o.Q6J("ngIf",null==e.locationDoc?null:e.locationDoc.TELEFONO)}}function z(t,_){if(1&t&&(o.TgZ(0,"ion-item")(1,"ion-label"),o._uU(2),o.ALo(3,"date"),o.qZA(),o.TgZ(4,"ion-button",50),o._uU(5),o.ALo(6,"currency"),o.qZA()()),2&t){const e=_.$implicit;o.xp6(2),o.hij(" ",o.xi3(3,2,e.DATASCADENZA,"dd/MM/yyyy")," "),o.xp6(3),o.hij(" ",o.xi3(6,5,e.IMPORTO,"EUR")," ")}}function R(t,_){if(1&t&&(o.TgZ(0,"ion-list",9),o.YNc(1,z,7,8,"ion-item",40),o.qZA()),2&t){const e=o.oxw(3);o.xp6(1),o.Q6J("ngForOf",null==e.iscrizioneDoc?null:e.iscrizioneDoc.ISCRIZIONEINCASSO)}}function U(t,_){if(1&t&&(o.TgZ(0,"ion-item")(1,"ion-radio",55)(2,"h6"),o._uU(3),o.qZA(),o.TgZ(4,"p",56),o._uU(5),o.qZA()()()),2&t){const e=_.$implicit;o.xp6(1),o.Q6J("value",e.ID),o.xp6(2),o.Oqu(e.DESCR),o.xp6(2),o.hij(" ",e.getLabelForScadenza()," ")}}function w(t,_){if(1&t){const e=o.EpF();o.TgZ(0,"ion-row",51)(1,"ion-col")(2,"ion-accordion-group")(3,"ion-accordion",52)(4,"ion-item",37)(5,"ion-label",12)(6,"p",53),o._uU(7,"Scegli una formula differente"),o.qZA()()(),o.TgZ(8,"div",39)(9,"ion-list",15)(10,"ion-radio-group",54),o.NdJ("ngModelChange",function(n){o.CHM(e);const s=o.oxw(3);return o.KtG(s.onChangeTipoPagamento(n))})("ngModelChange",function(n){o.CHM(e);const s=o.oxw(3);return o.KtG(s.idSelectedTipoPagamento=n)}),o.YNc(11,U,6,3,"ion-item",40),o.qZA()()()()()()()}if(2&t){const e=o.oxw(3);o.xp6(10),o.Q6J("ngModel",e.idSelectedTipoPagamento),o.xp6(1),o.Q6J("ngForOf",e.listTipiPagamento)}}function F(t,_){if(1&t&&(o.TgZ(0,"ion-grid",9)(1,"ion-row",9)(2,"ion-col")(3,"ion-item",15)(4,"ion-label",12)(5,"p",16),o._uU(6," Il corso verr\xe0 saldato con formula "),o.qZA()(),o.TgZ(7,"ion-button",47),o._uU(8),o.qZA()()()(),o.YNc(9,R,2,1,"ion-list",31),o.YNc(10,w,12,2,"ion-row",48),o.TgZ(11,"ion-row",9)(12,"ion-col")(13,"ion-label")(14,"p",49),o._uU(15," Per qualsiasi problematica, o per richiedere particolari condizioni di pagamento rateale contattare la struttura "),o.TgZ(16,"strong"),o._uU(17),o.qZA()()()()()()),2&t){const e=o.oxw(2);o.xp6(8),o.hij(" ",e.labelInfoSelectedTipoPagamento," "),o.xp6(1),o.Q6J("ngIf",e.selectedTipoPagamento.isRateale()&&0!=(null==e.iscrizioneDoc?null:e.iscrizioneDoc.ISCRIZIONEINCASSO.length)),o.xp6(1),o.Q6J("ngIf",e.listTipiPagamento.length>1),o.xp6(7),o.Oqu(null!=e.locationDoc&&e.locationDoc.TELEFONO&&0!=(null==e.locationDoc?null:e.locationDoc.TELEFONO.length)?"al numero "+(null==e.locationDoc?null:e.locationDoc.TELEFONO):"")}}function k(t,_){if(1&t&&(o.TgZ(0,"ion-col",59)(1,"ion-label",12)(2,"small"),o._uU(3),o.qZA()()()),2&t){const e=o.oxw().$implicit;o.xp6(3),o.Oqu(e.DESCR)}}function q(t,_){1&t&&(o.TgZ(0,"ion-col",60)(1,"ion-badge",41)(2,"small"),o._uU(3,"GRATUITA"),o.qZA()()())}function J(t,_){1&t&&(o.TgZ(0,"p")(1,"small"),o._uU(2,"(prezzo escluso imposte)"),o.qZA()())}function B(t,_){if(1&t&&(o.TgZ(0,"ion-col",59)(1,"ion-label",12)(2,"small"),o._uU(3),o.qZA(),o.YNc(4,J,3,0,"p",5),o.qZA()()),2&t){const e=o.oxw().$implicit;o.xp6(3),o.Oqu(e.DESCR),o.xp6(1),o.Q6J("ngIf",0!=e.ALIQUOTA)}}function Q(t,_){if(1&t&&(o.TgZ(0,"ion-col",60)(1,"ion-label",12)(2,"small"),o._uU(3),o.ALo(4,"currency"),o.qZA()()()),2&t){const e=o.oxw().$implicit;o.xp6(3),o.Oqu(o.xi3(4,1,e.IMPONIBILE,"EUR"))}}function Y(t,_){if(1&t&&(o.TgZ(0,"ion-row"),o.YNc(1,k,4,1,"ion-col",57),o.YNc(2,q,4,0,"ion-col",58),o.YNc(3,B,5,2,"ion-col",57),o.YNc(4,Q,5,4,"ion-col",58),o.qZA()),2&t){const e=_.$implicit;o.xp6(1),o.Q6J("ngIf",e.GRATUITA),o.xp6(1),o.Q6J("ngIf",e.GRATUITA),o.xp6(1),o.Q6J("ngIf",!e.GRATUITA),o.xp6(1),o.Q6J("ngIf",!e.GRATUITA)}}function K(t,_){if(1&t&&(o.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-accordion-group")(3,"ion-accordion",18)(4,"ion-item",37)(5,"ion-badge",38),o._uU(6),o.qZA(),o.TgZ(7,"ion-label",12),o._uU(8),o.qZA()(),o.TgZ(9,"div",39),o._uU(10," Il totale \xe8 comprensivo della emissione/rinnovo delle seguenti tessere "),o.TgZ(11,"ion-grid"),o.YNc(12,Y,5,4,"ion-row",40),o.qZA()()()()()()),2&t){const e=o.oxw(2);o.xp6(6),o.hij("\xa0",null==e.collTesseramenti?null:e.collTesseramenti.length,"\xa0"),o.xp6(2),o.Oqu(1==(null==e.collTesseramenti?null:e.collTesseramenti.length)?"Tessera Associativa":"Tessere Associative"),o.xp6(4),o.Q6J("ngForOf",e.collTesseramenti)}}function G(t,_){if(1&t){const e=o.EpF();o.TgZ(0,"ion-row",9)(1,"ion-col")(2,"app-payment-mode",61),o.NdJ("onPaymentModeChoosed",function(n){o.CHM(e);const s=o.oxw(2);return o.KtG(s.onPaymentModeSelected(n))}),o.qZA()()()}if(2&t){const e=o.oxw(2);o.xp6(2),o.Q6J("iconMode",!0)("arPayment",e.myListModePayment)}}function W(t,_){1&t&&o._UZ(0,"ion-icon",62)}function $(t,_){if(1&t){const e=o.EpF();o.TgZ(0,"div",6)(1,"ion-grid")(2,"ion-row")(3,"ion-col",7)(4,"ion-grid",8)(5,"ion-row",9)(6,"ion-col")(7,"ion-button",10),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onClickButtonHeader())}),o._UZ(8,"ion-icon",11),o.TgZ(9,"h6",12),o._uU(10),o.qZA()()()(),o.TgZ(11,"ion-row",13)(12,"ion-col")(13,"ion-card",9)(14,"ion-card-content",14)(15,"ion-item",15)(16,"ion-label",12)(17,"ion-text"),o._uU(18,"Il corso"),o.qZA(),o.TgZ(19,"ion-text",16),o._uU(20),o.qZA(),o.TgZ(21,"ion-text"),o._uU(22),o.qZA(),o.TgZ(23,"ion-text"),o._uU(24,"inizia\xa0"),o.qZA(),o._UZ(25,"br"),o.TgZ(26,"ion-text",17),o._uU(27),o.ALo(28,"titlecase"),o.ALo(29,"date"),o.qZA(),o.TgZ(30,"ion-text",17),o._uU(31),o.ALo(32,"date"),o.qZA(),o._UZ(33,"br"),o.TgZ(34,"ion-text"),o._uU(35,"\xa0alle ore\xa0"),o.qZA(),o.TgZ(36,"ion-text",17),o._uU(37),o.ALo(38,"date"),o.qZA(),o._UZ(39,"br"),o.TgZ(40,"ion-text"),o._uU(41,"\xa0e si conclude\xa0"),o.qZA(),o._UZ(42,"br"),o.TgZ(43,"ion-text",17),o._uU(44),o.ALo(45,"titlecase"),o.ALo(46,"date"),o.qZA(),o.TgZ(47,"ion-text",17),o._uU(48),o.ALo(49,"date"),o.qZA(),o._UZ(50,"br"),o.YNc(51,S,4,4,"ion-text",5),o.qZA()(),o.YNc(52,Z,12,2,"ion-accordion-group",5),o.TgZ(53,"ion-accordion-group")(54,"ion-accordion",18)(55,"ion-item",19),o._UZ(56,"ion-icon",20),o.TgZ(57,"ion-label",12),o._uU(58,"a chi \xe8 rivolto"),o.qZA()(),o.TgZ(59,"div",21)(60,"ion-list",15)(61,"ion-item",14),o._UZ(62,"ion-icon",22),o.TgZ(63,"ion-label"),o._uU(64),o.qZA()(),o.TgZ(65,"ion-item",14),o._UZ(66,"ion-icon",23),o.TgZ(67,"ion-label"),o._uU(68),o.qZA()(),o.YNc(69,M,5,4,"ion-item",24),o.qZA()()()(),o.YNc(70,N,11,3,"ion-accordion-group",5),o.qZA()()()()()(),o.TgZ(71,"ion-col",7)(72,"ion-grid")(73,"ion-row")(74,"ion-col")(75,"ion-card",9)(76,"ion-card-header")(77,"ion-grid")(78,"ion-row",25)(79,"ion-col",26)(80,"h6",27),o._uU(81,"Quota Iscrizione"),o.qZA()(),o.TgZ(82,"ion-col",28)(83,"h5",29),o._uU(84),o.ALo(85,"currency"),o.qZA()()()()(),o.TgZ(86,"ion-card-content",30),o.YNc(87,F,18,4,"ion-grid",31),o.TgZ(88,"ion-grid"),o.YNc(89,K,13,3,"ion-row",5),o.YNc(90,G,3,2,"ion-row",31),o.TgZ(91,"ion-row",32)(92,"ion-col")(93,"ion-item",33),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onClickCondizioniVendita())}),o.TgZ(94,"ion-label",12)(95,"p",16)(96,"small"),o._uU(97,"prima di continuare \xe8 necessario leggere ed accettare le condizioni di vendita"),o.qZA()()()()()(),o.TgZ(98,"ion-row",9)(99,"ion-col",34)(100,"ion-button",35),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onClickChangeFlagCondizioni())}),o.YNc(101,W,1,0,"ion-icon",36),o._uU(102),o.qZA()()()()()()()()()()()()()}if(2&t){const e=o.oxw();o.xp6(7),o.Q6J("color",e.flagPostiDisponibili?"success":"danger"),o.xp6(1),o.Q6J("name",e.flagPostiDisponibili?"thumbs-up-outline":"ban-outline"),o.xp6(2),o.hij(" ",e.txtPostiDisponibili," "),o.xp6(10),o.hij("\xa0",e.corsoDoc.DENOMINAZIONE,"\xa0"),o.xp6(2),o.hij("\xa0(",e.corsoDoc._DENOMINAZIONE_Sport,")\xa0"),o.xp6(5),o.hij("",o.lcZ(28,25,o.xi3(29,27,e.corsoDoc.DATAINIZIO,"EEEE")),"\xa0"),o.xp6(4),o.Oqu(o.xi3(32,30,e.corsoDoc.DATAINIZIO,"dd/MM/yyyy")),o.xp6(6),o.Oqu(o.xi3(38,33,e.corsoDoc.ORAINIZIO,"HH:mm")),o.xp6(7),o.hij("",o.lcZ(45,36,o.xi3(46,38,e.corsoDoc.DATAFINE,"EEEE")),"\xa0"),o.xp6(4),o.Oqu(o.xi3(49,41,e.corsoDoc.DATAFINE,"dd/MM/yyyy")),o.xp6(3),o.Q6J("ngIf",e.corsoDoc.NUMEROLEZIONI),o.xp6(1),o.Q6J("ngIf",0!=(null==e.onlyDaysCorso?null:e.onlyDaysCorso.length)),o.xp6(10),o.Q6J("color",e.iconColor),o.xp6(2),o.hij("",e.corsoDoc._DENOMINAZIONE_Livello?e.corsoDoc._DENOMINAZIONE_Livello:"Tutti i Livelli"," "),o.xp6(2),o.Q6J("color",e.iconColor),o.xp6(2),o.Oqu(e.corsoDoc._DESCTOOLTIP_CategoriaEta?e.corsoDoc._DESCTOOLTIP_CategoriaEta:"Per tutte le et\xe0"),o.xp6(1),o.Q6J("ngIf",e.corsoDoc.TARGETSESSO),o.xp6(1),o.Q6J("ngIf",e.locationDoc),o.xp6(14),o.Oqu(o.xi3(85,44,null==e.iscrizioneDoc?null:e.iscrizioneDoc.TOTALE,"EUR")),o.xp6(3),o.Q6J("ngIf",null==e.corsoDoc?null:e.corsoDoc.isAPagamento()),o.xp6(2),o.Q6J("ngIf",e.showGroupTesseramenti),o.xp6(1),o.Q6J("ngIf",null==e.corsoDoc?null:e.corsoDoc.isAPagamento()),o.xp6(10),o.Q6J("color",e.flagCondizioni?"success":"danger"),o.xp6(1),o.Q6J("ngIf",e.flagCondizioni),o.xp6(1),o.hij(" ",e.flagCondizioni?"ACCETTO":"NON ACCETTO"," ")}}function j(t,_){if(1&t){const e=o.EpF();o.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-button",63),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onClickContattaStruttura())}),o._uU(3," Contatta la struttura per l'iscrizione "),o.qZA()()()}}function H(t,_){if(1&t){const e=o.EpF();o.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-button",64),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onClickConfirmIscrizione())}),o._uU(3," Iscriviti Gratuitamente "),o.qZA()()()}}function X(t,_){if(1&t){const e=o.EpF();o.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-button",64),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onClickConfirmIscrizione())}),o._uU(3," Concludi Iscrizione "),o.qZA()()()}}let V=(()=>{class t{constructor(e,i,n,s,g,p){this.startService=e,this.navParams=i,this.loadingController=n,this.modalCtrl=s,this.docStructureService=g,this.navCtrl=p,this.corsoDoc=new A._,this.loadingComplete=!1,this.locationDoc=new T.Y,this.iconColor="primary",this.userLogged=!1,this.enableIscrizioni=!1,this.disclaimer=!0,this.onlyDaysCorso=[],this.flagPostiDisponibili=!1,this.txtPostiDisponibili="",this.modalitaSaldo="unico",this.flagCondizioni=!0,this.onListenSelectedArea(),this.onListenSelectedUser()}ngOnInit(){if(this.isDesktop=!1,this.idCorso=this.navParams.get("idCorso"),this.idCorso&&0!=this.idCorso.length)this.loadingController.create({message:"Caricamento Corso"}).then(e=>{this.loadingComplete=!1,e.present(),this.startService.requestCorsoById(this.idCorso,1,!0).then(i=>this.docStructureService.loadCollection(i,"PIANIFICAZIONECORSO")).then(i=>(this.corsoDoc=i,this.onlyDaysCorso=this.corsoDoc.getArrayGiorniCorso(),this.startService.requestListTipiPagamenti(2))).then(i=>(this.listTipiPagamento=i,this.onSelectDefaultTypePayment())).then(()=>this.prepareEnvironment()).then(()=>{this.loadingComplete=!0,e.dismiss()}).catch(i=>{e.dismiss();let n="",s="";a.M.consoleLog(i,"error"),s="Recupero Fallito",n="<p>Non sono riuscito a recuperare le informazioni complete per effettuare l'iscrizione</p>","string"==typeof i&&(n+=`<p>${i}</p>`),this.closeModal(n,"Recupero Fallito")})});else{let e="",i="";a.M.consoleLog("IdCorso undefined","error"),i="Recupero Fallito",e="Non sono riuscito a recuperare il corso (non definito)",this.closeModal(e,i)}}ngOnDestroy(){this.listenerCorsoDoc&&this.listenerCorsoDoc.unsubscribe(),this.listenerUserLogged&&this.listenerUserLogged.unsubscribe(),this.listenSelectedArea&&this.listenSelectedArea.unsubscribe()}onListenSelectedArea(){this.listenSelectedArea=this.startService.areaSelected.subscribe(e=>{this.selectedArea=e,this.setListPayment(),this.enableIscrizioni=1==this.selectedArea.APPISCRIZIONI},e=>{this.enableIscrizioni=!1})}onListenSelectedUser(){this.listenerUserLogged=this.startService.flagUtenteIsLoggato$.subscribe(e=>{this.userLogged=e}),this.listenerUserDoc=this.startService.activeUtenteDoc$.subscribe(e=>{this.userDoc=e,this.loadingComplete&&this.prepareDocIscrizione(this.corsoDoc,this.userDoc)})}requestLocationById(e){return new Promise((i,n)=>{let s=new T.Y(!0);s.ID=e,this.docStructureService.requestNew(s).then(g=>{g&&0!=g.length?(this.locationDoc=g[0],i()):n("Location not found")}).catch(g=>{n("Connection error"+g)})})}prepareEnvironment(){return new Promise((e,i)=>{let n=[];n.push(this.requestPostiDisponibili(this.corsoDoc.ID)),n.push(this.requestLocationById(this.corsoDoc.IDLOCATION)),n.push(this.prepareDocIscrizione(this.corsoDoc,this.userDoc)),Promise.all(n).then(()=>{e()}).catch(s=>{i(s)})})}requestPostiDisponibili(e){return new Promise((i,n)=>{this.startService.getPostiDisponibiliCorso(e).then(s=>{this.flagPostiDisponibili=!!s.result,this.txtPostiDisponibili=s.message,i()}).catch(s=>{n()})})}prepareDocIscrizione(e,i){return new Promise((n,s)=>{let g=!1;this.iscrizioneDoc||(this.iscrizioneDoc=new m.T,this.iscrizioneDoc.DATAISCRIZIONE=new Date),this.iscrizioneDoc.IDTIPOPAGAMENTO!=this.selectedTipoPagamento.ID&&(this.iscrizioneDoc.IDTIPOPAGAMENTO=this.selectedTipoPagamento.ID,g=!0),e&&e.ID!=this.iscrizioneDoc.IDCORSO&&(this.iscrizioneDoc.IDCORSO=e.ID,g=!0),i&&i.ID!=this.iscrizioneDoc.IDUTENTE&&(this.iscrizioneDoc.IDUTENTE=i.ID,g=!0),g?this.startService.onRequestIscrizioneDocFor(this.iscrizioneDoc).then(p=>{this.iscrizioneDoc=p,console.log(p),n()}).catch(p=>{a.M.consoleLog(p),s(p)}):n()})}setAdditionalInfoTipoPagamento(e){e&&(this.idSelectedTipoPagamento=e.ID,this.labelInfoSelectedTipoPagamento=e.getLabelForScadenza())}onChangeTipoPagamento(e){this.selectedTipoPagamento=this.listTipiPagamento.find(i=>i.ID==e),this.setAdditionalInfoTipoPagamento(this.selectedTipoPagamento),this.startService.showLoadingMessage("Ricalcolo scadenze").then(i=>{i.present(),this.prepareDocIscrizione(this.corsoDoc,this.userDoc).then(()=>{i.dismiss()}).catch(n=>{i.dismiss().then(s=>{s&&this.startService.presentAlertMessage(n)})})})}onSelectDefaultTypePayment(){return new Promise((e,i)=>{this.listTipiPagamento&&0!=this.listTipiPagamento.length?(1==this.listTipiPagamento.length?this.selectedTipoPagamento=this.listTipiPagamento[0]:(this.selectedTipoPagamento=this.listTipiPagamento.find(n=>1==n.PREDEFINITACORSI),this.selectedTipoPagamento||(this.selectedTipoPagamento=this.listTipiPagamento[0])),this.setAdditionalInfoTipoPagamento(this.selectedTipoPagamento),e()):i("Nessuna modalit\xe0 di pagamento impostata")})}getIcon(e){return this.startService.getSportIcon(e.IDSPORT)}onClickCondizioniVendita(){let e;this.selectedArea&&(e=this.selectedArea.findAreaLinkByPageType(u.GV.condizioniVenditaIscrizioni),e&&e.REFERURL&&this.startService.openLink(e.REFERURL))}onClickButtonHeader(){this.flagPostiDisponibili||this.closeModal()}closeModal(e,i,n){this.modalCtrl.dismiss().then(s=>{s&&(n&&0!=n.length&&this.navCtrl.navigateRoot(n),e&&0!=e.length&&this.startService.presentAlertMessage(e,i))})}onClickContattaStruttura(){let e=[],i="";i="Per l'iscrizione \xe8 necessario contattare la struttura telefonicamente",e=[{text:"OK",role:"cancel"}],this.locationDoc.TELEFONO&&0!=this.locationDoc.TELEFONO.length&&(i+=` al <strong>${this.locationDoc.TELEFONO}</strong>`,this.startService.isDesktop||(e=[{text:"OK",role:"cancel"},{text:"Chiama",handler:()=>{const n=this.locationDoc.TELEFONO,s=document.createElement("a");s.setAttribute("href",`tel:${n}`),s.click()}}])),this.startService.presentAlertMessage(i,"Contatti",e)}onClickChangeFlagCondizioni(){this.flagCondizioni=!this.flagCondizioni}get showGroupTesseramenti(){let e=!1;return this.iscrizioneDoc&&this.iscrizioneDoc.ISCRIZIONETESSERAMENTO&&0!=this.iscrizioneDoc.ISCRIZIONETESSERAMENTO.length&&(e=!0),e}get collTesseramenti(){let e;return this.iscrizioneDoc&&this.iscrizioneDoc.ISCRIZIONETESSERAMENTO&&(e=this.iscrizioneDoc.ISCRIZIONETESSERAMENTO),e}setListPayment(){this.myListModePayment=[],this.selectedArea&&(this.myListModePayment=this.selectedArea.getPaymentFor(u.O4.settorePagamentoCorso),this.mySelectedModePayment=this.myListModePayment&&0!=this.myListModePayment.length?this.myListModePayment[0]:null)}onPaymentSelected(e){this.mySelectedModePayment=e}onPaymentModeSelected(e){this.myModePayment=e}onClickConfirmIscrizione(){if(this.iscrizioneDoc.IDTIPOPAGAMENTO=this.idSelectedTipoPagamento,this.flagCondizioni)this.onExecPayment();else{let e="";e="<p>Per continuare &egrave necessario <strong>accettare</strong> le condizioni di vendita</p>",this.startService.presentAlertMessage(e)}}onExecPayment(){let e,i,n,s="";this.iscrizioneDoc&&(e=this.iscrizioneDoc.sumScadenzeFor(new Date),0==e.totale?(i=new d.b(u.x6.pagaStruttura),this.onPaymentSuccess(i)):this.myModePayment!=u.x6.pagaAdesso?(i=new d.b(this.myModePayment),this.onPaymentSuccess(i)):(n=new d.b(this.myModePayment),n.amount=e.totale,s="Pagamento Iscrizione Corso "+this.corsoDoc.DENOMINAZIONE,this.selectedTipoPagamento.isRateale()&&(s+=1==e.numeroRate?` (Rata 1 di ${this.iscrizioneDoc.ISCRIZIONEINCASSO.length})`:` (${e.numeroRate} Rate di ${this.iscrizioneDoc.ISCRIZIONEINCASSO.length})`),n.description=s,n.currency="EUR",this.modalCtrl.create({component:h.t,cssClass:"modal-xl-class",componentProps:{paymentData:n,listAreaPaymentSettings:this.myListModePayment}}).then(g=>(g.present(),g.onDidDismiss())).then(g=>{let p=g.data;p?p.processResult?this.onPaymentSuccess(p):this.onPaymentFailed(p):(p=new d.b(this.myModePayment),p.processResult=!1,p.messageResult="Pagamento fallito",this.onPaymentFailed(p))})))}onPaymentSuccess(e){e&&(e.modePayment==u.x6.pagaAdesso&&this.iscrizioneDoc.setScadenzePayedFor(new Date,e),this.startService.showLoadingMessage("Richiesta Iscrizione","bubbles",!1).then(i=>{i.present(),this.startService.requestSaveIscrizioneCorso(this.iscrizioneDoc).then(n=>{i.dismiss(),n.result&&n.code&&0!=n.code.length?this.onAfterSaveIscrizione(n.code):this.startService.presentAlertMessage(n.message,"Iscrizione Fallita")}).catch(n=>{i.dismiss(),this.startService.presentAlertMessage(n.message,"Iscrizione Fallita")})}))}onPaymentSuccess_old(e){let i;e&&e.modePayment==u.x6.pagaAdesso&&this.iscrizioneDoc.setScadenzePayedFor(new Date,e),i=new D.P,e&&e.processResult&&(0==e.idElectronicResult.length?this.corsoDoc.isAPagamento()?(i.IDTRANSACTION="",i.IDORDER="",i.MODALITA=e.channelPayment,i.TIPORIGO=u.tE.scadenza,i.ZORDER=u.oB.daIncassare,i.DATASCADENZA=this.corsoDoc.DATAINIZIO,i.IMPORTO=this.iscrizioneDoc.TOTALE):(i.IDTRANSACTION="",i.IDORDER="",i.MODALITA=u.$s.onSite,i.TIPORIGO=u.tE.incassato,i.ZORDER=u.oB.incassato,i.DATAOPERAZIONE=this.iscrizioneDoc.DATAISCRIZIONE,i.IMPORTO=0):(i.IDTRANSACTION="",i.IDORDER=e.idElectronicResult,i.MODALITA=e.channelPayment,i.TIPORIGO=u.tE.incassato,i.ZORDER=u.oB.incassato,i.DATAOPERAZIONE=this.iscrizioneDoc.DATAISCRIZIONE,i.IMPORTO=this.iscrizioneDoc.TOTALE),this.iscrizioneDoc.ISCRIZIONEINCASSO.push(i),this.startService.showLoadingMessage("Richiesta Iscrizione","bubbles",!1).then(n=>{n.present(),this.startService.requestSaveIscrizioneCorso(this.iscrizioneDoc).then(s=>{n.dismiss(),s.result&&s.code&&0!=s.code.length?this.onAfterSaveIscrizione(s.code):this.startService.presentAlertMessage(s.message,"Iscrizione Fallita")}).catch(s=>{n.dismiss(),this.startService.presentAlertMessage(s.message,"Iscrizione Fallita")})}))}onExecPayment_old(){let e=[u.x6.pagaAdesso,u.x6.pagaBonifico,u.x6.pagaStruttura];if(this.corsoDoc.isAPagamento())if(e.includes(this.myModePayment))if(this.myModePayment==u.x6.pagaBonifico||this.myModePayment==u.x6.pagaStruttura){let i=new d.b(this.myModePayment);this.onPaymentSuccess(i)}else{this.selectedTipoPagamento.isRateale();let i=new d.b(this.myModePayment);i.amount=this.iscrizioneDoc.TOTALE,i.description="Pagamento Iscrizione Corso "+this.corsoDoc.DENOMINAZIONE,i.currency="EUR",this.modalCtrl.create({component:h.t,componentProps:{paymentData:i,listAreaPaymentSettings:this.myListModePayment}}).then(n=>(n.present(),n.onDidDismiss())).then(n=>{let s=n.data;s?s.processResult?this.onPaymentSuccess(s):this.onPaymentFailed(s):(s=new d.b(this.myModePayment),s.processResult=!1,s.messageResult="Pagamento fallito",this.onPaymentFailed(s))})}else this.startService.presentAlertMessage("E' necessario selezionare un pagamento");else{let i=new d.b(u.x6.pagaStruttura);this.onPaymentSuccess(i)}}onAfterSaveIscrizione(e){let g,i="",n="",s="";n="Iscrizione completata",i=`<p>L'iscrizione ${this.corsoDoc.TIPO==u.oG.corso?"al corso":"alla prova"}</p>`,i+=`<p><strong>${this.corsoDoc.DENOMINAZIONE}</strong></p>`,i+="<p>&Egrave; stata completata con successo",this.corsoDoc.isAPagamento()&&0!=this.iscrizioneDoc.RESIDUO&&(s=this.iscrizioneDoc.RESIDUO.toLocaleString("it-IT",{minimumFractionDigits:2}),i+=`<p><strong>${s} \u20ac</strong></p>`,i+="<p>",i+="rimangono da versare alla struttura",this.selectedTipoPagamento.isRateale()?i+=` in modalit&agrave; ${this.selectedTipoPagamento.getLabelForScadenza()}`:i+=" in rata unica",i+="</p>"),g=this.startService.getUrlPageHistoryPersonal("course",e),this.closeModal(i,"Iscrizione completata",g)}onPaymentFailed(e){let i="Si sono verificati errori nel pagamento";e&&e.messageResult&&(i=e.messageResult),this.startService.presentAlertMessage(i,"Pagamento Fallito")}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(P.D),o.Y36(c.X1),o.Y36(c.HT),o.Y36(c.IN),o.Y36(r.l),o.Y36(c.SH))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-location-course-subscribe"]],decls:14,vars:4,consts:[["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","ios","close","md","close"],["style","background-color:#EFF1F8",4,"ngIf"],[4,"ngIf"],[2,"background-color","#EFF1F8"],["size","12","size-xl","6","size-sm","12"],["id","info-corso"],[1,"ion-no-padding","ion-no-margin"],["expand","block",1,"full-buttons",3,"color","click"],["slot","end",3,"name"],[1,"ion-text-wrap"],["id","row-info-corso",1,"ion-no-padding","ion-no-margin"],[1,"ion-no-padding"],["lines","none"],[1,"ion-text-bold"],[2,"font-weight","bold"],["value","notes"],["slot","header","color","warning"],["slot","start","name","person-circle-outline"],["slot","content",1,"ion-padding-horizontal"],["name","stats-chart-outline","slot","start",3,"color"],["name","bookmark-outline","slot","start",3,"color"],["class","ion-no-padding",4,"ngIf"],[1,"ion-align-items-center"],["size","5",1,"ion-text-center","left-col"],[1,"ion-no-margin","ion-text-bold"],["size","7"],[1,"ion-no-margin","ion-text-right","ion-text-bold"],[1,"ion-padding-horizontal"],["class","ion-no-padding ion-no-margin",4,"ngIf"],[1,"ion-padding-top"],["lines","none","detail","true","button","true",3,"click"],["sizeXs","6","offsetXs","6","sizeSm","6","offsetSm","6","sizeMd","6","offsetMd","6","sizeLg","6","offsetLg","6","sizeXl","6","offsetXl","6"],["expand","block","size","small","fill","outline",3,"color","click"],["name","checkmark-outline","slot","start",4,"ngIf"],["slot","header","color","light"],["color","success","slot","start",1,"big-badge"],["slot","content",1,"ion-padding"],[4,"ngFor","ngForOf"],["color","success"],["name","transgender-outline","slot","start",3,"color"],["slot","start","name","location-outline"],["name","home-outline","slot","start",3,"color"],["name","navigate-outline","slot","start",3,"color"],["name","call-outline","slot","start",3,"color"],["fill","outline","color","danger","size","small","detail","false","button","false","slot","end"],["class","ion-padding-vertical ion-no-margin",4,"ngIf"],[1,"ion-text-small"],["slot","end","size","small","fill","clear"],[1,"ion-padding-vertical","ion-no-margin"],["value","modosaldo"],[1,"ion-text-small","ion-text-bold"],[3,"ngModel","ngModelChange"],[3,"value"],[1,"ion-text-danger","ion-text-small"],["size","9",4,"ngIf"],["size","3","class","ion-text-right",4,"ngIf"],["size","9"],["size","3",1,"ion-text-right"],[3,"iconMode","arPayment","onPaymentModeChoosed"],["name","checkmark-outline","slot","start"],["color","danger","expand","block",1,"full-buttons",3,"click"],["color","success","expand","block",1,"full-buttons",3,"click"]],template:function(e,i){1&e&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),o.NdJ("click",function(){return i.closeModal()}),o._UZ(4,"ion-icon",3),o.qZA()(),o.TgZ(5,"ion-title"),o._uU(6,"Iscrizione"),o.qZA()()(),o.TgZ(7,"ion-content"),o.YNc(8,$,103,47,"div",4),o.qZA(),o.TgZ(9,"ion-footer")(10,"ion-grid"),o.YNc(11,j,4,0,"ion-row",5),o.YNc(12,H,4,0,"ion-row",5),o.YNc(13,X,4,0,"ion-row",5),o.qZA()()),2&e&&(o.xp6(8),o.Q6J("ngIf",i.loadingComplete),o.xp6(3),o.Q6J("ngIf",!i.flagPostiDisponibili),o.xp6(1),o.Q6J("ngIf",i.flagPostiDisponibili&&0==(null==i.corsoDoc?null:i.corsoDoc.isAPagamento())),o.xp6(1),o.Q6J("ngIf",i.flagPostiDisponibili&&1==(null==i.corsoDoc?null:i.corsoDoc.isAPagamento())))},dependencies:[f.sg,f.O5,I.JJ,I.On,c.We,c.eh,c.yp,c.YG,c.Sm,c.PM,c.FN,c.Zi,c.wI,c.W2,c.fr,c.jY,c.Gu,c.gu,c.Ie,c.Q$,c.q_,c.B7,c.se,c.Nd,c.yW,c.wd,c.sr,c.U5,c.QI,x.e,f.gd,f.rS,f.H9,f.uU,O.u],styles:[".griglia-principale[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}h6[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:4px;font-size:14px}h4[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:5px;font-weight:600}.left-col[_ngcontent-%COMP%]{border-right-style:solid;border-width:thin;border-color:#eff1f8}p[_ngcontent-%COMP%]{font-size:13px}ion-button.full-buttons[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}#item-totale[_ngcontent-%COMP%]   ion-label.title[_ngcontent-%COMP%]{font-size:18px}#item-totale[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:10px;font-weight:700}ion-chip.wide[_ngcontent-%COMP%]{width:100%;justify-content:center}.big-badge[_ngcontent-%COMP%]{font-size:1.5em}ion-radio[_ngcontent-%COMP%]::part(container){width:30px;height:30px;border-radius:8px;border:2px solid #ddd}ion-radio[_ngcontent-%COMP%]::part(mark){background:none;transition:none;transform:none;border-radius:0}ion-radio.radio-checked[_ngcontent-%COMP%]::part(container){background:var(--ion-color-success);border-color:transparent}ion-radio.radio-checked[_ngcontent-%COMP%]::part(mark){width:6px;height:10px;border-width:0px 2px 2px 0px;border-style:solid;border-color:#fff;transform:rotate(45deg)}"]}),t})()},87186:(b,C,l)=>{l.d(C,{x:()=>P});var r=l(31223),A=l(7706),T=l(69808);function d(m,D){if(1&m){const a=r.EpF();r.TgZ(0,"td",4)(1,"ion-button",5),r.NdJ("onClick",function(){const f=r.CHM(a).$implicit,I=r.oxw(2);return r.KtG(I.onClickDay(f))}),r.TgZ(2,"span"),r._uU(3),r.qZA()()()}if(2&m){const a=D.$implicit,o=r.oxw(2);r.Q6J("ngClass",0==o.getFlagCanShowDay(a)?"ion-hide ion-text-center":"ion-text-center"),r.xp6(1),r.Q6J("color",o.getColorDay(a))("fill",o.getFillDay(a)),r.xp6(2),r.hij(" ",o.getLabelDay(a)," ")}}function u(m,D){if(1&m&&(r.TgZ(0,"table",2)(1,"tr"),r.YNc(2,d,4,4,"td",3),r.qZA()()),2&m){const a=r.oxw();r.xp6(2),r.Q6J("ngForOf",a._listDays)}}function h(m,D){if(1&m&&(r.TgZ(0,"p"),r._uU(1),r.ALo(2,"uppercase"),r.qZA()),2&m){const a=r.oxw();r.xp6(1),r.Oqu(r.lcZ(2,1,a.listText))}}let P=(()=>{class m{constructor(){this.colorSelected="primary",this.colorNotSelected="secondary",this.clickable=!1,this.isDesktop=!1,this.clickElement=new r.vpe,this._size="sm",this._showOnlySelected=!1,this._listDays=[],this._numSelected=0,this._asText=!1,this.listText=""}set listDays(a){if(this._listDays=a,this._listDays){let o=this._listDays.filter(c=>c.selected);this._numSelected=o.length,this.listText=this._listDays.filter(c=>c.selected).map(c=>c.label).join(", ")}}set showOnlySelected(a){this._showOnlySelected=a}set asText(a){this._asText=a}set size(a){this._size=a}ngOnInit(){}getColorDay(a){let o=this.colorNotSelected;return a&&a.selected&&(o=this.colorSelected),o}getFillDay(a){let o="outline";return a&&a.selected&&(o="solid"),o}getLabelDay(a){let o="";switch(this._size){case"lg":o=a.label.toUpperCase();break;case"md":o=a.smallLabel.toUpperCase();break;case"sm":default:o=a.xsLabel.toUpperCase();break;case"auto":o=this._showOnlySelected?this._numSelected<=3?a.label.toUpperCase():this._numSelected<=5?a.smallLabel.toUpperCase():a.xsLabel.toUpperCase():a.xsLabel.toUpperCase()}return o}getFlagCanShowDay(a){let o=!0;return o=1!=this._showOnlySelected||1==a.selected,o}onClickDay(a){this.clickable&&this.clickElement.emit(a)}}return m.\u0275fac=function(a){return new(a||m)},m.\u0275cmp=r.Xpm({type:m,selectors:[["app-settimana-block"]],inputs:{listDays:"listDays",colorSelected:"colorSelected",colorNotSelected:"colorNotSelected",clickable:"clickable",isDesktop:"isDesktop",showOnlySelected:"showOnlySelected",asText:"asText",size:"size"},outputs:{clickElement:"clickElement"},decls:2,vars:2,consts:[["class","ion-margin-vertical","style","width: 100%",4,"ngIf"],[4,"ngIf"],[1,"ion-margin-vertical",2,"width","100%"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["size","small",3,"color","fill","onClick"]],template:function(a,o){1&a&&(r.YNc(0,u,3,1,"table",0),r.YNc(1,h,3,3,"p",1)),2&a&&(r.Q6J("ngIf",!o._asText),r.xp6(1),r.Q6J("ngIf",o._asText))},dependencies:[A.YG,T.mk,T.sg,T.O5,T.gd]}),m})()},61626:(b,C,l)=>{l.d(C,{u:()=>T});var r=l(34021),A=l(31223);let T=(()=>{class d{transform(h){let P="";return P=r.Gs.decode(r.Jw,h),P}}return d.\u0275fac=function(h){return new(h||d)},d.\u0275pipe=A.Yjl({name:"targetSesso",type:d,pure:!0}),d})()}}]);