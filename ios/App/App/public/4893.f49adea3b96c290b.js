"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4893],{4893:(B,M,c)=>{c.r(M),c.d(M,{BookingPageModule:()=>At});var f=c(9808),r=c(7026),v=c(2028),P=c(6962),D=c(1737),C=c(7221),i=c(4898),h=c(2274),T=c(8698),I=c(4616),x=c(7205),O=c(1799),_=c(4021),g=c(9129),t=c(2096);c(253);const a=["sliderSport"];function p(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-slide")(1,"ion-card",4),t.NdJ("click",function(){const u=t.CHM(e).$implicit;return t.oxw(2).onChangeSport(u)}),t.TgZ(2,"ion-grid")(3,"ion-row",5)(4,"ion-col",6)(5,"i",7),t._UZ(6,"span",8),t.qZA()(),t.TgZ(7,"ion-col")(8,"ion-label")(9,"h3",9),t._uU(10),t.qZA()()()()()()()}if(2&n){const e=d.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("color",o.getColor(e)),t.xp6(5),t.Q6J("innerHTML",e.htmlIconHex,t.oJD),t.xp6(4),t.Oqu(e.DENOMINAZIONE)}}function m(n,d){if(1&n&&(t.TgZ(0,"ion-slides",1,2),t.YNc(2,p,11,3,"ion-slide",3),t.qZA()),2&n){const e=t.oxw();t.Q6J("options",e.getSliderOptions()),t.xp6(2),t.Q6J("ngForOf",e.sportList)}}let E=(()=>{class n{constructor(e){this.startService=e,this.sportChanged=new t.vpe,this.sliderOpts1={slidesPerView:1,spaceBetween:0,initialSlide:0},this.sliderOpts2={slidesPerView:2,spaceBetween:0,initialSlide:0},this.sliderOpts3={slidesPerView:2.5,spaceBetween:0,initialSlide:0},this.sliderOpts4={slidesPerView:3.5,spaceBetween:0,initialSlide:0}}ngOnInit(){}ngOnChanges(){}ionViewDidEnter(){}goToSlide(e){this.sliderSport&&this.sliderSport.slideTo(e)}onChangeSport(e){let o=this.getIndexSport(e);-1!=o&&this.goToSlide(o),this.sportChanged.emit(e)}getSliderOptions(){let e;return e=1==this.sportList.length?this.sliderOpts1:2==this.sportList.length?this.sliderOpts2:this.sliderOpts3,e}getColor(e){let o="light";return this.selectedSport&&e&&this.selectedSport.ID==e.ID&&(o="secondary"),o}getIndexSport(e){let o=-1;return e&&(o=this.sportList.findIndex(s=>s.ID==e.ID)),o}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(P.D))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-sport-scroll"]],viewQuery:function(e,o){if(1&e&&t.Gf(a,5),2&e){let s;t.iGM(s=t.CRH())&&(o.sliderSport=s.first)}},inputs:{selectedSport:"selectedSport",sportList:"sportList"},outputs:{sportChanged:"sportChanged"},features:[t.TTD],decls:2,vars:1,consts:[["class","ion-text-center",3,"options",4,"ngIf"],[1,"ion-text-center",3,"options"],["sliderSport",""],[4,"ngFor","ngForOf"],["mode","md","button","",1,"card-sport",3,"color","click"],[1,"ion-align-items-center"],["size","4"],[1,"icon-sport"],[3,"innerHTML"],[1,"text-sport"]],template:function(e,o){1&e&&(t.TgZ(0,"div"),t.YNc(1,m,3,2,"ion-slides",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",0!=o.sportList.length))},directives:[f.O5,r.Hr,f.sg,r.A$,r.PM,r.jY,r.Nd,r.wI,r.Q$],styles:[".icon-sport[_ngcontent-%COMP%]{font-size:30px;font-family:sports}.text-sport[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.card-sport[_ngcontent-%COMP%]{width:90%}"]}),n})();c(5383),c(6667);const z=["sliderCampi"];function Q(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-slide")(1,"ion-button",6),t.NdJ("click",function(){const u=t.CHM(e).$implicit;return t.oxw(2).onChangeCampo(u)}),t._UZ(2,"ion-icon",7),t.TgZ(3,"ion-label",8)(4,"p"),t._uU(5),t.qZA()()()()}if(2&n){const e=d.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("fill",o.getFill(e))("color",o.getColor(e))("disabled",!o.canChoose),t.xp6(1),t.Q6J("name",o.isSelected(e)?"location-outline":"locate-outline"),t.xp6(3),t.Oqu(e.DENOMINAZIONE)}}function H(n,d){if(1&n&&(t.TgZ(0,"ion-slides",3,4),t.YNc(2,Q,6,5,"ion-slide",5),t.qZA()),2&n){const e=t.oxw();t.Q6J("options",e.getSliderOptions()),t.xp6(2),t.Q6J("ngForOf",e.campiList)}}function V(n,d){if(1&n&&(t.TgZ(0,"ion-label",13)(1,"p")(2,"ion-text"),t._uU(3,"Stai visualizzando le disponibilit\xe0 di "),t.TgZ(4,"strong"),t._uU(5),t.qZA(),t._uU(6," presso "),t.TgZ(7,"strong"),t._uU(8),t.qZA()(),t._UZ(9,"br"),t.TgZ(10,"ion-text",14),t._uU(11,"\xa0(in caso di slot occupati ricercare su altre giornate/struttura)"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(5),t.Oqu(null==e.selectedCampo?null:e.selectedCampo.DENOMINAZIONE),t.xp6(3),t.hij("",null==e.selectedLocation?null:e.selectedLocation.DENOMINAZIONE,".")}}function q(n,d){if(1&n&&(t.TgZ(0,"ion-label",13)(1,"p")(2,"ion-text")(3,"strong"),t._uU(4),t.qZA(),t._uU(5," presso "),t.TgZ(6,"strong"),t._uU(7),t.qZA()()()()),2&n){const e=t.oxw(2);t.xp6(4),t.Oqu(null==e.selectedCampo?null:e.selectedCampo.DENOMINAZIONE),t.xp6(3),t.hij("",null==e.selectedLocation?null:e.selectedLocation.DENOMINAZIONE,".")}}function W(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"ion-list",9)(2,"ion-item",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().onChangeInfoStyle()}),t._UZ(3,"ion-icon",11),t.YNc(4,V,12,2,"ion-label",12),t.YNc(5,q,8,2,"ion-label",12),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",1==e.styleInfoMessage),t.xp6(1),t.Q6J("ngIf",2==e.styleInfoMessage)}}let j=(()=>{class n{constructor(){this.campoChanged=new t.vpe,this.styleInfoMessage=2,this.sliderOpts1={slidesPerView:1,spaceBetween:0,initialSlide:0},this.sliderOpts2={slidesPerView:2,spaceBetween:0,initialSlide:0},this.sliderOpts3={slidesPerView:2.5,spaceBetween:0,initialSlide:0},this.sliderOpts4={slidesPerView:3.5,spaceBetween:0,initialSlide:0}}getSliderOptions(){let e;return e=1==this.campiList.length?this.sliderOpts1:2==this.campiList.length?this.sliderOpts2:this.sliderOpts3,e}goToSlide(e){this.sliderCampi&&this.sliderCampi.slideTo(e)}ngOnInit(){}onChangeCampo(e){let o=this.getIndexCampo(e);-1!=o&&this.goToSlide(o),this.campoChanged.emit(e)}getIndexCampo(e){let o=-1;return e&&(o=this.campiList.findIndex(s=>s.ID==e.ID)),o}getColor(e){let o="primary";return this.selectedCampo&&e&&this.selectedCampo.ID==e.ID&&(o="tertiary"),o}getFill(e){let o="outline";return this.selectedCampo&&e&&this.selectedCampo.ID==e.ID&&(o="solid"),o}isSelected(e){let o=!1;return this.selectedCampo&&e&&this.selectedCampo.ID==e.ID&&(o=!0),o}onChangeInfoStyle(){this.styleInfoMessage=1==this.styleInfoMessage?2:1}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-campi-scroll"]],viewQuery:function(e,o){if(1&e&&t.Gf(z,5),2&e){let s;t.iGM(s=t.CRH())&&(o.sliderCampi=s.first)}},inputs:{selectedCampo:"selectedCampo",campiList:"campiList",selectedLocation:"selectedLocation",canChoose:"canChoose"},outputs:{campoChanged:"campoChanged"},decls:3,vars:2,consts:[[1,"slideCampi"],["class","ion-text-center",3,"options",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center",3,"options"],["sliderCampi",""],[4,"ngFor","ngForOf"],["expand","block","size","large","shape","round","mode","ios",3,"fill","color","disabled","click"],["slot","start",3,"name"],[1,"ion-text-wrap"],[1,"list-nopadding"],["lines","none","color","tertiary","type","header",3,"click"],["slot","start","name","information-circle-outline"],["class","ion-text-wrap ion-padding-start",4,"ngIf"],[1,"ion-text-wrap","ion-padding-start"],[2,"font-size","small"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,H,3,2,"ion-slides",1),t.qZA(),t.YNc(2,W,6,2,"div",2)),2&e&&(t.xp6(1),t.Q6J("ngIf",0!=o.campiList.length),t.xp6(1),t.Q6J("ngIf",o.selectedCampo&&o.selectedLocation))},directives:[f.O5,r.Hr,f.sg,r.A$,r.YG,r.gu,r.Q$,r.q_,r.Ie,r.yW],styles:["ion-button[_ngcontent-%COMP%]{width:90%}.list-nopadding[_ngcontent-%COMP%]{margin-top:5px;padding-bottom:0}"]}),n})();var G=c(655),k=c(5439);const $=["sliderDays"];function K(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-button",12),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw().onClickButton(s)}),t._UZ(1,"ion-icon",13),t.qZA()}}function X(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-button",14),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw().onClickButton(s)}),t._uU(1),t._UZ(2,"br"),t._uU(3),t.ALo(4,"date"),t.qZA()}if(2&n){const e=t.oxw().$implicit,o=t.oxw();t.Q6J("fill",o.getFillButton(e)),t.xp6(1),t.hij(" ",e.numValue," "),t.xp6(2),t.hij(" ",t.xi3(4,3,e.dateValue,"EEEEE")," ")}}function tt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-button",12),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw().onClickButton(s)}),t._UZ(1,"ion-icon",15),t.qZA()}}function et(n,d){if(1&n&&(t.TgZ(0,"ion-slide"),t.YNc(1,K,2,0,"ion-button",10),t.YNc(2,X,5,6,"ion-button",11),t.YNc(3,tt,2,0,"ion-button",10),t.qZA()),2&n){const e=d.$implicit;t.xp6(1),t.Q6J("ngIf","prev"==e.type),t.xp6(1),t.Q6J("ngIf","day"==e.type),t.xp6(1),t.Q6J("ngIf","next"==e.type)}}let ot=(()=>{class n{constructor(e){this.pickController=e,this.activeDay=new Date,this.onChangeActiveDay=new t.vpe,this.listDay=[],this.listMesi=[],this.sliderOpts={slidesPerView:15,spaceBetween:3,initialSlide:1,breakpoints:{320:{slidesPerView:5,spaceBetween:1},480:{slidesPerView:7,spaceBetween:3},640:{slidesPerView:10,spaceBetween:1},1e3:{slidesPerView:15,spaceBetween:1}}},this.setStartSlide(),this.listMesi=_.Gs.getArray(_.oO)}setStartSlide(){let e=this.activeDay.getDate()-1;e-=2,e<0&&(e=0),this.sliderOpts.initialSlide=e}goToSlide(e){this.sliderDays&&this.sliderDays.slideTo(e)}ngOnInit(){this.setListDay()}setListDay(){let e=30,o=k(new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1)).add(1,"M");o.subtract(1,"day"),e=o.date(),this.listDay=[],e+=1,this.listDay.push({type:"prev"});for(let s=1;s<e;s++){let u=new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),s);this.listDay.push({type:"day",dateValue:u,numValue:s})}this.listDay.push({type:"next"})}getFillButton(e){let o="outline";return e&&this.activeDay.getDate()==e.numValue&&(o="solid"),o}onClickButton(e){let o;if(e)if("day"==e.type)this.activeDay=e.dateValue,this.onChangeActiveDay.emit(this.activeDay);else switch(e.type){case"next":o=k(new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1)).add(1,"M").toDate(),this.setNewActiveDateFromPicker(o.getFullYear(),o.getMonth()+1,o.getDate());break;case"prev":o=k(new Date(this.activeDay.getFullYear(),this.activeDay.getMonth(),1)).subtract(1,"days").toDate(),this.setNewActiveDateFromPicker(o.getFullYear(),o.getMonth()+1,o.getDate())}}initColumnMesi(e){let o=[];for(let s=0;s<this.listMesi.length;s++){const u=this.listMesi[s];o.push({text:u.description,value:u.value,disabled:!(s>=e)})}return o}initColumnAnni(){let e=[],o=(new Date).getFullYear();for(let s=o;s<o+5;s++)e.push({text:s+"",value:s});return e}initColumnsPicker(e,o,s,u){return[{name:"mese",options:e,selectedIndex:o},{name:"anno",options:s,selectedIndex:u}]}showPickerDate(){let e=this,s=e.activeDay.getFullYear()-(new Date).getFullYear();const u=(new Date).getMonth();let y=[{text:"Conferma",handler:b=>{e.setNewActiveDateFromPicker(b.anno.value,b.mese.value)}},{role:"cancel",text:"Annulla"}],A=this.initColumnMesi(u),S=[];S=this.initColumnAnni();let Ot={columns:this.initColumnsPicker(A,0,S,s),buttons:y,keyboardClose:!0};this.pickController.create(Ot).then(b=>{b.addEventListener("ionPickerColChange",Z=>(0,G.mG)(this,void 0,void 0,function*(){const L=Z.detail;if("anno"==L.name){const St=(new Date).getFullYear(),Mt=(new Date).getMonth();let N=[],F=[],J=[];const Y=L.selectedIndex,It=L.options[Y].value;F=this.initColumnAnni(),N=this.initColumnMesi(It==St?Mt:0),J=this.initColumnsPicker(N,0,F,Y),b.columns=J}})),b.present()})}setNewActiveDateFromPicker(e,o,s=0){let u=this.activeDay.getMonth(),y=this.activeDay.getFullYear(),A=this.activeDay.getDate(),S=new Date;(o-1!==u||e!==y)&&(A=o-1==S.getMonth()&&e==S.getFullYear()?S.getDate():1,0!=s&&(A=s),this.activeDay=new Date(e,o-1,A),this.setListDay(),this.goToSlide(this.activeDay.getDate()-1),this.onChangeActiveDay.emit(this.activeDay))}getMaxDayInMont(e,o){let s=k(new Date(o,e,1));return s.add(1,"month"),s.subtract(1,"day"),s.toDate().getDate()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.up))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-calendarscroll"]],viewQuery:function(e,o){if(1&e&&t.Gf($,5),2&e){let s;t.iGM(s=t.CRH())&&(o.sliderDays=s.first)}},inputs:{activeDay:"activeDay"},outputs:{onChangeActiveDay:"onChangeActiveDay"},decls:14,vars:8,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"date-row"],["size","",1,"ion-text-center",3,"click"],[1,"custom-div"],[1,"ion-no-margin","custom-h5","ion-text-center"],["name","chevron-down","color","primary",1,""],[1,"ion-no-margin","ion-padding-horizontal"],[3,"options"],["sliderDays",""],[4,"ngFor","ngForOf"],["class","ion-no-padding ion-no-margin btn-day","shape","round","size","large","fill","outline","color","secondary",3,"click",4,"ngIf"],["class","ion-no-padding ion-no-margin btn-day","shape","round","size","large","color","secondary",3,"fill","click",4,"ngIf"],["shape","round","size","large","fill","outline","color","secondary",1,"ion-no-padding","ion-no-margin","btn-day",3,"click"],["slot","icon-only","name","chevron-back-outline"],["shape","round","size","large","color","secondary",1,"ion-no-padding","ion-no-margin","btn-day",3,"fill","click"],["slot","icon-only","name","chevron-forward-outline"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),t.NdJ("click",function(){return o.showPickerDate()}),t.TgZ(3,"div",3)(4,"h5",4)(5,"span"),t._uU(6),t.ALo(7,"titlecase"),t.ALo(8,"date"),t.qZA(),t._UZ(9,"ion-icon",5),t.qZA()()()(),t.TgZ(10,"ion-row",6)(11,"ion-slides",7,8),t.YNc(13,et,4,3,"ion-slide",9),t.qZA()()()),2&e&&(t.xp6(6),t.hij(" ",t.lcZ(7,3,t.xi3(8,5,o.activeDay,"EEEE dd MMMM yyyy")),""),t.xp6(5),t.Q6J("options",o.sliderOpts),t.xp6(2),t.Q6J("ngForOf",o.listDay))},directives:[r.jY,r.Nd,r.wI,r.gu,r.Hr,f.sg,r.A$,f.O5,r.YG],pipes:[f.rS,f.uU],styles:["ion-grid[_ngcontent-%COMP%]{background-color:#fff}ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{margin-bottom:10px}a[_ngcontent-%COMP%]{text-decoration:none;cursor:pointer}ion-button[_ngcontent-%COMP%]{width:50px;height:50px;min-width:50px;min-height:50px;font-size:16px}ion-button.btn-day[_ngcontent-%COMP%]   .button-inner[_ngcontent-%COMP%]{flex-flow:column}ion-slides[_ngcontent-%COMP%]{margin-bottom:10px;height:60px}.flessibile[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.circle[_ngcontent-%COMP%]{border-radius:50%;border-style:solid;border-width:thin;border-color:var(--ion-color-light-shade);width:50px;height:50px}.icon-calendar[_ngcontent-%COMP%]{font-size:25px}.date-row[_ngcontent-%COMP%]{padding-top:10px}.custom-h5[_ngcontent-%COMP%]{display:flex;align-items:center}.custom-div[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center}.custom-div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:3px}"]}),n})();function it(n,d){if(1&n&&t._UZ(0,"ion-icon",9),2&n){const e=t.oxw();t.Q6J("name",e.getIconButton())}}c(6797);let nt=(()=>{class n{constructor(){this.clickSlot=new t.vpe,this.captionBtn="",this.readOnly=!1}ngOnInit(){}getClassButton(){let e="";return e=this.readOnly?"slot-read-only":this.mySlot.STATO==_.fu.occupato?"slot-busy":this.mySlot.STATO==_.fu.chiuso?"slot-read-only":this.mySlot.STATO==_.fu.contattare?"slot-free-contact":this.mySlot.selected?"slot-selected":"slot-free",e}getDisableButton(){let e=!1;return(this.mySlot.STATO==_.fu.occupato||this.mySlot.STATO==_.fu.chiuso||this.readOnly)&&(e=!0),e}getCaptionButton(){let e="";if(!this.readOnly)if(this.mySlot.selected)e=this.captionBtn;else switch(this.mySlot.STATO){case _.fu.occupato:e="occupato";break;case _.fu.contattare:e="contattare";break;case _.fu.chiuso:e=""}return e}getIconButton(){let e="";if(!this.readOnly)if(this.mySlot.selected)e="checkmark";else switch(this.mySlot.STATO){case _.fu.occupato:e="thumbs-down";break;case _.fu.contattare:e="call";break;default:e=""}return e}showIconButton(){let e=!1;if(!this.readOnly)if(this.mySlot.selected)e=!0;else switch(this.mySlot.STATO){case _.fu.occupato:case _.fu.contattare:e=!0;break;default:e=!1}return e}chooseSlot(){this.clickSlot.emit(this.mySlot)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-slottime"]],inputs:{mySlot:"mySlot",captionBtn:"captionBtn",readOnly:"readOnly"},outputs:{clickSlot:"clickSlot"},decls:20,vars:12,consts:[[1,"ion-align-items-center"],["size","2","size-xs","3","id","col-orari",1,"ion-no-padding"],[1,"ion-no-margin"],[1,"ion-text-center"],[1,"orario-black"],[1,"orario-light"],["size-xs","9","size","10","id","col-slot",1,"ion-padding-horizontal"],["expand","block",3,"ngClass","disabled","click"],["slot","start",3,"name",4,"ngIf"],["slot","start",3,"name"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-card")(1,"ion-row",0)(2,"ion-col",1)(3,"ion-grid",2)(4,"ion-row")(5,"ion-col")(6,"div",3)(7,"span",4),t._uU(8),t.ALo(9,"date"),t.qZA()()()(),t.TgZ(10,"ion-row")(11,"ion-col")(12,"div",3)(13,"span",5),t._uU(14),t.ALo(15,"date"),t.qZA()()()()()(),t.TgZ(16,"ion-col",6)(17,"ion-button",7),t.NdJ("click",function(){return o.chooseSlot()}),t.YNc(18,it,1,1,"ion-icon",8),t._uU(19),t.qZA()()()()),2&e&&(t.xp6(8),t.hij(" ",t.xi3(9,6,o.mySlot.START,"HH:mm")," "),t.xp6(6),t.hij(" ",t.xi3(15,9,o.mySlot.END,"HH:mm")," "),t.xp6(3),t.Q6J("ngClass",o.getClassButton())("disabled",o.getDisableButton()),t.xp6(1),t.Q6J("ngIf",o.showIconButton()),t.xp6(1),t.hij(" ",o.getCaptionButton()," "))},directives:[r.PM,r.Nd,r.wI,r.jY,r.YG,f.mk,f.O5,r.gu],pipes:[f.uU],styles:['@import"https://fonts.googleapis.com/css?family=Roboto&display=swap";ion-card[_ngcontent-%COMP%]{background-color:#fff;min-height:50px;margin:5px 16px}#col-orari[_ngcontent-%COMP%]{border-right-style:solid;border-width:thin;border-color:#eff1f8}.orario-black[_ngcontent-%COMP%]{font-family:Roboto;font-size:medium;color:#000}.orario-light[_ngcontent-%COMP%]{font-family:Roboto;font-size:medium;color:#9da2b3}.slot-busy[_ngcontent-%COMP%]{--background: var(--ion-color-danger)}.slot-free[_ngcontent-%COMP%]{--background: var(--ion-color-success)}.slot-free-contact[_ngcontent-%COMP%]{--background: var(--ion-color-success-tint)}.slot-selected[_ngcontent-%COMP%]{--background: var(--ion-color-secondary)}.slot-read-only[_ngcontent-%COMP%]{--background: lightgray}']}),n})(),st=(()=>{class n{constructor(){this.clickPrenota=new t.vpe}ngOnInit(){}onClickPrenota(){this.clickPrenota.emit(this.myPrenotaPianifica)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-footbooked"]],inputs:{myPrenotaPianifica:"myPrenotaPianifica"},outputs:{clickPrenota:"clickPrenota"},decls:14,vars:14,consts:[["color","tertiary"],["lines","none","detail","false"],["slot","start","name","calendar","color","tertiary"],["slot","end","color","tertiary","expand","block","size","default",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-list",0)(1,"ion-item",1),t._UZ(2,"ion-icon",2),t.TgZ(3,"ion-label")(4,"h2"),t._uU(5),t.ALo(6,"titlecase"),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.ALo(10,"date"),t.ALo(11,"date"),t.qZA()(),t.TgZ(12,"ion-button",3),t.NdJ("click",function(){return o.onClickPrenota()}),t._uU(13,"Prenota"),t.qZA()()()),2&e&&(t.xp6(5),t.hij(" ",t.lcZ(6,3,t.xi3(7,5,null==o.myPrenotaPianifica?null:o.myPrenotaPianifica.DATAORAINIZIO,"EEE dd/MM/yyyy"))," "),t.xp6(4),t.AsE(" dalle ",t.xi3(10,8,null==o.myPrenotaPianifica?null:o.myPrenotaPianifica.DATAORAINIZIO,"HH:mm")," alle ",t.xi3(11,11,null==o.myPrenotaPianifica?null:o.myPrenotaPianifica.DATAORAFINE,"HH:mm")," "))},directives:[r.q_,r.Ie,r.gu,r.Q$,r.YG],pipes:[f.rS,f.uU],styles:["ion-icon[_ngcontent-%COMP%]{margin-right:16px}ion-button[_ngcontent-%COMP%]{margin-left:16px}"]}),n})();const at=["sliderCampi"];function lt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"div",6)(1,"app-sport-scroll",7),t.NdJ("sportChanged",function(s){return t.CHM(e),t.oxw().onChangeSport(s)}),t.qZA(),t.TgZ(2,"app-campi-scroll",8),t.NdJ("campoChanged",function(s){return t.CHM(e),t.oxw().onChangeCampo(s)}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("selectedSport",e.selectedSport)("sportList",e.listLocationSport),t.xp6(1),t.Q6J("selectedCampo",e.selectedCampo)("campiList",e.availableFields)("canChoose",e.ricevuti&&e.bookable)("selectedLocation",e.selectedLocation)}}function rt(n,d){1&n&&t._UZ(0,"ion-spinner",16)}function ct(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-col",17)(1,"app-slottime",18),t.NdJ("clickSlot",function(s){return t.CHM(e),t.oxw(4).myClickSlot(s)}),t.qZA()()}if(2&n){const e=d.$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("mySlot",e)("readOnly",o.actualSlotDay._TEMPLATELOCK)}}function dt(n,d){if(1&n&&(t.TgZ(0,"div")(1,"ion-item",11)(2,"ion-label",12),t._uU(3,"SCEGLI L'ORARIO:"),t.qZA(),t.YNc(4,rt,1,0,"ion-spinner",13),t.qZA(),t.TgZ(5,"ion-grid")(6,"ion-row",14),t.YNc(7,ct,2,2,"ion-col",15),t.qZA()()()),2&n){const e=t.oxw(3);t.xp6(4),t.Q6J("ngIf",e.actualSlotDay._TEMPLATELOCK),t.xp6(3),t.Q6J("ngForOf",e.actualSlotDay.SLOTTIMES)}}function pt(n,d){1&n&&(t.TgZ(0,"div",19),t._UZ(1,"br"),t.TgZ(2,"ion-label"),t._uU(3,"Prenotazione non effettuabile"),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"ion-label"),t._uU(6,"Cercare slot liberi modificando"),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"ion-label"),t._uU(9,"data, attivit\xe0 o struttura"),t.qZA()())}function ut(n,d){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,dt,8,2,"div",5),t.YNc(2,pt,10,0,"div",10),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.actualSlotDay.APERTOCHIUSO),t.xp6(1),t.Q6J("ngIf",!e.actualSlotDay.APERTOCHIUSO)}}function ht(n,d){1&n&&(t.TgZ(0,"div",19)(1,"ion-label"),t._uU(2,"Prenotazione"),t.qZA(),t.TgZ(3,"ion-label"),t._uU(4,"non disponibile"),t.qZA()())}function gt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"app-calendarscroll",9),t.NdJ("onChangeActiveDay",function(s){return t.CHM(e),t.oxw().onChangeBookDay(s)}),t.qZA(),t.YNc(2,ut,3,2,"div",5),t.YNc(3,ht,5,0,"div",10),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("activeDay",e.actualBookDay),t.xp6(1),t.Q6J("ngIf",e.ricevuti&&e.bookable),t.xp6(1),t.Q6J("ngIf",!e.bookable)}}function mt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"ion-footer")(1,"app-footbooked",20),t.NdJ("clickPrenota",function(s){return t.CHM(e),t.oxw().myClickPrenota(s)}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("myPrenotaPianifica",e.actualPlanning)}}const ft=[{path:"",component:(()=>{class n{constructor(e,o,s,u,y,A,S,U){this.router=e,this.startService=o,this.navController=s,this.loadingController=u,this.toastCtrl=y,this.modalCtrl=A,this.actionSheetController=S,this.alertController=U,this.idLocation="",this.versionBooking="manual",this.listLocationSport=[],this.bookable=!1,this.templateWeekSlot=new i.C,this.actualBookDay=new Date,this.actualCaptionButtonSelected="",this.actualPlanning=new h._,this.availableFields=[],this.indexCount=0,this.showExtraToolbar=!0,this.isOnAppleSystem=!1,this.actualPlanning=new h._,g.M.consoleLog("Constructor Booking Page"),g.M.consoleLog(this.actualPlanning),this.isOnAppleSystem=this.startService.isOnAppleSystem}updateAvailableFields(){this.selectedLocation&&this.selectedLocation.CAMPO&&(this.availableFields=this.selectedLocation.CAMPO.filter(e=>{let o=!1;if(this.selectedSport)for(const s of e.CAMPOSPORT)if(s.IDSPORT==this.selectedSport.ID){o=!0;break}return o}))}ngOnInit(){this.loadingController.create({message:"Caricamento",spinner:"circular",backdropDismiss:!0}).then(e=>{g.M.consoleLog("Presentazione Loading"),e.present(),this.ricevuti=!1,this.bookable=!1,this.router.paramMap.subscribe(o=>{g.M.consoleLog("Controllo Routing locationId"),o.has("locationId")?(g.M.consoleLog("locationId trovata"),this.idLocation=o.get("locationId"),this.idLocation?(g.M.consoleLog("locationId: "+this.idLocation),g.M.consoleLog("Richiesta al server Sport Praticati nella location "),this.startService.requestLocationSport(this.idLocation),this.sottoscrizioneListaSport(),g.M.consoleLog("Richiesta al server Location, Campi e CampiSport "),this.startService.requestLocationByID(this.idLocation,3).then(()=>{this.ricevuti=!0,e.dismiss()},()=>{e.dismiss(),this.showMessage("Errore di connessione")}),this.sottoscrizioneLocationCampi(),this.subUserLogged=this.startService.utenteLogged.subscribe(s=>{this.userLogged=s}),this.subDocUtente=this.startService.utente.subscribe(s=>{this.docUtente=s}),this.subActualSlotDay=this.startService.docOccupazione.subscribe(s=>{g.M.consoleLog("Variazione Slot Day"),this.actualSlotDay=s,g.M.consoleLog(s)}),this.subActivePrenotazione=this.startService.activePrenotazione.subscribe(s=>{this.activePrenotazione=s})):(this.bookable=!1,this.ricevuti=!0)):this.navController.navigateForward(["/"])})})}ngOnDestroy(){this.subSelectedLocation&&this.subSelectedLocation.unsubscribe(),this.subUserLogged&&this.subUserLogged.unsubscribe(),this.subDocUtente&&this.subDocUtente.unsubscribe(),this.subActualSlotDay&&this.subActualSlotDay.unsubscribe(),this.subActivePrenotazione&&this.subActivePrenotazione.unsubscribe(),this.subListLocationSport&&this.subListLocationSport.unsubscribe()}sottoscrizioneLocationCampi(){g.M.consoleLog("Sottoscrizione Location, Campi e CampiSport "),this.subSelectedLocation=this.startService.activeLocation.subscribe(e=>{this.selectedLocation=e,this.selectedLocation&&!this.selectedLocation.do_inserted&&0!==this.selectedLocation.CAMPO.length?(g.M.consoleLog("Ricezione Location, Campi e CampiSport "),this.getTemplateWeek(this.selectedLocation),this.onRefresh()):this.selectedLocation&&this.selectedLocation.CAMPO?(g.M.consoleLog("Location"),g.M.consoleLog(this.selectedLocation),g.M.consoleLog(this.selectedLocation.CAMPO)):g.M.consoleLog("Non ho la location oppure i campi ")})}sottoscrizioneListaSport(){this.subListLocationSport=this.startService.listLocationSport.subscribe(e=>{this.listLocationSport=e,this.selectedSport=this.listLocationSport&&0!==this.listLocationSport.length?this.listLocationSport[0]:void 0,this.onRefresh()})}onChangeVersion(e){this.versionBooking=e}onRefresh(){this.selectedSport?(this.availableFields=this.selectedLocation.getAvalaibleFields(this.selectedSport.ID),0!==this.availableFields.length&&(this.selectedCampo=this.availableFields[0]),this.selectedCampo?(g.M.consoleLog("Richiesto Refresh success, getOccupazioni"),this.bookable=!!this.selectedCampo,this.getOccupazioni()):g.M.consoleLog("Richiesto Refresh failed NO SELECTED CAMPO")):g.M.consoleLog("Richiesto Refresh failed NO SELECTED SPORT")}onChangeCampo(e){this.selectedCampo=e,this.getOccupazioni()}onDidChangeCampo(e){this.sliderCampi.getActiveIndex().then(o=>{o<=this.availableFields.length&&(this.selectedCampo=this.availableFields[o],this.getOccupazioni())})}onChangeBookDay(e){this.actualBookDay=e,this.getOccupazioni()}onChangeSport(e){e&&(this.selectedSport=e,this.onRefresh())}getTemplateWeek(e){this.templateWeekSlot=this.startService.getTemplateSlotWeek(e)}getOccupazioni(){this.actualSlotDay=this.templateWeekSlot.getCopySlotDay(this.actualBookDay,!0),g.M.consoleLog("Richiesta Slot Occupazioni"),this.startService.requestSlotOccupazioni(this.actualSlotDay,this.selectedLocation,this.selectedCampo,this.actualBookDay).then(()=>{1==this.actualSlotDay.APERTOCHIUSO&&(this.actualSlotDay.APERTOCHIUSO=!this.startService.isFestivita(this.actualBookDay,this.selectedLocation.IDAREAOPERATIVA,this.selectedLocation.ID,this.selectedCampo.ID))}),this.actualPlanning=new h._}myClickSlot(e){e&&(e.STATO==_.fu.contattare?this.showAlertContattaStruttura():this.actualPlanning=this.actualSlotDay.changeSelectionSlotTime(e))}showAlertContattaStruttura(){let e=[],o="";o="Per la prenotazione dello slot \xe8 necessario contattare la struttura telefonicamente",e=[{text:"OK",role:"cancel"}],this.selectedLocation.TELEFONO&&this.selectedLocation.TELEFONO.length>0&&(o=o+" al "+this.selectedLocation.TELEFONO,this.startService.isDesktop||(e=[{text:"OK",role:"cancel"},{text:"Chiama",handler:()=>{const s=this.selectedLocation.TELEFONO,u=document.createElement("a");u.setAttribute("href",`tel:${s}`),u.click()}}])),this.alertController.create({header:"Contattare la struttura",subHeader:"per richiedere informazioni",message:o,buttons:e}).then(s=>{s.present()})}visibleFooter(){let e=!1;return this.actualPlanning&&this.actualPlanning.DATAORAINIZIO&&this.actualPlanning.DATAORAFINE&&(e=!0),e}myClickPrenota(e){if(this.userLogged){let o;o=this.docUtente.getParamsVerifica(this.startService.actualStartConfig.gruppo),o?this.modalCtrl.create({component:O.I,componentProps:{params:o}}).then(s=>{s.present()}):this.execPrenotazione(e)}else this.startService.setIdAreaForcedForLogin(),this.modalCtrl.create({component:x.y}).then(o=>{o.present()})}execPrenotazione(e){this.startService.initActivePrenotazione(this.selectedLocation.IDAREAOPERATIVA),this.startService.setIDUtenteActivePrenotazione(this.docUtente),e.IDAREAOPERATIVA=this.selectedLocation.IDAREAOPERATIVA,e.IDLOCATION=this.selectedLocation.ID,e.IDCAMPO=this.selectedCampo.ID,e.IDSPORT=this.selectedSport.ID,e._DESCRCAMPO=this.selectedCampo.DENOMINAZIONE,e._DESCRSPORT=this.selectedSport.DENOMINAZIONE,this.startService.setPianificazioneSingola(e),this.startService.setSelectedCampoPrenotazione(this.selectedCampo),this.calcolaTotale()}calcolaTotale(){this.loadingController.create({message:"Verifica Prenotazione...",spinner:"circular"}).then(e=>{e.present(),this.startService.requestImportoPrenotazione().pipe((0,C.K)(this.handleError)).subscribe(o=>{e.dismiss();let s=T.i.getPrenotazioneFromJson(o);if(!0===s.ISVALID){let u=s.PRENOTAZIONEPIANIFICAZIONE[0];u._DESCRCAMPO=this.selectedCampo.DENOMINAZIONE,u._DESCRSPORT=this.selectedSport.DENOMINAZIONE,this.startService.setActivePrenotazione(s),this.goToFinalizza()}else this.showMessage(s.MSGINVALID?s.MSGINVALID:"Errore comunicazione imprevisto")},o=>{e.dismiss(),this.showMessage(o)})})}goToFinalizza(){this.modalCtrl.create({component:I.M,componentProps:{bookId:this.activePrenotazione.ID,locationId:this.selectedLocation.ID}}).then(e=>e.present())}showMessage(e){this.toastCtrl.create({message:e,duration:3e3}).then(o=>{o.present()})}handleError(e){return e.error instanceof ErrorEvent?console.error("Errore di chiamata:",e.error.message):console.error(`Errore Backend Codice ${e.status}, Body: ${e.error}`),(0,D._)("Si sono verificati errori. Riprovare AHIME.")}onClickChangeCampo(){let e=[];this.availableFields.forEach(o=>{e.push({text:o.DENOMINAZIONE,icon:"location",handler:()=>{this.selectedCampo=o,this.getOccupazioni();let u=this.availableFields.findIndex(y=>y.ID==this.selectedCampo.ID);this.sliderCampi.slideTo(u)}})}),this.actionSheetController.create({header:"Scegli il campo",buttons:e}).then(o=>{o.present()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v.gz),t.Y36(P.D),t.Y36(r.SH),t.Y36(r.HT),t.Y36(r.yF),t.Y36(r.IN),t.Y36(r.BX),t.Y36(r.Br))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-booking"]],viewQuery:function(e,o){if(1&e&&t.Gf(at,5),2&e){let s;t.iGM(s=t.CRH())&&(o.sliderCampi=s.first)}},decls:11,vars:3,consts:[["headBook",""],["color","primary"],["slot","start"],["defaultHref","/"],["class","custom-toolbar",4,"ngIf"],[4,"ngIf"],[1,"custom-toolbar"],[3,"selectedSport","sportList","sportChanged"],[3,"selectedCampo","campiList","canChoose","selectedLocation","campoChanged"],[3,"activeDay","onChangeActiveDay"],["class","nofind-cnt",4,"ngIf"],[1,"item-transparent"],[1,"ion-padding-horizontal"],["name","circular","color","primary",4,"ngIf"],[1,"ion-no-margin","ion-no-padding"],["class","ion-no-margin ion-no-padding","size","6","sizeXl","3","sizeLg","4","sizeMd","6","sizeSm","12","sizeXs","12",4,"ngFor","ngForOf"],["name","circular","color","primary"],["size","6","sizeXl","3","sizeLg","4","sizeMd","6","sizeSm","12","sizeXs","12",1,"ion-no-margin","ion-no-padding"],[3,"mySlot","readOnly","clickSlot"],[1,"nofind-cnt"],[3,"myPrenotaPianifica","clickPrenota"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",null,0)(2,"ion-toolbar",1)(3,"ion-buttons",2),t._UZ(4,"ion-back-button",3),t.qZA(),t.TgZ(5,"ion-title"),t._uU(6,"Prenota"),t.qZA()(),t.YNc(7,lt,3,6,"div",4),t.qZA(),t.TgZ(8,"ion-content"),t.YNc(9,gt,4,3,"div",5),t.qZA(),t.YNc(10,mt,2,1,"ion-footer",5)),2&e&&(t.xp6(7),t.Q6J("ngIf",o.ricevuti),t.xp6(2),t.Q6J("ngIf",o.ricevuti),t.xp6(1),t.Q6J("ngIf",o.visibleFooter()))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,f.O5,E,j,r.W2,ot,r.Ie,r.Q$,r.PQ,r.jY,r.Nd,f.sg,r.wI,nt,r.fr,st],styles:["ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light-tint)}ion-segment[_ngcontent-%COMP%]{--background: white}.item-campo[_ngcontent-%COMP%], .item-transparent[_ngcontent-%COMP%]{--background: var(--ion-color-light-tint)}.item-campo[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%], .item-transparent[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#999}ion-slide[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}.label-header[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}app-sport-scroll[_ngcontent-%COMP%]{--background: white}.nofind-cnt[_ngcontent-%COMP%]{padding-top:15px}ion-footer[_ngcontent-%COMP%]{border-top:var(--ion-color-tertiary) solid 2px}.custom-toolbar[_ngcontent-%COMP%]{background-color:#fff}"]}),n})()},{path:"bookingsummary/:bookId",loadChildren:()=>Promise.resolve().then(c.bind(c,3438)).then(n=>n.BookingsummaryPageModule)}];let _t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[v.Bz.forChild(ft)],v.Bz]}),n})();var Pt=c(3438),Ct=c(378),yt=c(933),vt=c(4776);let At=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[f.ez,r.Pc,_t,Pt.BookingsummaryPageModule,Ct.VerifyPageModule,yt.q,vt.W]]}),n})()},3438:(B,M,c)=>{c.r(M),c.d(M,{BookingsummaryPageModule:()=>g});var f=c(9808),r=c(4182),v=c(7026),P=c(2028),D=c(4616),C=c(2096);const i=[{path:"",component:D.M}];let h=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=C.oAB({type:t}),t.\u0275inj=C.cJS({imports:[[P.Bz.forChild(i)],P.Bz]}),t})();const I=[{path:"",component:c(8622).t}];let x=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=C.oAB({type:t}),t.\u0275inj=C.cJS({imports:[[P.Bz.forChild(I)],P.Bz]}),t})(),O=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=C.oAB({type:t}),t.\u0275inj=C.cJS({imports:[[f.ez,r.u5,v.Pc,x]]}),t})();var _=c(933);let g=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=C.oAB({type:t}),t.\u0275inj=C.cJS({imports:[[f.ez,r.u5,v.Pc,h,O,_.q]]}),t})()},4616:(B,M,c)=>{c.d(M,{M:()=>_});var f=c(6962),r=c(8698),v=c(7708),P=c(4021),D=c(3951),C=c(8622),i=c(2096),h=c(7026),T=c(4737),I=c(4182),x=c(7952),O=c(9808);let _=(()=>{class g{constructor(l,a,p,m,E,w,R,z){this.startService=l,this.navCtrl=a,this.loadingController=p,this.toastCtrl=m,this.navParams=E,this.modalCtrl=w,this.platform=R,this.alertCtrl=z,this.idPrenotazione="",this.idLocation="",this.checkBookId=!0,this.disclaimer=!1,this.docArea=this.startService.areaSelectedValue,this.setListPayment()}ngOnInit(){this.disclaimer=!1;let l=!0,a="";this.idLocation=this.navParams.get("locationId"),0!==this.idLocation.length?(this.selectedLocation=this.startService.findLocationByID(this.idLocation),this.selectedLocation||(l=!1,a="Location null")):(l=!1,a="idLocation Empty"),l&&(this.idPrenotazione=this.navParams.get("bookId"),this.idPrenotazione?this.recuperaPrenotazione():l=!1),l&&(this.subUserLogged=this.startService.utenteLogged.subscribe(p=>{this.userLogged=p}),this.subDocUtente=this.startService.utente.subscribe(p=>{this.docUtente=p}),this.selectedCampo=this.startService.getSelectedCampoPrenotazione()),l||(a="ngOnInit Failed "+a,console.error(a),this.onBookIdWrong())}ngOnDestroy(){this.subUserLogged&&this.subUserLogged.unsubscribe(),this.subActivePrenotazione&&this.subActivePrenotazione.unsubscribe(),this.subDocUtente&&this.subDocUtente.unsubscribe(),this.subPaymentResult&&this.subPaymentResult.unsubscribe()}recuperaPrenotazione(){this.subActivePrenotazione=this.startService.activePrenotazione.subscribe(l=>{this.activePrenotazione=l,this.docPianificazione=this.activePrenotazione.getPianificazione(),this.checkBookId&&(this.checkBookId=!1,null==this.activePrenotazione?(console.error("activePrenotazione null"),this.onBookIdWrong()):this.idPrenotazione!=this.activePrenotazione.ID?(console.error("idPrenotazione <> activePrenotazione.ID"),console.error(`idPrenotazione: ${this.idPrenotazione} - activePrenotazione ${this.activePrenotazione.ID}`),this.onBookIdWrong()):null==this.docPianificazione&&(console.error("docPianificazione null"),this.onBookIdWrong()))})}onBookIdWrong(){this.showMessage("Errore dati prenotazione"),this.closeModal()}closeModal(){this.modalCtrl.dismiss()}onChangedNumPlayer(l){this.docPianificazione.NUMPARTECIPANTI=l,this.calcolaTotale()}calcolaTotale(){this.loadingController.create({message:"Ricalcolo importo...",spinner:"circular"}).then(l=>{l.present(),this.startService.requestImportoPrenotazione().subscribe(a=>{l.dismiss();let p=r.i.getPrenotazioneFromJson(a);this.startService.setActivePrenotazione(p),p.ISVALID||this.showMessage(p.MSGINVALID)},a=>{l.dismiss(),this.showMessage(a)})})}getAddressLocation(){let l="";return this.selectedLocation&&(this.selectedLocation.INDIRIZZO&&0!==this.selectedLocation.INDIRIZZO.length?l=this.selectedLocation.INDIRIZZO:this.selectedLocation.COMUNE&&0!==this.selectedLocation.COMUNE.length&&(l=this.selectedLocation.COMUNE)),l}onConfirm(){this.onExecPayment()}onAfterSavePrenotazione(){this.showMessage("Prenotazione confermata"),this.closeModal(),this.navCtrl.navigateRoot(["historylist/booking",this.activePrenotazione.ID+"-"+this.docPianificazione.ID])}setListPayment(){this.myListPayment=[],this.docArea&&(this.myListPayment=this.docArea.getPaymentFor(P.O4.settorePagamentoPrenotazione),this.mySelectedPayment=this.myListPayment&&0!=this.myListPayment.length?this.myListPayment[0]:null)}onPaymentSelected(l){this.mySelectedPayment=l}onPaymentModeSelected(l){this.myPaymentMode=l}onExecPayment(){if(0!=this.activePrenotazione.TOTALE)if([P.x6.pagaAdesso,P.x6.pagaBonifico,P.x6.pagaStruttura].includes(this.myPaymentMode))if(this.myPaymentMode==P.x6.pagaBonifico||this.myPaymentMode==P.x6.pagaStruttura){let a=new v.b(this.myPaymentMode);this.onPaymentSuccess(a)}else{let a=new v.b(this.myPaymentMode);a.amount=this.activePrenotazione.RESIDUO,a.description="Pagamento Prenotazione",a.currency="EUR",this.modalCtrl.create({component:C.t,componentProps:{paymentData:a,listAreaPaymentSettings:this.myListPayment}}).then(p=>(p.present(),p.onDidDismiss())).then(p=>{let m=p.data;m?m.processResult?this.onPaymentSuccess(m):this.onPaymentFailed(m):(m=new v.b(this.myPaymentMode),m.processResult=!1,m.messageResult="Pagamento fallito",this.onPaymentFailed(m))})}else this.showMessage("E' necessario selezionare un pagamento");else this.showMessage("Contattare la struttura. Prenotazioni gratuite concluse")}onPaymentSuccess(l){l&&l.processResult&&(0==l.idElectronicResult.length?(this.activePrenotazione.IDTRANSACTION="",this.activePrenotazione.IDORDER="",this.activePrenotazione.CHANNELPAYMENT=l.channelPayment,this.activePrenotazione.RESIDUO=this.activePrenotazione.TOTALE,this.activePrenotazione.INCASSATO=0):(this.activePrenotazione.RESIDUO=0,this.activePrenotazione.INCASSATO=this.activePrenotazione.TOTALE,this.activePrenotazione.IDTRANSACTION="",this.activePrenotazione.IDORDER=l.idElectronicResult,this.activePrenotazione.CHANNELPAYMENT=l.channelPayment),this.loadingController.create({message:"Salvataggio Prenotazione",spinner:"circular"}).then(a=>{a.present(),this.startService.requestSavePrenotazione().then(p=>{a.dismiss(),this.activePrenotazione=p,p.ISVALID?this.docPianificazione=this.activePrenotazione.PRENOTAZIONEPIANIFICAZIONE[0]:this.showMessage(p.MSGINVALID),this.onAfterSavePrenotazione()}).catch(p=>{a.dismiss(),this.showMessage(p)})}))}onPaymentFailed(l){let a="Si sono verificati errori nel pagamento";l&&l.messageResult&&(a=l.messageResult),this.showAlert(a,"Pagamento Fallito")}showMessage(l){this.toastCtrl.create({message:l,duration:3e3}).then(a=>{a.present()})}showAlert(l,a,p){(!p||0==p.length)&&(p=[]).push("Ok"),this.alertCtrl.create({header:a||"Attenzione",message:l,buttons:p}).then(m=>{m.present()})}openLink(l){D.A.open({url:l})}onClickCondizioniVendita(){let l;this.docArea&&(l=this.docArea.findAreaLinkByPageType(P.GV.condizioniVenditaPrenotazioni),l&&l.REFERURL&&this.openLink(l.REFERURL))}}return g.\u0275fac=function(l){return new(l||g)(i.Y36(f.D),i.Y36(h.SH),i.Y36(h.HT),i.Y36(h.yF),i.Y36(h.X1),i.Y36(h.IN),i.Y36(h.t4),i.Y36(h.Br))},g.\u0275cmp=i.Xpm({type:g,selectors:[["app-bookingsummary"]],decls:79,vars:41,consts:[["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","ios","close","md","close"],[2,"background-color","#EFF1F8"],[1,"griglia-principale"],["color","danger","expand","block",1,"full-buttons",3,"click"],[1,"ion-align-items-center"],["size","3",1,"ion-text-center","left-col"],[1,"ion-no-margin"],[1,"ion-no-margin",2,"margin-top","0px","margin-bottom","0px"],["size","9"],[3,"numPlayer","changeNumPlayer"],["button","","lines","full",3,"click"],["slot","start",3,"ngModel","ngModelChange","click"],[1,"ion-text-wrap"],[3,"arPayment","onPaymentModeChoosed"],["lines","none","id","item-totale"],["slot","start"],[2,"text-align","right"],["color","tertiary","expand","block",1,"full-buttons",3,"disabled","click"]],template:function(l,a){1&l&&(i.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),i.NdJ("click",function(){return a.closeModal()}),i._UZ(4,"ion-icon",3),i.qZA()(),i.TgZ(5,"ion-title"),i._uU(6,"Finalizza"),i.qZA()()(),i.TgZ(7,"ion-content")(8,"div",4)(9,"ion-grid",5)(10,"ion-row")(11,"ion-col")(12,"ion-button",6),i.NdJ("click",function(){return a.closeModal()}),i._uU(13," Aspetta, voglio modificare "),i.qZA()()(),i.TgZ(14,"ion-row")(15,"ion-col")(16,"ion-card")(17,"ion-grid")(18,"ion-row",7)(19,"ion-col",8)(20,"h6",9),i._uU(21),i.ALo(22,"uppercase"),i.ALo(23,"date"),i.qZA(),i.TgZ(24,"h4",10),i._uU(25),i.ALo(26,"date"),i.qZA(),i.TgZ(27,"p",9),i._uU(28),i.ALo(29,"titlecase"),i.ALo(30,"date"),i.qZA()(),i.TgZ(31,"ion-col",11)(32,"h6"),i._uU(33),i.qZA(),i.TgZ(34,"h4"),i._uU(35),i.qZA(),i.TgZ(36,"h6"),i._uU(37),i.ALo(38,"titlecase"),i.qZA()()()()()()(),i.TgZ(39,"ion-row")(40,"ion-col")(41,"ion-card")(42,"ion-grid")(43,"ion-row",7)(44,"ion-col",8)(45,"h6",9),i._uU(46),i.ALo(47,"uppercase"),i.ALo(48,"date"),i.qZA(),i.TgZ(49,"h6",9),i._uU(50),i.ALo(51,"date"),i.qZA()(),i.TgZ(52,"ion-col",11)(53,"h5",9),i._uU(54),i.qZA()()()()()()(),i.TgZ(55,"ion-row")(56,"ion-col")(57,"app-player-number",12),i.NdJ("changeNumPlayer",function(m){return a.onChangedNumPlayer(m)}),i.qZA()()()()()(),i.TgZ(58,"ion-footer")(59,"ion-grid")(60,"ion-list")(61,"ion-item",13),i.NdJ("click",function(){return a.disclaimer=!a.disclaimer}),i.TgZ(62,"ion-checkbox",14),i.NdJ("ngModelChange",function(m){return a.disclaimer=m})("click",function(m){return m.stopPropagation()}),i.qZA(),i.TgZ(63,"ion-label",15)(64,"p"),i._uU(65,"Lette e approvate le "),i.TgZ(66,"a",2),i.NdJ("click",function(m){return m.stopPropagation(),a.onClickCondizioniVendita()}),i._uU(67,"condizioni di vendita"),i.qZA()()()(),i.TgZ(68,"app-payment-mode",16),i.NdJ("onPaymentModeChoosed",function(m){return a.onPaymentModeSelected(m)}),i.qZA(),i.TgZ(69,"ion-item",17)(70,"ion-label",18),i._uU(71,"Totale"),i.qZA(),i.TgZ(72,"ion-label",19),i._uU(73),i.ALo(74,"currency"),i.qZA()()(),i.TgZ(75,"ion-row")(76,"ion-col")(77,"ion-button",20),i.NdJ("click",function(){return a.onConfirm()}),i._uU(78," Conferma Prenotazione "),i.qZA()()()()()),2&l&&(i.xp6(21),i.Oqu(i.lcZ(22,15,i.xi3(23,17,null==a.docPianificazione?null:a.docPianificazione.DATAORAINIZIO,"EEE"))),i.xp6(4),i.Oqu(i.xi3(26,20,null==a.docPianificazione?null:a.docPianificazione.DATAORAINIZIO,"dd")),i.xp6(3),i.Oqu(i.lcZ(29,23,i.xi3(30,25,null==a.docPianificazione?null:a.docPianificazione.DATAORAINIZIO,"MMMM"))),i.xp6(5),i.Oqu(null==a.docPianificazione?null:a.docPianificazione._DESCRSPORT),i.xp6(2),i.Oqu(null==a.selectedCampo?null:a.selectedCampo.DENOMINAZIONE),i.xp6(2),i.Oqu(i.lcZ(38,28,a.getAddressLocation())),i.xp6(9),i.Oqu(i.lcZ(47,30,i.xi3(48,32,null==a.docPianificazione?null:a.docPianificazione.DATAORAINIZIO,"HH:mm"))),i.xp6(4),i.Oqu(i.xi3(51,35,null==a.docPianificazione?null:a.docPianificazione.DATAORAFINE,"HH:mm")),i.xp6(4),i.AsE("",null==a.docPianificazione?null:a.docPianificazione.DURATAORE," ",1!=(null==a.docPianificazione?null:a.docPianificazione.DURATAORE)?"Ore":"Ora",""),i.xp6(3),i.Q6J("numPlayer",null==a.docPianificazione?null:a.docPianificazione.NUMPARTECIPANTI),i.xp6(5),i.Q6J("ngModel",a.disclaimer),i.xp6(6),i.Q6J("arPayment",a.myListPayment),i.xp6(5),i.hij(" ",i.xi3(74,38,null==a.activePrenotazione?null:a.activePrenotazione.TOTALE,"EUR")," "),i.xp6(4),i.Q6J("disabled",!a.disclaimer||!(null!=a.activePrenotazione&&a.activePrenotazione.ISVALID)||!a.mySelectedPayment))},directives:[h.Gu,h.sr,h.Sm,h.YG,h.gu,h.wd,h.W2,h.jY,h.Nd,h.wI,h.PM,T.E,h.fr,h.q_,h.Ie,h.nz,h.w,I.JJ,I.On,h.Q$,x.e],pipes:[O.gd,O.uU,O.rS,O.H9],styles:[".griglia-principale[_ngcontent-%COMP%] > ion-row[_ngcontent-%COMP%] > ion-col[_ngcontent-%COMP%]{padding:0}h6[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:4px;font-size:15px}h4[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:5px;font-weight:600}.left-col[_ngcontent-%COMP%]{border-right-style:solid;border-width:thin;border-color:#eff1f8}p[_ngcontent-%COMP%]{font-size:13px}ion-button.full-buttons[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}#item-totale[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:20px}"]}),g})()}}]);