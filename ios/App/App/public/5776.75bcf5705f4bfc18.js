"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5776],{5776:(k,f,r)=>{r.r(f),r.d(f,{AgendaCustodePageModule:()=>B});var d=r(9808),g=r(4182),i=r(5362),h=r(2028),C=r(7304),b=r(6),I=r(1247),e=r(2096);let _=(()=>{class n{constructor(t,o,s,l,u){this.modalController=t,this.loadingController=o,this.actionSheetController=s,this.toastController=l,this.startService=u,this.selectedLocation=void 0,this.listLocations=[],this.today=new Date}ngOnInit(){this.selectedIsoDate=this.filter.DATAINIZIO.toISOString(),this.requestLocations()}requestLocations(){this.loadingController.create({message:"Caricamento",spinner:"circular",backdropDismiss:!0}).then(t=>(t.present(),this.startService.newRequestLocation(this.filter.IDAREA))).then(t=>{this.loadingController.dismiss(),this.listLocations=t}).catch(t=>{this.loadingController.dismiss(),this.showMessage("Errore di connessione"),console.log(t),this.dismiss()})}dismiss(){this.modalController.dismiss()}submit(){this.canSubmit&&(this.filter.DATAINIZIO=new Date(this.selectedIsoDate),this.modalController.dismiss(this.filter),this.filter.IDLOCATION=this.selectedLocation&&this.selectedLocation.DENOMINAZIONE&&this.selectedLocation.DENOMINAZIONE.length>0?this.selectedLocation.ID:void 0)}get canSubmit(){return!!new Date(this.selectedIsoDate)}showMessage(t){this.toastController.create({message:t,duration:3e3}).then(o=>{o.present()})}presentActionSheet(){this.actionSheetController.create(this.getActionSheetLocationParams()).then(t=>{t.present()})}getActionSheetLocationParams(){let t=[],o=new Object;return o.text="Tutte",o.handler=()=>{this.selectedLocation=void 0},o.icon="location-outline",t.push(o),this.listLocations.forEach(l=>{o=new Object,o.text=l.DENOMINAZIONE,o.handler=()=>{this.selectedLocation=l},o.icon="location-outline",t.push(o)}),o=new Object,o.text="Annulla",o.role="cancel",o.icon="close",t.push(o),{header:"Scegli la location",buttons:t}}get labelSelectedLocation(){let t="";return t=this.selectedLocation&&this.selectedLocation.DENOMINAZIONE&&this.selectedLocation.DENOMINAZIONE.length>0?this.selectedLocation.DENOMINAZIONE:"Tutte le locations",t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(i.IN),e.Y36(i.HT),e.Y36(i.BX),e.Y36(i.yF),e.Y36(I.D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-filter-custode"]],inputs:{filter:"filter"},decls:27,vars:4,consts:[["color","primary"],["slot","end"],["fill","clear",3,"click"],["name","close"],["lines","full"],["color","light"],["slot","start","name","calendar-outline","color","primary"],["displayFormat","DDDD - DD/MM/YYYY","required","","max","2099-12-31","cancelText","Annulla","doneText","Conferma",3,"ngModel","ngModelChange"],["position","floating"],[3,"ngModel","ngModelChange"],["slot","start","name","location-outline","color","primary"],["button","",3,"click"],["color","primary","expand","block",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3,"Filtra occupazioni"),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return o.dismiss()}),e._UZ(6,"ion-icon",3),e.qZA()()()(),e.TgZ(7,"ion-content")(8,"ion-list",4)(9,"ion-item-divider",5),e._UZ(10,"ion-icon",6),e.TgZ(11,"ion-label"),e._uU(12,"Quando: "),e.qZA()(),e.TgZ(13,"ion-datetime",7),e.NdJ("ngModelChange",function(l){return o.selectedIsoDate=l}),e.TgZ(14,"ion-label",8),e._uU(15,"Data"),e.qZA(),e.TgZ(16,"ion-input",9),e.NdJ("ngModelChange",function(l){return o.selectedIsoDate=l}),e.qZA()(),e.TgZ(17,"ion-item-divider",5),e._UZ(18,"ion-icon",10),e.TgZ(19,"ion-label"),e._uU(20,"Dove: "),e.qZA()(),e.TgZ(21,"ion-item",11),e.NdJ("click",function(){return o.presentActionSheet()}),e.TgZ(22,"ion-label"),e._uU(23),e.qZA()()()(),e.TgZ(24,"ion-footer")(25,"ion-button",12),e.NdJ("click",function(){return o.submit()}),e._uU(26,"Conferma"),e.qZA()()),2&t&&(e.xp6(13),e.Q6J("ngModel",o.selectedIsoDate),e.xp6(3),e.Q6J("ngModel",o.selectedIsoDate),e.xp6(7),e.Oqu(o.labelSelectedLocation),e.xp6(2),e.Q6J("disabled",!o.canSubmit))},directives:[i.Gu,i.sr,i.wd,i.Sm,i.YG,i.gu,i.W2,i.q_,i.rH,i.Q$,i.x4,i.QI,g.Q7,g.JJ,g.On,i.pK,i.j9,i.Ie,i.fr],styles:[""]}),n})();var A=r(4021),D=r(655),p=r(5419),T=function(n){function a(){var t=null!==n&&n.apply(this,arguments)||this;return t.Encode={TEXT_TYPE:"TEXT_TYPE",EMAIL_TYPE:"EMAIL_TYPE",PHONE_TYPE:"PHONE_TYPE",SMS_TYPE:"SMS_TYPE"},t}return(0,D.ZT)(a,n),a.prototype.scan=function(t){return(0,p.DM)(this,"scan",{callbackOrder:"reverse"},arguments)},a.prototype.encode=function(t,o){return(0,p.DM)(this,"encode",{},arguments)},a.pluginName="BarcodeScanner",a.plugin="phonegap-plugin-barcodescanner",a.pluginRef="cordova.plugins.barcodeScanner",a.repo="https://github.com/phonegap/phonegap-plugin-barcodescanner",a.platforms=["Android","BlackBerry 10","Browser","iOS","Windows"],a.\u0275fac=function(){var t;return function(s){return(t||(t=e.n5z(a)))(s||a)}}(),a.\u0275prov=e.Yz7({token:a,factory:function(t){return a.\u0275fac(t)}}),a}(p.KY),O=r(7181);function Z(n,a){if(1&n&&(e.TgZ(0,"h2"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.params.riga1Text)}}function P(n,a){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.params.riga2Text)}}function M(n,a){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.params.riga3Text)}}function v(n,a){if(1&n&&e._UZ(0,"ion-icon",11),2&n){const t=e.oxw(2);e.Q6J("name",t.params.badgeIcon)}}function x(n,a){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.params.badgeText," ")}}function y(n,a){if(1&n&&(e.TgZ(0,"ion-badge",9),e.YNc(1,v,1,1,"ion-icon",10),e.YNc(2,x,2,1,"span",6),e.qZA()),2&n){const t=e.oxw();e.Tol(t.badgeClass),e.Q6J("color",t.params.badgeColor),e.xp6(1),e.Q6J("ngIf",t.tipoBadge==t.TipoBadge.iconAndText||t.tipoBadge==t.TipoBadge.onlyIcon),e.xp6(1),e.Q6J("ngIf",t.tipoBadge==t.TipoBadge.iconAndText||t.tipoBadge==t.TipoBadge.onlyText)}}let L=(()=>{class n{constructor(){this.params=new C.g,this.showDate=!1,this.click=new e.vpe,this.TipoBadge=c}ngOnInit(){}onClick(){this.click.emit()}get tipoBadge(){let t;return t=this.params.badgeText&&this.params.badgeText.length>0?this.params.badgeIcon&&this.params.badgeIcon.length>0?c.iconAndText:c.onlyText:this.params.badgeIcon&&this.params.badgeIcon.length>0?c.onlyIcon:c.noBadge,t}get badgeClass(){let t="";return this.tipoBadge==c.onlyIcon?t="badge-icon-only":this.tipoBadge==c.iconAndText&&(t="badge-icon-text"),t}getClassColorColumn(t){let s,o="undef",l=new Date(O.G.formatDateISO(new Date));return t&&t.oraInizio&&(s=O.G.getOnlyDate(t.oraInizio),o=s<l?"past":s>l?"future":"today"),o}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-item-calendario"]],inputs:{params:"params",showDate:"showDate"},outputs:{click:"click"},decls:21,vars:17,consts:[[1,"custom-element"],[1,"ion-no-padding"],[1,"ion-align-items-center"],["size","auto",1,"ion-no-padding","col-left"],[1,"left-label"],[1,"ion-no-padding","col-center",3,"ngClass"],[4,"ngIf"],[1,"ion-no-padding","col-right"],[3,"color","class",4,"ngIf"],[3,"color"],[3,"name",4,"ngIf"],[3,"name"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"ion-grid",1)(2,"ion-row",2)(3,"ion-col",3)(4,"ion-label",4)(5,"h4"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"h4"),e._uU(9),e.ALo(10,"date"),e.qZA()()(),e.TgZ(11,"ion-col",5)(12,"ion-label")(13,"p"),e._uU(14),e.ALo(15,"date"),e.qZA(),e.YNc(16,Z,2,1,"h2",6),e.YNc(17,P,2,1,"h3",6),e.YNc(18,M,2,1,"h3",6),e.qZA()(),e.TgZ(19,"ion-col",7),e.YNc(20,y,3,5,"ion-badge",8),e.qZA()()()()),2&t&&(e.xp6(6),e.Oqu(e.xi3(7,8,o.params.oraInizio,"HH.mm")),e.xp6(3),e.Oqu(e.xi3(10,11,o.params.oraFine,"HH.mm")),e.xp6(2),e.Q6J("ngClass",o.getClassColorColumn(o.params)),e.xp6(3),e.Oqu(e.xi3(15,14,o.params.oraInizio,"EEE dd/MM/yyyy")),e.xp6(2),e.Q6J("ngIf",o.params.riga1Text),e.xp6(1),e.Q6J("ngIf",o.params.riga2Text),e.xp6(1),e.Q6J("ngIf",o.params.riga3Text),e.xp6(2),e.Q6J("ngIf",o.tipoBadge!=o.TipoBadge.noBadge))},directives:[i.jY,i.Nd,i.wI,i.Q$,d.mk,d.O5,i.yp,i.gu],pipes:[d.uU],styles:["h3[_ngcontent-%COMP%]{color:gray;font-size:12px;font-weight:480}h4[_ngcontent-%COMP%]{font-size:14px}div.custom-element[_ngcontent-%COMP%]{cursor:pointer;padding:8px 10px 8px 15px;border-bottom:1px;border-bottom-style:solid;border-bottom-color:#b5b5b5}div.custom-element[_ngcontent-%COMP%]   ion-col.col-left[_ngcontent-%COMP%]{padding-right:10px}div.custom-element[_ngcontent-%COMP%]   ion-col.col-center[_ngcontent-%COMP%]{padding-left:5px;border-left:2px;border-left-style:solid}div.custom-element[_ngcontent-%COMP%]   ion-col.col-center.past[_ngcontent-%COMP%]{border-left-color:var(--ion-color-danger)}div.custom-element[_ngcontent-%COMP%]   ion-col.col-center.undef[_ngcontent-%COMP%]{border-left-color:var(--ion-color-primary)}div.custom-element[_ngcontent-%COMP%]   ion-col.col-center.future[_ngcontent-%COMP%]{border-left-color:var(--ion-color-warning)}div.custom-element[_ngcontent-%COMP%]   ion-col.col-center.today[_ngcontent-%COMP%]{border-left-color:var(--ion-color-success)}div.custom-element[_ngcontent-%COMP%]   ion-col.col-right[_ngcontent-%COMP%]{text-align:end}div.custom-element[_ngcontent-%COMP%]   ion-badge.badge-icon-only[_ngcontent-%COMP%]{font-size:30px}div.custom-element[_ngcontent-%COMP%]   ion-badge.badge-icon-only[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{padding-top:4px}"]}),n})();var c=(()=>{return(n=c||(c={}))[n.onlyIcon=0]="onlyIcon",n[n.onlyText=1]="onlyText",n[n.iconAndText=2]="iconAndText",n[n.noBadge=3]="noBadge",c;var n})();function N(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-item-calendario",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(2).onClickOccupazione(l)}),e.qZA()}if(2&n){const t=a.$implicit,o=e.oxw(2);e.Q6J("params",o.getItemCalendario(t))}}function S(n,a){if(1&n&&(e.TgZ(0,"div",8)(1,"ion-list",18),e.YNc(2,N,1,1,"app-item-calendario",19),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.listOccupazioni)}}function E(n,a){1&n&&(e.TgZ(0,"div",21)(1,"ion-label"),e._uU(2,"Nessuna occupazione prevista"),e.qZA()())}const z=[{path:"",component:(()=>{class n{constructor(t,o,s,l,u,m,U,Q){this.barcodeScanner=t,this.loadingController=o,this.startService=s,this.toastController=l,this.alertController=u,this.actionSheeetController=m,this.modalController=U,this.navController=Q,this.listOccupazioni=[],this.listLocations=[],this.filter=new b.B(!0),this.filter.IDAREA=this.startService.areaSelectedValue.ID,this.filter.DATAINIZIO=new Date,this.selectedIsoDate=this.filter.DATAINIZIO.toISOString(),this.myIsDesktop=this.startService.isDesktop,this.onListenAreaChange()}ngOnInit(){this.requestOccupazioni()}ngOnDestroy(){this.listenAreaSelected&&this.listenAreaSelected.unsubscribe()}onListenAreaChange(){this.listenAreaSelected=this.startService.areaSelected.subscribe(t=>{this.labelAllLocations=t?"Locations di "+t.DENOMINAZIONE:"Tutte le Locations",this.requestListLocation(t.ID)})}setLabelLocation(){let t;this.filter&&this.filter.IDLOCATION&&0!=this.filter.IDLOCATION.length&&(t=this.listLocations.find(o=>o.ID==this.filter.IDLOCATION)),this.labelLocation=t?t.DENOMINAZIONE:this.labelAllLocations}onChangeLocation(t){this.filter&&(this.filter.IDLOCATION=t,this.setLabelLocation(),this.requestOccupazioni())}requestListLocation(t){this.startService.newRequestLocation(t).then(o=>{this.listLocations=o,this.setLabelLocation()})}requestOccupazioni(t){this.loadingController.create({message:"Caricamento...",spinner:"circular"}).then(o=>(t||o.present(),this.startService.requestOccupazioniByFilter(this.filter))).then(o=>{this.listOccupazioni=o,this.loadingController.dismiss(),t&&t.target.complete()}).catch(o=>{this.loadingController.dismiss(),t&&t.target.complete(),console.log(o),this.showMessage("Errore di connessione")})}onChangeFilterDateImpegni(){this.filter.DATAINIZIO=new Date(this.selectedIsoDate),this.requestOccupazioni()}showMessage(t,o){"alert"==o?this.alertController.create({message:t,buttons:["OK"]}).then(l=>{l.present()}):this.toastController.create({message:t,duration:3e3}).then(s=>{s.present()})}onClickOccupazione(t){this.goToReservationDetail(null,t)}getItemCalendario(t){return C.g.getParamsOccupazioneCampo(t)}showFilter(){this.modalController.create({component:_,componentProps:{filter:this.filter}}).then(t=>(t.present(),t.onDidDismiss())).then(t=>{let o=t.data;o?(this.filter=o,this.selectedIsoDate=this.filter.DATAINIZIO.toISOString(),this.requestOccupazioni(),this.setLabelLocation()):console.log("Non ci sono dati")})}scanQr(){this.startService.isDesktop||this.barcodeScanner.scan().then(t=>{this.goToReservationDetail(t.text)}).catch(t=>{console.log(t),this.showMessage("Errore nella lettura del codice")})}goToReservationDetail(t,o){o?o.TIPO==A.bS.settorePrenotazione?this.navController.navigateForward(`/agenda-custode/${o.ID}`):this.showMessage("Puoi visualizzare solo il dettaglio delle prenotazioni"):t&&t.length>0&&this.startService.requestOccupazioneById(t).then(s=>{s?s.TIPO==A.bS.settorePrenotazione?this.navController.navigateForward(`/agenda-custode/${s.ID}`):this.showMessage("Puoi visualizzare solo il dettaglio delle prenotazioni"):this.showMessage("Codice non valido")}).catch(s=>{this.showMessage("Errore di connessione"),console.log(s)})}onChooseLocation(){let t;t=this.getActionSheetLocationParams(),this.actionSheeetController.create(t).then(o=>{o.present()})}getActionSheetLocationParams(){let t=[];return t.push({text:this.labelAllLocations,handler:()=>{this.onChangeLocation(null)}}),this.listLocations.forEach(u=>{t.push({text:u.DENOMINAZIONE,handler:()=>{this.onChangeLocation(u.ID)}})}),t.push({text:"Annulla",role:"cancel",icon:"close"}),{header:"Scegli la location",buttons:t}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T),e.Y36(i.HT),e.Y36(I.D),e.Y36(i.yF),e.Y36(i.Br),e.Y36(i.BX),e.Y36(i.IN),e.Y36(i.SH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-agenda-custode"]],decls:28,vars:5,consts:[["color","primary"],["slot","start"],["defaultHref","/home"],["slot","end"],["fill","clear",3,"click"],["name","filter"],["scrollEvents",""],["slot","fixed",3,"ionRefresh"],[1,"ion-no-padding"],["detail","true",3,"click"],["slot","start","name","location-outline"],["slot","start","name","calendar-outline","color","primary"],["max","2099-12-31","cancelText","Annulla","doneText","Conferma","displayFormat","DDDD - DD/MM/YYYY",3,"ngModel","ngModelChange"],["name","chevron-down-outline","color","primary","slot","end"],["class","ion-no-padding",4,"ngIf"],["class","nofind-cnt",4,"ngIf"],["color","primary","expand","block",3,"disabled","click"],["slot","start","name","qr-code-outline"],[1,"ion-padding-vertical"],[3,"params","click",4,"ngFor","ngForOf"],[3,"params","click"],[1,"nofind-cnt"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Occupazioni"),e.qZA(),e.TgZ(6,"ion-buttons",3)(7,"ion-button",4),e.NdJ("click",function(){return o.showFilter()}),e._UZ(8,"ion-icon",5),e.qZA()()()(),e.TgZ(9,"ion-content",6)(10,"ion-refresher",7),e.NdJ("ionRefresh",function(l){return o.requestOccupazioni(l)}),e._UZ(11,"ion-refresher-content"),e.qZA(),e.TgZ(12,"ion-list",8)(13,"ion-item",9),e.NdJ("click",function(){return o.onChooseLocation()}),e._UZ(14,"ion-icon",10),e.TgZ(15,"ion-label")(16,"h5"),e._uU(17),e.qZA()()(),e.TgZ(18,"ion-item"),e._UZ(19,"ion-icon",11),e.TgZ(20,"ion-datetime",12),e.NdJ("ngModelChange",function(l){return o.selectedIsoDate=l})("ngModelChange",function(){return o.onChangeFilterDateImpegni()}),e.qZA(),e._UZ(21,"ion-icon",13),e.qZA()(),e.YNc(22,S,3,1,"div",14),e.YNc(23,E,3,0,"div",15),e.qZA(),e.TgZ(24,"ion-footer")(25,"ion-button",16),e.NdJ("click",function(){return o.scanQr()}),e._UZ(26,"ion-icon",17),e._uU(27," Qr-Code Prenotazione "),e.qZA()()),2&t&&(e.xp6(17),e.Oqu(o.labelLocation),e.xp6(3),e.Q6J("ngModel",o.selectedIsoDate),e.xp6(2),e.Q6J("ngIf",o.listOccupazioni&&o.listOccupazioni.length>0),e.xp6(1),e.Q6J("ngIf",!o.listOccupazioni||o.listOccupazioni.length<=0),e.xp6(2),e.Q6J("disabled",o.myIsDesktop))},directives:[i.Gu,i.sr,i.Sm,i.oU,i.cs,i.wd,i.YG,i.gu,i.W2,i.nJ,i.Wo,i.q_,i.Ie,i.Q$,i.x4,i.QI,g.JJ,g.On,d.O5,d.sg,L,i.fr],styles:["ion-select[_ngcontent-%COMP%]::part(icon){display:none!important}"]}),n})()},{path:":idPianificazione",loadChildren:()=>Promise.all([r.e(8592),r.e(8755)]).then(r.bind(r,8755)).then(n=>n.AgendaCustodeDetailsPageModule)}];let w=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[h.Bz.forChild(z)],h.Bz]}),n})();var Y=r(933);const F=[{path:"",component:_}];let q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[h.Bz.forChild(F)],h.Bz]}),n})(),J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[d.ez,g.u5,i.Pc,q]]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[T],imports:[[d.ez,g.u5,i.Pc,Y.q,w,J]]}),n})()}}]);