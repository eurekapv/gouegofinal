"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[600],{600:(H,p,r)=>{r.r(p),r.d(p,{HistorybookPageModule:()=>D});var m=r(9808),O=r(4182),n=r(7026),I=r(2028),Z=r(8698),N=r(2274),T=r(6962);const f=(0,r(7423).fo)("Share",{web:()=>r.e(7907).then(r.bind(r,7907)).then(i=>new i.ShareWeb)});var P=r(8223),C=r(4021),b=r(7266),A=r(9129),o=r(2096),y=r(5174);function v(i,l){if(1&i&&(o.TgZ(0,"ion-button",24),o._UZ(1,"ion-icon",25),o.qZA()),2&i){const t=o.oxw().$implicit;o.s9C("href","mailto:"+t._EMAIL_Location+"?subject=Prenotazione numero "+t.PROGRESSIVO)}}function x(i,l){1&i&&o._UZ(0,"ion-icon",29)}function _(i,l){1&i&&o._UZ(0,"ion-icon",30)}function R(i,l){if(1&i&&(o.TgZ(0,"ion-item",6),o.YNc(1,x,1,0,"ion-icon",26),o.TgZ(2,"ion-label",27),o._uU(3),o.qZA(),o.YNc(4,_,1,0,"ion-icon",28),o.qZA()),2&i){const t=o.oxw().index,e=o.oxw();o.xp6(1),o.Q6J("ngIf",0!=t),o.xp6(2),o.AsE("DATA ",t+1," DI ",e.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length,""),o.xp6(1),o.Q6J("ngIf",t<e.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length-1)}}function S(i,l){if(1&i){const t=o.EpF();o.TgZ(0,"ion-slide")(1,"div",10)(2,"div",11)(3,"h6"),o._uU(4),o.qZA(),o._UZ(5,"qrcode",12),o.TgZ(6,"p"),o._UZ(7,"ion-icon",13),o._uU(8," Presenta il Qr-code o l'ID prenotazione all'ingresso "),o.qZA()(),o.TgZ(9,"div",14)(10,"ion-button",15),o.NdJ("click",function(){const s=o.CHM(t).$implicit;return o.oxw().onClickTrash(s.ID)}),o._UZ(11,"ion-icon",16),o.qZA(),o.YNc(12,v,2,1,"ion-button",17),o.TgZ(13,"ion-button",18),o.NdJ("click",function(){const s=o.CHM(t).$implicit;return o.oxw().onShare(s)}),o._UZ(14,"ion-icon",19),o.qZA()(),o.TgZ(15,"ion-list",20),o.YNc(16,R,5,4,"ion-item",8),o.TgZ(17,"ion-item")(18,"ion-label")(19,"h2"),o._uU(20),o.qZA()(),o.TgZ(21,"ion-chip",0)(22,"i",21),o._UZ(23,"span",22),o.qZA()()(),o.TgZ(24,"ion-item")(25,"ion-label")(26,"h2"),o._uU(27),o.ALo(28,"titlecase"),o.ALo(29,"date"),o.qZA(),o.TgZ(30,"p"),o._uU(31),o.ALo(32,"date"),o.ALo(33,"date"),o.qZA()(),o.TgZ(34,"ion-chip",0),o._uU(35),o.qZA()(),o.TgZ(36,"ion-item")(37,"ion-label")(38,"h2"),o._uU(39),o.qZA(),o.TgZ(40,"p"),o._uU(41),o.ALo(42,"titlecase"),o.qZA(),o.TgZ(43,"p"),o._uU(44),o.ALo(45,"titlecase"),o.qZA()(),o.TgZ(46,"ion-chip",0),o._uU(47),o._UZ(48,"ion-icon",23),o.qZA()()()()()}if(2&i){const t=l.$implicit,e=o.oxw();o.xp6(4),o.hij("ID: ",t.PROGRESSIVO,""),o.xp6(1),o.Q6J("qrdata",t.ID),o.xp6(7),o.Q6J("ngIf",t&&t._EMAIL_Location),o.xp6(4),o.Q6J("ngIf",e.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length>1),o.xp6(4),o.Oqu(t._DENOMINAZIONE_Sport),o.xp6(3),o.Q6J("innerHTML",e.getIcon(t.IDSPORT),o.oJD),o.xp6(4),o.Oqu(o.lcZ(28,15,o.xi3(29,17,t.DATAORAINIZIO,"EEEE dd/LL/yyyy"))),o.xp6(4),o.AsE("dalle ",o.xi3(32,20,t.DATAORAINIZIO,"HH:mm")," alle ",o.xi3(33,23,t.DATAORAFINE,"HH:mm")," "),o.xp6(4),o.AsE(" ",t.DURATAORE," ",1==t.DURATAORE?"Ora":"Ore"," "),o.xp6(4),o.Oqu(t._DENOMINAZIONE_Campo),o.xp6(2),o.Oqu(o.lcZ(42,26,t._COMUNE_Location)),o.xp6(3),o.Oqu(o.lcZ(45,28,t._INDIRIZZO_Location)),o.xp6(3),o.hij(" ",t.NUMPARTECIPANTI," ")}}function M(i,l){if(1&i&&(o.TgZ(0,"ion-item",6)(1,"ion-label",1),o._uU(2," Pagato "),o.qZA(),o.TgZ(3,"ion-label",7),o._uU(4),o.ALo(5,"currency"),o.qZA()()),2&i){const t=o.oxw();o.xp6(4),o.hij(" ",o.xi3(5,1,t.myPrenotazione.INCASSATO,"EUR")," ")}}const U=[{path:"",component:(()=>{class i{constructor(t,e,a,s,c,g,d,h){this.router=t,this.navCtr=e,this.startService=a,this.toastCtr=s,this.docStructureService=c,this.loadingController=g,this.docstructrureService=d,this.alertController=h,this.myPrenotazione=new Z.i,this.arPayments=[],this.sliderOpts={slidesPerView:1,spaceBetween:0,initialSlide:0}}ngOnInit(){let t=!0;this.loadingController.create({spinner:"circular",message:"Caricamento",backdropDismiss:!0}).then(e=>{e.present(),this.subStartConfig=this.startService.startConfig.subscribe(a=>{this.startConfig=a}),this.router.paramMap.subscribe(a=>{a.has("historyId")?(this.historyId=a.get("historyId"),t=0!==this.historyId.length&&this.requestByHistoryId(this.historyId)):t=!1,t||(this.loadingController.dismiss(),this.goBack())})})}requestByHistoryId(t){let e=!0,a="",s="";if(0!==t.length)if(a=t.substr(0,36),s=t.substr(37,36),36!==a.length||36!==s.length)e=!1;else{this.idPrenotazione=a,this.idPianificazione=s;let c=new Z.i(!0);c.ID=a;let g=new b.Kl;g.child_level=2,this.docStructureService.requestNew(c,g).then(d=>{if(this.myPrenotazione=d[0],this.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE&&0!==this.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length){let h=N._.getReqForeignKeys();this.docStructureService.decodeCollection(this.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE,h).then(()=>{this.docstructrureService.getRelDoc(this.myPrenotazione,["IDAREAOPERATIVA"]).then(u=>{this.myArea=u,this.setPaymentFromArea(),this.loadingController.dismiss()}).catch(u=>{this.loadingController.dismiss(),this.showMessage("Errore nel caricamento Area"),A.M.consoleLog(u,"error")})}).catch(u=>{this.loadingController.dismiss(),this.showMessage("Errore nel caricamento Elenco"),A.M.consoleLog(u,"error")})}else this.docstructrureService.getRelDoc(this.myPrenotazione,["IDAREAOPERATIVA"],3).then(h=>{this.myArea=h,this.setPaymentFromArea(),this.loadingController.dismiss()}).catch(h=>{this.loadingController.dismiss(),this.showMessage("Errore nel caricamento Area"),A.M.consoleLog(h,"error")})}).catch(d=>{this.loadingController.dismiss(),this.showMessage("Errore nel caricamento Prenotazione"),A.M.consoleLog(d,"error")})}else e=!1;return e}setPaymentFromArea(){}ngOnDestroy(){}goBack(){this.showMessage("Informazioni prenotazioni errate"),this.navCtr.navigateBack(["/","historylist"])}showMessage(t){this.toastCtr.create({message:t,duration:3e3}).then(e=>{e.present()})}getIcon(t){return this.startService.getSportIcon(t)}onShare(t){let a,s,c,e="";if(this.myPrenotazione&&t){for(const g of this.myArea.AREALINKS)if(g.TIPOURL==C.GV.home){e=g.REFERURL;break}e||(e=""),a=this.startConfig.getUrlLogo(),s=this.myPrenotazione.NOMINATIVO+"  ha prenotato il "+t.DATAORAINIZIO.toLocaleDateString()+" alle "+t.DATAORAINIZIO.toLocaleTimeString(),this.startConfig.companyName&&(s+=" presso "+this.startConfig.companyName),t._INDIRIZZO_Location&&(s+=" "+t._INDIRIZZO_Location),t._DENOMINAZIONE_Campo&&(s+=" (Campo: "+t._DENOMINAZIONE_Campo),t._DENOMINAZIONE_Sport&&(s+=", Attivit\xe0: "+t._DENOMINAZIONE_Sport+")"),c="Prenotazione "+t.PROGRESSIVO,f.canShare().then(g=>{g.value&&f.share({title:c,text:s,url:e})})}else this.showMessage("Errore nella condivisione")}onClickTrash(t){this.alertController.create({header:"Sei sicuro?",message:"Continuando, cancellerai questa prenotazione",buttons:[{text:"Conferma",handler:()=>{this.deletePianificazione(t)}},{text:"Annulla",role:"cancel"}]}).then(e=>{e.present()})}deletePianificazione(t){this.loadingController.create({message:"Cancellazione...",spinner:"circular",backdropDismiss:!0}).then(e=>e.present()).then(()=>this.startService.requestDeletePianificazione(t)).then(e=>{this.loadingController.dismiss(),this.showMessage(e.message),e.result&&this.navCtr.navigateBack("/historylist")}).catch(e=>{this.loadingController.dismiss(),this.showMessage(e.message)})}}return i.\u0275fac=function(t){return new(t||i)(o.Y36(I.gz),o.Y36(n.SH),o.Y36(T.D),o.Y36(n.yF),o.Y36(P.l),o.Y36(n.HT),o.Y36(P.l),o.Y36(n.Br))},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-historybook"]],decls:28,vars:13,consts:[["color","primary"],["slot","start"],["defaultHref","/historylist"],[3,"options"],[4,"ngFor","ngForOf"],["color","light"],["lines","full"],[2,"text-align","right"],["lines","full",4,"ngIf"],["expand","block","color","tertiary",3,"disabled"],[2,"width","100%"],["mode","md",1,"ion-text-center","div-qr"],[3,"qrdata"],["name","information-circle-outline","color","primary"],[1,"ion-text-center","div-btns"],["layout","icon-top","fill","clear","size","large",3,"click"],["name","trash-outline"],["fill","clear","size","large",3,"href",4,"ngIf"],["fill","clear","size","large",3,"click"],["name","share-social-outline"],["lines","none"],[1,"icon-sport"],[3,"innerHTML"],["name","person"],["fill","clear","size","large",3,"href"],["name","mail-outline"],["color","primary","class","no-margin-vertical","slot","start","name","chevron-back",4,"ngIf"],[1,"no-margin-vertical"],["color","primary","class","no-margin-vertical","slot","end","name","chevron-forward",4,"ngIf"],["color","primary","slot","start","name","chevron-back",1,"no-margin-vertical"],["color","primary","slot","end","name","chevron-forward",1,"no-margin-vertical"]],template:function(t,e){1&t&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),o._UZ(3,"ion-back-button",2),o.qZA(),o.TgZ(4,"ion-title"),o._uU(5,"Prenotazione "),o.qZA()()(),o.TgZ(6,"ion-content")(7,"div")(8,"ion-slides",3),o.YNc(9,S,49,30,"ion-slide",4),o.qZA(),o.TgZ(10,"ion-item",5),o._uU(11," PAGAMENTO "),o.qZA(),o.TgZ(12,"ion-item",6)(13,"ion-label",1),o._uU(14," Importo "),o.qZA(),o.TgZ(15,"ion-label",7),o._uU(16),o.ALo(17,"currency"),o.qZA()(),o.YNc(18,M,6,4,"ion-item",8),o.TgZ(19,"ion-item",6)(20,"ion-label",1),o._uU(21," Residuo "),o.qZA(),o.TgZ(22,"ion-label",7),o._uU(23),o.ALo(24,"currency"),o.qZA()()()(),o.TgZ(25,"ion-footer")(26,"ion-button",9),o._uU(27),o.qZA()()),2&t&&(o.xp6(8),o.Q6J("options",e.sliderOpts),o.xp6(1),o.Q6J("ngForOf",e.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE),o.xp6(7),o.hij(" ",o.xi3(17,7,e.myPrenotazione.TOTALE,"EUR")," "),o.xp6(2),o.Q6J("ngIf",e.myPrenotazione.TOTALE!=e.myPrenotazione.INCASSATO),o.xp6(5),o.hij(" ",o.xi3(24,10,e.myPrenotazione.RESIDUO,"EUR")," "),o.xp6(3),o.Q6J("disabled",!0),o.xp6(1),o.hij(" ",e.myPrenotazione.getCaptionStatePayment(!1)," "))},directives:[n.Gu,n.sr,n.Sm,n.oU,n.cs,n.wd,n.W2,n.Hr,m.sg,n.A$,y.V,n.gu,n.YG,m.O5,n.q_,n.Ie,n.Q$,n.hM,n.fr],pipes:[m.rS,m.uU,m.H9],styles:[".div-qr[_ngcontent-%COMP%]{background-color:var(--ion-color-light);padding-top:3vh;padding-bottom:3vh}.div-qr[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0 0 8px;color:var(--ion-color-primary);font-weight:700}.div-qr[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:8px 0 0;color:#2b2b2b;padding-left:25px;padding-right:25px}.div-btns[_ngcontent-%COMP%]{border-bottom-style:solid;border-bottom-color:#e4e4e4;border-bottom-width:1px}.btn-pay[_ngcontent-%COMP%]{margin-top:4vh}i[_ngcontent-%COMP%]{font-size:30px}"]}),i})()}];let z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[[I.Bz.forChild(U)],I.Bz]}),i})(),D=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[[m.ez,O.u5,n.Pc,z,y.N]]}),i})()}}]);