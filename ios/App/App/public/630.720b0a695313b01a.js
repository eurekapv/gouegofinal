"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[630],{7708:(y,d,r)=>{r.d(d,{b:()=>l});var n=r(4021);class l{constructor(i){this.idElectronicResult="",this.modePayment=i,i==n.x6.pagaStruttura?(this.channelPayment=n.$s.onSite,this.processResult=!0):i==n.x6.pagaBonifico&&(this.channelPayment=n.$s.bonifico,this.processResult=!0)}}},8622:(y,d,r)=>{r.d(d,{t:()=>h});var n=r(9129),l=r(4021),o=r(2096),i=r(7026),_=r(9808);function g(m,p){1&m&&(o.TgZ(0,"div")(1,"ion-card",10)(2,"ion-card-content")(3,"p"),o._uU(4,"Connessione con servizi di pagamento..."),o.qZA(),o._UZ(5,"ion-progress-bar",11),o.qZA()()())}function u(m,p){1&m&&(o.TgZ(0,"div",12)(1,"ion-card",10)(2,"ion-card-content"),o._UZ(3,"div",13),o.qZA()()())}let h=(()=>{class m{constructor(a,t){this.modalController=a,this.toastController=t,this.urlPayPalScriptCheckOut="https://www.paypalobjects.com/api/checkout.js",this.urlPayPalScriptSmart="https://www.paypal.com/sdk/js?client-id=",this.urlPaypal="",this.paypalVersion="checkout",this.showPaypal=!1,this.showStripe=!1,this.showApplePay=!1,this.showGPay=!1,this.noPayment=!1,this.showProgressBar=!0,this.paypalVersion="smart"}ngOnInit(){this.initPaymentMethods()}initPaymentMethods(){if(this.noPayment=!0,this.listAreaPaymentSettings&&0!=this.listAreaPaymentSettings.length)for(let a=0;a<this.listAreaPaymentSettings.length;a++){const t=this.listAreaPaymentSettings[a];if(t.paymentInApp)switch(t.TIPOPAYMENT){case l.$s.paypal:if(this.noPayment=!1,this.showPaypal=!0,"checkout"==this.paypalVersion)this.urlPaypal=this.urlPayPalScriptCheckOut;else if("smart"==this.paypalVersion){switch(t.PPENVIRONMENT){case l.pW.production:this.urlPaypal=this.urlPayPalScriptSmart+t.PPCLIENTIDPRODUCTION;break;case l.pW.test:this.urlPaypal=this.urlPayPalScriptSmart+t.PPCLIENTIDSANDBOX}this.urlPaypal+="&currency=EUR"}this.scriptOnHead(this.urlPaypal)?setTimeout(()=>{this.renderPayPalBtn(t)},500):this.loadDinamicScript(this.urlPaypal).then(()=>{setTimeout(()=>{this.renderPayPalBtn(t)},500)}).catch(()=>{this.showMessage("Errore nelle impostazioni di PayPal; contatta la struttura"),this.onCancelPayment()});break;case l.$s.stripe:this.noPayment=!1,this.showStripe=!0;break;case l.$s.applePay:this.noPayment=!1,this.showApplePay=!0}}else this.noPayment=!0}onCancelPayment(){this.paymentData.processResult=!1,this.paymentData.messageResult="Pagamento annullato",this.modalController.dismiss(this.paymentData)}onSuccessPayment(a,t){this.paymentData.channelPayment=a,this.paymentData.idElectronicResult=t,this.paymentData.processResult=!0,this.paymentData.messageResult="Transazione completata con successo",this.modalController.dismiss(this.paymentData)}OnSuccessPaypal(a){let t,c,e;if(a){switch(this.paypalVersion){case"smart":c=a.payer.name.given_name,t=a.id,e=a.status,n.M.consoleLog(a);break;case"checkout":c=a.payer.name.given_name,t=a.id,e=a.status}this.onSuccessPayment(l.$s.paypal,t)}}loadDinamicScript(a){return new Promise((t,c)=>{const e=document.createElement("script");e.type="text/javascript",e.src=a,document.getElementsByTagName("head")[0].appendChild(e),e.onload=()=>{n.M.consoleLog("Script correctly loaded","warn"),t()},e.onerror=s=>{n.M.consoleLog(s,"error"),c()}})}renderPayPalBtn(a){let t=this;"checkout"==this.paypalVersion?(this.showProgressBar=!1,paypal.Button.render({env:a.PPENVIRONMENT==l.pW.production?"production":"sandbox",client:{sandbox:a.PPCLIENTIDSANDBOX,production:a.PPCLIENTIDPRODUCTION},locale:"it_IT",style:{size:"responsive",color:"gold",shape:"pill",label:"pay",fundingicons:!0},commit:!0,payment:function(c,e){return e.payment.create({transactions:[{amount:{total:t.paymentData.amount+"",currency:t.paymentData.currency},description:t.paymentData.description}],note_to_payer:"Contatta la struttura per ogni problematica sul pagamento."})},onAuthorize:function(c,e){return e.payment.execute().then(function(s){t.OnSuccessPaypal(s)})}},"#customBtnPaypal")):"smart"==this.paypalVersion&&(this.showProgressBar=!1,paypal.Buttons({createOrder:function(c,e){return e.order.create({purchase_units:[{amount:{value:t.paymentData.amount+"",description:t.paymentData.description}}]})},onApprove:function(c,e){return e.order.capture().then(function(s){t.OnSuccessPaypal(s)})}}).render("#customBtnPaypal"))}scriptOnHead(a){let t=document.getElementsByTagName("script"),c=!1;for(let e=0;e<t.length;e++)if(t[e].getAttribute("src")==a){c=!0;break}return c}showMessage(a){this.toastController.create({message:a,duration:3e3}).then(t=>{t.present()})}}return m.\u0275fac=function(a){return new(a||m)(o.Y36(i.IN),o.Y36(i.yF))},m.\u0275cmp=o.Xpm({type:m,selectors:[["app-payment"]],inputs:{paymentData:"paymentData",listAreaPaymentSettings:"listAreaPaymentSettings"},decls:19,vars:7,consts:[["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","ios","close","md","close"],["color","danger","expand","block",1,"full-buttons",3,"click"],[4,"ngIf"],[1,"cart-total"],["lines","none"],["slot","end",1,"ion-text-right"],["class","cart-items",4,"ngIf"],["mode","ios"],["type","indeterminate"],[1,"cart-items"],["id","customBtnPaypal"]],template:function(a,t){1&a&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),o.NdJ("click",function(){return t.onCancelPayment()}),o._UZ(4,"ion-icon",3),o.qZA()(),o.TgZ(5,"ion-title"),o._uU(6,"Pagamento"),o.qZA()()(),o.TgZ(7,"ion-content")(8,"ion-button",4),o.NdJ("click",function(){return t.onCancelPayment()}),o._uU(9," Aspetta, voglio modificare "),o.qZA(),o.YNc(10,g,6,0,"div",5),o.TgZ(11,"div",6)(12,"ion-item",7)(13,"ion-label"),o._uU(14),o.qZA(),o.TgZ(15,"ion-label",8),o._uU(16),o.ALo(17,"currency"),o.qZA()()(),o.YNc(18,u,4,0,"div",9),o.qZA()),2&a&&(o.xp6(10),o.Q6J("ngIf",t.showProgressBar),o.xp6(4),o.Oqu(t.paymentData.description),o.xp6(2),o.Oqu(o.xi3(17,4,t.paymentData.amount,t.paymentData.currency)),o.xp6(2),o.Q6J("ngIf",t.showPaypal))},directives:[i.Gu,i.sr,i.Sm,i.YG,i.gu,i.wd,i.W2,_.O5,i.PM,i.FN,i.X7,i.Ie,i.Q$],pipes:[_.H9],styles:[".welcome-card[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;max-width:90vw}.welcome-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{max-height:35vh;overflow:hidden}.welcome-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{margin:auto}.welcome-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{margin:auto}ion-button.full-buttons[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}ion-content[_ngcontent-%COMP%]{--padding-top: 16px;--padding-bottom: 16px;--padding-start: 26px;--padding-end: 26px}.title[_ngcontent-%COMP%]{margin-top:0;color:#434343}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{margin-left:0;margin-right:0;border-radius:0}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{display:flex;position:relative}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-img[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:16px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:cover;object-fit:cover;width:110px;height:110px;box-shadow:0 10px 30px #00000029}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(1){color:#434343}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(2){color:#919191}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(3){color:var(--ion-color-primary)}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .qty-selector[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background:#f6f6f6;border-radius:5px;margin-top:10px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .qty-selector[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #565656;font-size:16px;margin-left:8px;margin-right:8px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .qty-selector[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#565656!important;font-size:16px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   #customBtnPaypal[_ngcontent-%COMP%]{text-align:center;width:100%}.address[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;font-size:18px;color:#434343}.address[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{width:12px;height:12px;padding:0;border-radius:50%}hr[_ngcontent-%COMP%]{background:#97979713}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-right:0}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]:nth-child(1){color:#919191}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]:nth-child(2){color:#434343}ion-footer[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}ion-footer[_ngcontent-%COMP%]   .main-button[_ngcontent-%COMP%]:after{box-shadow:none!important}"]}),m})()},7952:(y,d,r)=>{r.d(d,{e:()=>a});var n=r(2096),l=r(9953),o=r(4021),i=r(7026),_=r(9808);function g(t,c){1&t&&(n.TgZ(0,"ion-item",2)(1,"ion-label"),n._uU(2,"Pagamento non supportato"),n.qZA()())}function u(t,c){1&t&&(n.TgZ(0,"p"),n._uU(1," Clicca per altri metodi di pagamento "),n.qZA())}function h(t,c){if(1&t&&(n.TgZ(0,"ion-label")(1,"h6"),n._uU(2),n.qZA(),n.YNc(3,u,2,0,"p",5),n.qZA()),2&t){const e=n.oxw(2);n.xp6(2),n.Oqu(null==e.selectedPaymentMode?null:e.selectedPaymentMode.description),n.xp6(1),n.Q6J("ngIf",e.arPaymentModeList.length>1)}}function m(t,c){1&t&&(n.TgZ(0,"ion-label"),n._uU(1,"Scegli metodo di pagamento"),n.qZA())}function p(t,c){if(1&t){const e=n.EpF();n.TgZ(0,"ion-item",3),n.NdJ("click",function(){return n.CHM(e),n.oxw().onOpenChoose()}),n._UZ(1,"ion-icon",4),n.YNc(2,h,4,2,"ion-label",5),n.YNc(3,m,2,0,"ion-label",5),n.qZA()}if(2&t){const e=n.oxw();n.Q6J("detail",!0),n.xp6(1),n.Q6J("name",e.itemIcon),n.xp6(1),n.Q6J("ngIf",e.selectedPaymentMode),n.xp6(1),n.Q6J("ngIf",!e.selectedPaymentMode)}}let a=(()=>{class t{constructor(e){this.actionSheetController=e,this.arPayment=[],this.onPaymentModeChoosed=new n.vpe,this.arPaymentModeList=[]}ngOnInit(){this.arPaymentModeList=l.L.prepareArPaymentMode(this.arPayment),this.chooseStartPayment()}chooseStartPayment(){this.arPaymentModeList&&0!=this.arPaymentModeList.length&&(this.arPaymentModeList.sort((e,s)=>s.value-e.value),this.arPaymentModeList[0].value!=o.x6.pagaAdesso&&this.arPaymentModeList.sort((e,s)=>e.value-s.value),this.arPaymentModeList[0].selected=!0,this.onChangePaymentSelection(this.arPaymentModeList[0]))}get itemIcon(){let e="cart-outline";return this.selectedPaymentMode&&(e=this.selectedPaymentMode.itemIcon),e}onOpenChoose(){let s,e=[];if(this.arPaymentModeList&&0!==this.arPaymentModeList.length){for(const P of this.arPaymentModeList)s={text:P.description,icon:P.itemIcon,handler:()=>{this.onChangePaymentSelection(P)}},e.push(s);s={text:"Annulla",icon:"arrow-undo-sharp",role:"cancel"},e.push(s),this.actionSheetController.create({header:"Come desideri pagare ?",buttons:e}).then(P=>{P.present()})}}onChangePaymentSelection(e){this.selectedPaymentMode=e,this.onPaymentModeChoosed.emit(e.value)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(i.BX))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-payment-mode"]],inputs:{arPayment:"arPayment"},outputs:{onPaymentModeChoosed:"onPaymentModeChoosed"},decls:2,vars:2,consts:[["lines","none",4,"ngIf"],["button","","lines","full",3,"detail","click",4,"ngIf"],["lines","none"],["button","","lines","full",3,"detail","click"],["slot","start",3,"name"],[4,"ngIf"]],template:function(e,s){1&e&&(n.YNc(0,g,3,0,"ion-item",0),n.YNc(1,p,4,4,"ion-item",1)),2&e&&(n.Q6J("ngIf",!s.arPaymentModeList.length),n.xp6(1),n.Q6J("ngIf",s.arPaymentModeList.length))},directives:[_.O5,i.Ie,i.Q$,i.gu],styles:["ion-item[_ngcontent-%COMP%]{--detail-icon-color: var(--ion-color-primary);--detail-icon-opacity: 1}ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}"]}),t})()}}]);