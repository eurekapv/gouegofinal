"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[630],{7708:(y,_,r)=>{r.d(_,{b:()=>n});var t=r(4021);class n{constructor(m){this.idElectronicResult="",this.modePayment=m,m==t.x6.pagaStruttura?(this.channelPayment=t.$s.onSite,this.processResult=!0):m==t.x6.pagaBonifico&&(this.channelPayment=t.$s.bonifico,this.processResult=!0)}}},8622:(y,_,r)=>{r.d(_,{t:()=>h});var t=r(4021),n=r(2096),s=r(5362),m=r(9808);function g(p,P){1&p&&(n.TgZ(0,"div")(1,"ion-card",10)(2,"ion-card-content")(3,"p"),n._uU(4,"Connessione con servizi di pagamento..."),n.qZA(),n._UZ(5,"ion-progress-bar",11),n.qZA()()())}function u(p,P){1&p&&(n.TgZ(0,"div",12)(1,"ion-card",10)(2,"ion-card-content"),n._UZ(3,"div",13),n.qZA()()())}let h=(()=>{class p{constructor(a,e){this.modalController=a,this.toastController=e,this.urlPayPalScriptCheckOut="https://www.paypalobjects.com/api/checkout.js",this.urlPayPalScriptSmart="https://www.paypal.com/sdk/js?client-id=",this.urlPaypal="",this.paypalVersion="checkout",this.showPaypal=!1,this.showStripe=!1,this.showApplePay=!1,this.showGPay=!1,this.noPayment=!1,this.showProgressBar=!0,this.paypalVersion="smart"}ngOnInit(){this.initPaymentMethods()}initPaymentMethods(){if(this.noPayment=!0,this.listAreaPaymentSettings&&0!=this.listAreaPaymentSettings.length)for(let a=0;a<this.listAreaPaymentSettings.length;a++){const e=this.listAreaPaymentSettings[a];if(e.paymentInApp)switch(e.TIPOPAYMENT){case t.$s.paypal:if(this.noPayment=!1,this.showPaypal=!0,"checkout"==this.paypalVersion)this.urlPaypal=this.urlPayPalScriptCheckOut;else if("smart"==this.paypalVersion){switch(e.PPENVIRONMENT){case t.pW.production:this.urlPaypal=this.urlPayPalScriptSmart+e.PPCLIENTIDPRODUCTION;break;case t.pW.test:this.urlPaypal=this.urlPayPalScriptSmart+e.PPCLIENTIDSANDBOX}this.urlPaypal+="&currency=EUR"}this.scriptOnHead(this.urlPaypal)?setTimeout(()=>{this.renderPayPalBtn(e)},500):this.loadDinamicScript(this.urlPaypal).then(()=>{setTimeout(()=>{this.renderPayPalBtn(e)},500)}).catch(()=>{this.showMessage("Errore nelle impostazioni di PayPal; contatta la struttura"),this.onCancelPayment()});break;case t.$s.stripe:this.noPayment=!1,this.showStripe=!0;break;case t.$s.applePay:this.noPayment=!1,this.showApplePay=!0}}else this.noPayment=!0}onCancelPayment(){this.paymentData.processResult=!1,this.paymentData.messageResult="Pagamento annullato",this.modalController.dismiss(this.paymentData)}onSuccessPayment(a,e){this.paymentData.channelPayment=a,this.paymentData.idElectronicResult=e,this.paymentData.processResult=!0,this.paymentData.messageResult="Transazione completata con successo",this.modalController.dismiss(this.paymentData)}OnSuccessPaypal(a){let e,i,c;if(a){switch(this.paypalVersion){case"smart":i=a.payer.name.given_name,e=a.id,c=a.status,console.log(a);break;case"checkout":i=a.payer.name.given_name,e=a.id,c=a.status}this.onSuccessPayment(t.$s.paypal,e)}}loadDinamicScript(a){return new Promise((e,i)=>{const c=document.createElement("script");c.type="text/javascript",c.src=a,document.getElementsByTagName("head")[0].appendChild(c),c.onload=()=>{console.log("Script correctly loaded"),e()},c.onerror=o=>{console.log(o),i()}})}renderPayPalBtn(a){let e=this;"checkout"==this.paypalVersion?(this.showProgressBar=!1,paypal.Button.render({env:a.PPENVIRONMENT==t.pW.production?"production":"sandbox",client:{sandbox:a.PPCLIENTIDSANDBOX,production:a.PPCLIENTIDPRODUCTION},locale:"it_IT",style:{size:"responsive",color:"gold",shape:"pill",label:"pay",fundingicons:!0},commit:!0,payment:function(i,c){return c.payment.create({transactions:[{amount:{total:e.paymentData.amount+"",currency:e.paymentData.currency},description:e.paymentData.description}],note_to_payer:"Contatta la struttura per ogni problematica sul pagamento."})},onAuthorize:function(i,c){return c.payment.execute().then(function(o){e.OnSuccessPaypal(o)})}},"#customBtnPaypal")):"smart"==this.paypalVersion&&(this.showProgressBar=!1,paypal.Buttons({createOrder:function(i,c){return c.order.create({purchase_units:[{amount:{value:e.paymentData.amount+"",description:e.paymentData.description}}]})},onApprove:function(i,c){return c.order.capture().then(function(o){e.OnSuccessPaypal(o)})}}).render("#customBtnPaypal"))}scriptOnHead(a){let e=document.getElementsByTagName("script"),i=!1;for(let c=0;c<e.length;c++)if(e[c].getAttribute("src")==a){i=!0;break}return i}showMessage(a){this.toastController.create({message:a,duration:3e3}).then(e=>{e.present()})}}return p.\u0275fac=function(a){return new(a||p)(n.Y36(s.IN),n.Y36(s.yF))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-payment"]],inputs:{paymentData:"paymentData",listAreaPaymentSettings:"listAreaPaymentSettings"},decls:19,vars:7,consts:[["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","ios","close","md","close"],["color","danger","expand","block",1,"full-buttons",3,"click"],[4,"ngIf"],[1,"cart-total"],["lines","none"],["slot","end",1,"ion-text-right"],["class","cart-items",4,"ngIf"],["mode","ios"],["type","indeterminate"],[1,"cart-items"],["id","customBtnPaypal"]],template:function(a,e){1&a&&(n.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),n.NdJ("click",function(){return e.onCancelPayment()}),n._UZ(4,"ion-icon",3),n.qZA()(),n.TgZ(5,"ion-title"),n._uU(6,"Pagamento"),n.qZA()()(),n.TgZ(7,"ion-content")(8,"ion-button",4),n.NdJ("click",function(){return e.onCancelPayment()}),n._uU(9," Aspetta, voglio modificare "),n.qZA(),n.YNc(10,g,6,0,"div",5),n.TgZ(11,"div",6)(12,"ion-item",7)(13,"ion-label"),n._uU(14),n.qZA(),n.TgZ(15,"ion-label",8),n._uU(16),n.ALo(17,"currency"),n.qZA()()(),n.YNc(18,u,4,0,"div",9),n.qZA()),2&a&&(n.xp6(10),n.Q6J("ngIf",e.showProgressBar),n.xp6(4),n.Oqu(e.paymentData.description),n.xp6(2),n.Oqu(n.xi3(17,4,e.paymentData.amount,e.paymentData.currency)),n.xp6(2),n.Q6J("ngIf",e.showPaypal))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.gu,s.wd,s.W2,m.O5,s.PM,s.FN,s.X7,s.Ie,s.Q$],pipes:[m.H9],styles:[".welcome-card[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;max-width:90vw}.welcome-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{max-height:35vh;overflow:hidden}.welcome-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{margin:auto}.welcome-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{margin:auto}ion-button.full-buttons[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}ion-content[_ngcontent-%COMP%]{--padding-top: 16px;--padding-bottom: 16px;--padding-start: 26px;--padding-end: 26px}.title[_ngcontent-%COMP%]{margin-top:0;color:#434343}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{margin-left:0;margin-right:0;border-radius:0}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{display:flex;position:relative}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-img[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:16px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:cover;object-fit:cover;width:110px;height:110px;box-shadow:0 10px 30px #00000029}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(1){color:#434343}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(2){color:#919191}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(3){color:var(--ion-color-primary)}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .qty-selector[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background:#f6f6f6;border-radius:5px;margin-top:10px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .qty-selector[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #565656;font-size:16px;margin-left:8px;margin-right:8px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .qty-selector[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#565656!important;font-size:16px}.cart-items[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   #customBtnPaypal[_ngcontent-%COMP%]{text-align:center;width:100%}.address[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;font-size:18px;color:#434343}.address[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{width:12px;height:12px;padding:0;border-radius:50%}hr[_ngcontent-%COMP%]{background:#97979713}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-right:0}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]:nth-child(1){color:#919191}.cart-total[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]:nth-child(2){color:#434343}ion-footer[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}ion-footer[_ngcontent-%COMP%]   .main-button[_ngcontent-%COMP%]:after{box-shadow:none!important}"]}),p})()},7952:(y,_,r)=>{r.d(_,{e:()=>e});var t=r(2096),n=r(9953),s=r(4021),m=r(5362),g=r(9808);function u(i,c){1&i&&(t.TgZ(0,"ion-item",2)(1,"ion-label"),t._uU(2,"Pagamento non supportato"),t.qZA()())}function h(i,c){1&i&&(t.TgZ(0,"p"),t._uU(1," Clicca per altri metodi di pagamento "),t.qZA())}function p(i,c){if(1&i&&(t.TgZ(0,"ion-label")(1,"h6"),t._uU(2),t.qZA(),t.YNc(3,h,2,0,"p",5),t.qZA()),2&i){const o=t.oxw(2);t.xp6(2),t.Oqu(null==o.selectedPaymentMode?null:o.selectedPaymentMode.description),t.xp6(1),t.Q6J("ngIf",o.arPaymentModeList.length>1)}}function P(i,c){1&i&&(t.TgZ(0,"ion-label"),t._uU(1,"Scegli metodo di pagamento"),t.qZA())}function a(i,c){if(1&i){const o=t.EpF();t.TgZ(0,"ion-item",3),t.NdJ("click",function(){return t.CHM(o),t.oxw().onOpenChoose()}),t._UZ(1,"ion-icon",4),t.YNc(2,p,4,2,"ion-label",5),t.YNc(3,P,2,0,"ion-label",5),t.qZA()}if(2&i){const o=t.oxw();t.Q6J("detail",!0),t.xp6(1),t.Q6J("name",o.itemIcon),t.xp6(1),t.Q6J("ngIf",o.selectedPaymentMode),t.xp6(1),t.Q6J("ngIf",!o.selectedPaymentMode)}}let e=(()=>{class i{constructor(o){this.actionSheetController=o,this.arPayment=[],this.onPaymentModeChoosed=new t.vpe,this.arPaymentModeList=[]}ngOnInit(){this.arPaymentModeList=n.L.prepareArPaymentMode(this.arPayment),this.chooseStartPayment()}chooseStartPayment(){this.arPaymentModeList&&0!=this.arPaymentModeList.length&&(this.arPaymentModeList.sort((o,l)=>l.value-o.value),this.arPaymentModeList[0].value!=s.x6.pagaAdesso&&this.arPaymentModeList.sort((o,l)=>o.value-l.value),this.arPaymentModeList[0].selected=!0,this.onChangePaymentSelection(this.arPaymentModeList[0]))}get itemIcon(){let o="cart-outline";return this.selectedPaymentMode&&(o=this.selectedPaymentMode.itemIcon),o}onOpenChoose(){let l,o=[];if(this.arPaymentModeList&&0!==this.arPaymentModeList.length){for(const d of this.arPaymentModeList)l={text:d.description,icon:d.itemIcon,handler:()=>{this.onChangePaymentSelection(d)}},o.push(l);l={text:"Annulla",icon:"arrow-undo-sharp",role:"cancel"},o.push(l),this.actionSheetController.create({header:"Come desideri pagare ?",buttons:o}).then(d=>{d.present()})}}onChangePaymentSelection(o){this.selectedPaymentMode=o,this.onPaymentModeChoosed.emit(o.value)}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(m.BX))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-payment-mode"]],inputs:{arPayment:"arPayment"},outputs:{onPaymentModeChoosed:"onPaymentModeChoosed"},decls:2,vars:2,consts:[["lines","none",4,"ngIf"],["button","","lines","full",3,"detail","click",4,"ngIf"],["lines","none"],["button","","lines","full",3,"detail","click"],["slot","start",3,"name"],[4,"ngIf"]],template:function(o,l){1&o&&(t.YNc(0,u,3,0,"ion-item",0),t.YNc(1,a,4,4,"ion-item",1)),2&o&&(t.Q6J("ngIf",!l.arPaymentModeList.length),t.xp6(1),t.Q6J("ngIf",l.arPaymentModeList.length))},directives:[g.O5,m.Ie,m.Q$,m.gu],styles:["ion-item[_ngcontent-%COMP%]{--detail-icon-color: var(--ion-color-primary);--detail-icon-opacity: 1}ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}"]}),i})()}}]);