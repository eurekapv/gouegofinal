"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[912],{912:(A,M,r)=>{r.r(M),r.d(M,{InvoicesPageModule:()=>S});var i=r(9808),C=r(4182),a=r(7026),y=r(2028),h=r(6962),f=r(1111),T=r(3834),x=r(5351),_=r(9129),e=r(2096),I=r(2058),m=r(4021);let p=(()=>{class n{transform(o){let s="";return s=m.Gs.decode(m.Dl,o),s}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275pipe=e.Yjl({name:"tipomasterdocumento",type:n,pure:!0}),n})();function t(n,d){1&n&&(e.TgZ(0,"div",7)(1,"ion-label"),e._uU(2,"Nessuna ricevuta"),e.qZA(),e.TgZ(3,"ion-label"),e._uU(4,"disponibile"),e.qZA()())}function u(n,d){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const o=e.oxw().$implicit;e.xp6(1),e.Oqu(o.NOTESSTAMPA)}}function g(n,d){if(1&n){const o=e.EpF();e.TgZ(0,"ion-item",9),e.NdJ("click",function(){const l=e.CHM(o).$implicit;return e.oxw(2).onClickElement(l)}),e._UZ(1,"ion-icon",10),e.TgZ(2,"ion-label")(3,"h3"),e._uU(4),e.ALo(5,"tipomasterdocumento"),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"date"),e.qZA(),e.YNc(9,u,2,1,"p",6),e.qZA(),e.TgZ(10,"ion-chip",11),e._uU(11),e.ALo(12,"currency"),e.qZA()()}if(2&n){const o=d.$implicit;e.xp6(4),e.AsE("",e.lcZ(5,5,o.TIPOLOGIA)," num. ",o.NUMEROSTAMPA,""),e.xp6(3),e.hij("Emessa il: ",e.xi3(8,7,o.DATADOCUMENTO,"dd/LL/yyyy"),""),e.xp6(2),e.Q6J("ngIf",o.NOTESSTAMPA&&0!==o.NOTESSTAMPA.length),e.xp6(2),e.Oqu(e.xi3(12,10,o.TOTDOCUMENTO,"EUR"))}}function v(n,d){if(1&n&&(e.TgZ(0,"div")(1,"ion-list"),e.YNc(2,g,13,13,"ion-item",8),e.qZA()()),2&n){const o=e.oxw();e.xp6(2),e.Q6J("ngForOf",o.listRicevute)}}const P=[{path:"",component:(()=>{class n{constructor(o,s,c,l,D,U){this.loadingController=o,this.startService=s,this.file=c,this.fileOpener=l,this.toastController=D,this.navController=U,this.actualUtente=new x.oD,this.listRicevute=[],this.yearSelected=new Date}ngOnInit(){this.actualUtente=this.startService.actualUtente,this.actualUtente?this.requestRicevute():this.navController.navigateRoot("/home")}requestRicevute(o){let s;this.yearSelected&&(s=this.yearSelected.getFullYear(),o?this.startService.requestInvoices(this.actualUtente,s).then(c=>{this.listRicevute=c,o.target.complete()}).catch(c=>{_.M.consoleLog(c,"error"),this.showMessage("Errore di connessione"),o.target.complete()}):this.loadingController.create().then(c=>{c.present(),this.startService.requestInvoices(this.actualUtente,s).then(l=>{this.listRicevute=l,c.dismiss()}).catch(l=>{_.M.consoleLog(l,"error"),this.showMessage("Errore di connessione"),c.dismiss()})}))}onClickElement(o){this.loadingController.create({message:"Caricamento",spinner:"circular",backdropDismiss:!0}).then(s=>{s.present(),this.startService.downloadInvoice(o).then(c=>{s.dismiss(),c.result?this.startService.base64toBlob(c.code).then(l=>{this.startService.isDesktop?this.openDesktop(l):this.openMobile(l)}):this.showMessage(c.message)}).catch(c=>{s.dismiss(),_.M.consoleLog(c,"error"),this.showMessage("Errore di connessione")})})}openDesktop(o){let c=window.URL.createObjectURL(o),l=document.createElement("a");l.download="File",l.href=c,document.body.appendChild(l),l.click(),document.body.removeChild(l)}openMobile(o){this.file.writeFile(this.file.cacheDirectory,"Documento",o,{replace:!0}).then(l=>{this.fileOpener.open(l.toURL(),o.type).then(()=>_.M.consoleLog("File is opened")).catch(D=>_.M.consoleLog("Error openening file: "+D,"error"))}).catch(l=>{throw _.M.consoleLog("Error creating file: ","error"),_.M.consoleLog(l,"error"),l})}showMessage(o){this.toastController.create({message:o,duration:3e3}).then(s=>{s.present()})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(a.HT),e.Y36(h.D),e.Y36(f.$),e.Y36(T.u),e.Y36(a.yF),e.Y36(a.SH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-invoices"]],decls:12,vars:3,consts:[["color","primary"],["slot","start"],["defaultHref","/account"],["textAlignmentRight","true","calendarMode","year","iconColor","primary","iconName","calendar-outline","itemLines","none","label","Periodo","title","Seleziona un Anno",3,"actualDate","actualDateChange"],["slot","fixed",3,"ionRefresh"],["class","nofind-cnt",4,"ngIf"],[4,"ngIf"],[1,"nofind-cnt"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["slot","start","color","","name","document-text-outline",1,"icon-left"],["color","primary","slot","end"]],template:function(o,s){1&o&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Le tue ricevute"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"app-dtinput",3),e.NdJ("actualDateChange",function(l){return s.yearSelected=l})("actualDateChange",function(){return s.requestRicevute()}),e.qZA(),e.TgZ(8,"ion-refresher",4),e.NdJ("ionRefresh",function(l){return s.requestRicevute(l)}),e._UZ(9,"ion-refresher-content"),e.qZA(),e.YNc(10,t,5,0,"div",5),e.YNc(11,v,3,1,"div",6),e.qZA()),2&o&&(e.xp6(7),e.Q6J("actualDate",s.yearSelected),e.xp6(3),e.Q6J("ngIf",0===s.listRicevute.length),e.xp6(1),e.Q6J("ngIf",s.listRicevute.length>0))},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.W2,I.V,a.nJ,a.Wo,i.O5,a.Q$,a.q_,i.sg,a.Ie,a.gu,a.hM],pipes:[p,i.uU,i.H9],styles:[""]}),n})()}];let Z=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[y.Bz.forChild(P)],y.Bz]}),n})();var O=r(4586),E=r(933);let S=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[f.$,T.u],imports:[[i.ez,C.u5,a.Pc,Z,O.D,E.q]]}),n})()},2058:(A,M,r)=>{r.d(M,{V:()=>I});var i=r(2096),C=r(7587),a=r(7181),y=r(9129),h=r(7026),f=r(9808);function T(m,p){if(1&m&&i._UZ(0,"ion-icon",5),2&m){const t=i.oxw();i.Q6J("icon",t._iconName)("slot",t._iconSlot)("color",t._iconColor)}}function x(m,p){if(1&m&&(i.TgZ(0,"ion-label",6),i._uU(1),i.qZA()),2&m){const t=i.oxw();i.xp6(1),i.hij("",t._label," ")}}function _(m,p){if(1&m&&(i.TgZ(0,"ion-toolbar",10)(1,"ion-title",11),i._uU(2),i.qZA()()),2&m){const t=i.oxw(2);i.xp6(2),i.Oqu(t._title)}}function e(m,p){if(1&m){const t=i.EpF();i.TgZ(0,"ion-content"),i.YNc(1,_,3,1,"ion-toolbar",7),i.TgZ(2,"ion-datetime",8,9),i.NdJ("ionChange",function(){i.CHM(t);const g=i.MAs(3);return i.oxw().dateChanged(g.value)}),i.qZA()()}if(2&m){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t._showCalendarTitle),i.xp6(1),i.Q6J("presentation",t._calendarMode)("readonly",t._readonly)("value",t.formattedDateTimeString)("max",t._isoMaxDate)}}let I=(()=>{class m{constructor(){this.actualDateChange=new i.vpe,this._itemColor="",this._itemLines="",this._itemDetail=!1,this._iconName="",this._iconColor="",this._iconSlot="",this._label="",this._slotText="",this._title="",this._isoMaxDate="2099-12-31T23:59:59",this._componentId="",this._componentId=(new C.kK).newID(),this._itemDetail=!1,this._itemLines="full",this._iconColor="primary",this._iconSlot="start",this._maskFormat="dd/MM/yyyy",this._calendarMode=a.CV.date,this._readonly=!1,this._showCalendarTitle=!1,this._slotText="",this.initMaskFromMode()}set title(t){this._title=t,0!=t.length&&(this._showCalendarTitle=!0)}set itemLines(t){this._itemLines=t}set itemColor(t){this._itemColor=t}set itemDetail(t){this._itemDetail=t}set label(t){this._label=t}set textAlignmentRight(t){this._slotText=t?"end":""}set iconName(t){this._iconName=t}set iconColor(t){this._iconColor=t}set iconSlot(t){this._iconSlot=t}set actualDate(t){this._actualDate=t}set maskFormat(t){this._maskFormat=t}set calendarMode(t){this._calendarMode=t,this.initMaskFromMode()}set readonly(t){this._readonly=t}set isoMaxDate(t){this._isoMaxDate=t}ngOnInit(){}get withLabel(){let t=!1;return this._label&&0!=this._label.length&&(t=!0),t}get withIcon(){let t=!1;return this._iconName&&0!=this._iconName.length&&(t=!0),t}get formattedDateTimeString(){let t;if(this._actualDate){let u=this._actualDate.getTimezoneOffset(),g=new Date;g.setTime(this._actualDate.getTime()-60*u*1e3),t=g.toISOString()}else t="";return t}initMaskFromMode(){let t="";switch(this._calendarMode){case a.CV.date:t="dd/MM/yyyy";break;case a.CV.dateTime:t="dd/MM/yyyy H:mm";break;case a.CV.month:t="MMMM";break;case a.CV.monthYear:t="MMMM yyyy";break;case a.CV.yearMonth:t="yyyy MMMM";break;case a.CV.time:t="H:mm";break;case a.CV.timeDate:t="H:mm dd/MM/yyyy";break;case a.CV.year:t="yyyy"}this._maskFormat=t}dateChanged(t){let u=new Date(t),g=u.getTimezoneOffset(),v=new Date;v.setTime(u.getTime()+60*g*1e3),this._actualDate.getTime()!=v.getTime()&&(this.actualDateChange.emit(u),y.M.consoleLog("Emetto la data "+u.toDateString()))}}return m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=i.Xpm({type:m,selectors:[["app-dtinput"]],inputs:{title:"title",itemLines:"itemLines",itemColor:"itemColor",itemDetail:"itemDetail",label:"label",textAlignmentRight:"textAlignmentRight",iconName:"iconName",iconColor:"iconColor",iconSlot:"iconSlot",actualDate:"actualDate",maskFormat:"maskFormat",calendarMode:"calendarMode",readonly:"readonly",isoMaxDate:"isoMaxDate"},outputs:{actualDateChange:"actualDateChange"},decls:9,vars:12,consts:[[3,"color","lines","detail","id"],[3,"icon","slot","color",4,"ngIf"],["slot","start","position","fixed",4,"ngIf"],[3,"slot"],[3,"trigger"],[3,"icon","slot","color"],["slot","start","position","fixed"],["class","datetime-title","color","primary",4,"ngIf"],["locale","it-IT","size","cover","showDefaultButtons","true","cancelText","Annulla","clearText","Elimina","doneText","Conferma",3,"presentation","readonly","value","max","ionChange"],["mydatetime",""],["color","primary",1,"datetime-title"],["size","small"]],template:function(t,u){1&t&&(i.TgZ(0,"ion-item",0),i.YNc(1,T,1,3,"ion-icon",1),i.YNc(2,x,2,1,"ion-label",2),i.TgZ(3,"ion-text",3)(4,"p"),i._uU(5),i.ALo(6,"date"),i.qZA()(),i.TgZ(7,"ion-modal",4),i.YNc(8,e,4,5,"ng-template"),i.qZA()()),2&t&&(i.Q6J("color",u._itemColor)("lines",u._itemLines)("detail",u._itemDetail)("id",u._componentId),i.xp6(1),i.Q6J("ngIf",u.withIcon),i.xp6(1),i.Q6J("ngIf",u.withLabel),i.xp6(1),i.Q6J("slot",u._slotText),i.xp6(2),i.Oqu(i.xi3(6,9,u._actualDate,u._maskFormat)),i.xp6(2),i.Q6J("trigger",u._componentId))},directives:[h.Ie,f.O5,h.gu,h.Q$,h.yW,h.ki,h.W2,h.sr,h.wd,h.x4,h.QI],pipes:[f.uU],styles:["ion-item[_ngcontent-%COMP%]{cursor:pointer}ion-toolbar.datetime-title[_ngcontent-%COMP%]{--padding-end: 10px;--padding-start: 10px}"]}),m})()}}]);