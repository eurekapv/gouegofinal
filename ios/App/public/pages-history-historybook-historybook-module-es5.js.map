{"version":3,"sources":["webpack:///src/app/pages/history/historybook/historybook.module.ts","webpack:///src/app/pages/history/historybook/historybook-routing.module.ts","webpack:///src/app/pages/history/historybook/historybook.page.ts","webpack:///src/app/pages/history/historybook/historybook.page.html"],"names":["HistorybookPageModule","routes","path","component","HistorybookPageRoutingModule","forChild","Share","HistorybookPage","router","navCtr","startService","toastCtr","socialSharing","docStructureService","loadingController","docstructrureService","alertController","myPrenotazione","arPayments","sliderOpts","slidesPerView","spaceBetween","initialSlide","result","create","spinner","message","backdropDismiss","then","loading","present","subStartConfig","startConfig","subscribe","config","paramMap","param","has","historyId","get","length","requestByHistoryId","dismiss","goBack","idPren","idPian","substr","idPrenotazione","idPianificazione","filterPrenotazione","ID","reqParams","child_level","requestNew","data","PRENOTAZIONEPIANIFICAZIONE","reqForeign","getReqForeignKeys","decodeCollection","getRelDoc","docArea","myArea","setPaymentFromArea","err","showMessage","console","log","error","navigateBack","duration","tstMsg","idSport","getSportIcon","docPianificazione","url","messaggio","logo","oggetto","AREALINKS","iterator","TIPOURL","home","REFERURL","getUrlLogo","NOMINATIVO","DATAORAINIZIO","toLocaleDateString","toLocaleTimeString","companyName","PROGRESSIVO","isDesktop","window","open","share","header","buttons","text","handler","deletePianificazione","role","alert","requestDeletePianificazione","resp"],"mappings":"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","file":"pages-history-historybook-historybook-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { HistorybookPageRoutingModule } from './historybook-routing.module';\r\n\r\nimport { HistorybookPage } from './historybook.page';\r\n\r\nimport { QRCodeModule } from 'angularx-qrcode'\r\n\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    HistorybookPageRoutingModule,\r\n    \r\n    QRCodeModule\r\n      \r\n  ],\r\n  declarations: [HistorybookPage]\r\n})\r\nexport class HistorybookPageModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { HistorybookPage } from './historybook.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HistorybookPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class HistorybookPageRoutingModule {}\r\n","import { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport { Prenotazione } from 'src/app/models/prenotazione.model';\r\nimport { Subscription } from 'rxjs';\r\nimport { PrenotazionePianificazione } from 'src/app/models/prenotazionepianificazione.model';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { StartService } from 'src/app/services/start.service';\r\nimport { NavController, ToastController, LoadingController, AlertController} from '@ionic/angular';\r\n\r\n//per lo share mobile con immagini\r\nimport { SocialSharing } from '@ionic-native/social-sharing/ngx';\r\n//per lo share via browser\r\nimport { Plugins } from '@capacitor/core';\r\nconst { Share } = Plugins;\r\n\r\nimport { DocstructureService } from 'src/app/library/services/docstructure.service'\r\n\r\nimport { StartConfiguration } from 'src/app/models/start-configuration.model';\r\nimport { Area } from 'src/app/models/area.model';\r\nimport { PageType } from 'src/app/models/valuelist.model'\r\nimport { RequestParams } from 'src/app/library/models/requestParams.model';\r\nimport { AreaPaymentSetting } from 'src/app/models/areapaymentsetting.model';\r\n\r\n\r\n@Component({\r\n  selector: 'app-historybook',\r\n  templateUrl: './historybook.page.html',\r\n  styleUrls: ['./historybook.page.scss'],\r\n})\r\nexport class HistorybookPage implements OnInit, OnDestroy {\r\n\r\n  myPrenotazione: Prenotazione= new Prenotazione;\r\n\r\n  startConfig:StartConfiguration;\r\n  subStartConfig:Subscription;\r\n  \r\n  idPrenotazione: string;\r\n  idPianificazione: string;\r\n  historyId: string;\r\n  myArea:Area;\r\n\r\n\r\n\r\n  //i metodi di pagamento possibili\r\n  arPayments : AreaPaymentSetting[] = [];\r\n\r\n  sliderOpts={\r\n    slidesPerView: 1,\r\n    spaceBetween: 0,\r\n    initialSlide: 0 \r\n  }\r\n\r\n\r\n  constructor(private router: ActivatedRoute,\r\n              private navCtr: NavController,\r\n              private startService: StartService,\r\n              private toastCtr: ToastController,\r\n              private socialSharing: SocialSharing,\r\n              private docStructureService: DocstructureService,\r\n              private loadingController: LoadingController,\r\n              private docstructrureService: DocstructureService,\r\n              private alertController: AlertController\r\n              ) { }\r\n\r\n  //In paramMap leggo IDPrenotazione\r\n  ngOnInit() {\r\n\r\n\r\n    let result=true; \r\n    this.loadingController.create({\r\n      spinner:'circular',\r\n      message:'Caricamento',\r\n      backdropDismiss:true\r\n    }).then(loading=>{\r\n      loading.present();\r\n      this.subStartConfig=this.startService.startConfig.subscribe(config=>{\r\n        this.startConfig=config;\r\n      })\r\n      this.router.paramMap.subscribe(param => {\r\n        if (param.has('historyId')) {\r\n  \r\n          //HistoryID è formato da IDPrenotazione + '-' + IDPianificazione\r\n          this.historyId = param.get('historyId');\r\n  \r\n          if (this.historyId.length !== 0) {\r\n            result = this.requestByHistoryId(this.historyId);\r\n          }\r\n          else {\r\n            result = false;\r\n          }\r\n        }\r\n        else {\r\n          result = false;\r\n        }\r\n  \r\n        if (!result) {\r\n          this.loadingController.dismiss();\r\n          this.goBack();\r\n        }\r\n      });\r\n    })\r\n\r\n  }\r\n\r\n  /**\r\n   * Richiedo le informazioni con historyID\r\n   * @param historyId HistoryId\r\n   */\r\n  requestByHistoryId(historyId: string) {\r\n    let result = true;\r\n    let idPren = '';\r\n    let idPian = '';\r\n\r\n    \r\n\r\n    if (historyId.length !== 0) {\r\n      idPren = historyId.substr(0,36);\r\n      idPian = historyId.substr(37,36);\r\n\r\n      \r\n\r\n      if (idPren.length !== 36 || idPian.length !== 36) {\r\n        result = false;\r\n      }\r\n      else {\r\n        this.idPrenotazione = idPren;\r\n        this.idPianificazione = idPian;\r\n\r\n        //creo il filtro e richiedo la prenotazione\r\n        let filterPrenotazione : Prenotazione=new Prenotazione(true);\r\n        filterPrenotazione.ID=idPren;\r\n        //Parametri richiesta\r\n        let reqParams = new RequestParams();\r\n        reqParams.child_level = 2;\r\n\r\n        //Lancio la richiesta per la Prenotazione\r\n        this.docStructureService.requestNew(filterPrenotazione,reqParams)\r\n        .then(data =>{\r\n            //Recupero la Prenotazione\r\n            this.myPrenotazione = data[0];\r\n\r\n            //Voglio decodificare una collection di PRENOTAZIONEPIANIFICAZIONE e recuperare il doc Area\r\n\r\n            \r\n            \r\n            if (this.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE && this.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length !== 0 ) {\r\n              \r\n              //Mi faccio tornare i campi di foreing key e di describe che mi servono ora\r\n              let reqForeign = PrenotazionePianificazione.getReqForeignKeys();\r\n\r\n              //Chiedo la decodifica della collection e successivamente chiedo il documento Area\r\n              this.docStructureService.decodeCollection(this.myPrenotazione.PRENOTAZIONEPIANIFICAZIONE, reqForeign)\r\n                                      .then(() => {\r\n\r\n                                        //CHIEDO L'AREA\r\n                                        //Chiedo il recupero del documento Area\r\n                                        this.docstructrureService.getRelDoc(this.myPrenotazione, ['IDAREAOPERATIVA'])\r\n                                                                  .then(docArea => {\r\n                                                                      this.myArea = docArea;\r\n\r\n                                                                      //Imposto i dati per i pagamenti\r\n                                                                      this.setPaymentFromArea();\r\n\r\n                                                                      \r\n                                                                      //Qui è arrivato tutto esattamente\r\n                                                                      this.loadingController.dismiss();\r\n                                                                  })\r\n                                                                  .catch(err => {\r\n\r\n                                                                        //Dismetto il loading\r\n                                                                        this.loadingController.dismiss();\r\n                                                                        this.showMessage('Errore nel caricamento Area');\r\n                                                                        console.log(err);                                                                    \r\n                                                                  });\r\n\r\n                                      })\r\n                                      .catch(err => {\r\n                                        //Dismetto il loading\r\n                                        this.loadingController.dismiss();\r\n\r\n                                        this.showMessage('Errore nel caricamento Elenco');\r\n                                        console.log(err);\r\n                                      });\r\n            }\r\n            else {\r\n\r\n                //SE NON PRENOTAZIONI PIANIFICAZIONE\r\n                //CHIEDO L'AREA\r\n                //Chiedo il recupero del documento Area\r\n                this.docstructrureService.getRelDoc(this.myPrenotazione, ['IDAREAOPERATIVA'], 3)\r\n                                          .then(docArea => {\r\n\r\n                                              this.myArea = docArea;\r\n                                              this.setPaymentFromArea();\r\n\r\n                                              //Qui è arrivato tutto esattamente\r\n                                              this.loadingController.dismiss();\r\n                                          })\r\n                                          .catch(err => {\r\n                                                //Dismetto il loading\r\n                                                this.loadingController.dismiss();\r\n                                                this.showMessage('Errore nel caricamento Area');\r\n                                                console.log(err);                                                                    \r\n                                          });\r\n\r\n            }\r\n\r\n\r\n        }).catch(error=>{\r\n          this.loadingController.dismiss();\r\n          this.showMessage('Errore nel caricamento Prenotazione');\r\n          console.log(error);\r\n        })\r\n      \r\n      }\r\n    }\r\n    else {\r\n      result = false;\r\n    }\r\n\r\n\r\n    return result;\r\n\r\n  }\r\n\r\n  /**\r\n   * Imposta i pagamenti a seconda dell'area\r\n   */\r\n  setPaymentFromArea() {\r\n    //TODO: Per impostare l'array dei pagamenti bisogna scaricare \r\n    //dal server l'Area perchè potrebbe essere diversa dall'attuale\r\n  }\r\n  \r\n\r\n  ngOnDestroy() {\r\n    \r\n  }\r\n\r\n\r\n  goBack() {\r\n    this.showMessage('Informazioni prenotazioni errate');\r\n    this.navCtr.navigateBack(['/','historylist']);\r\n  }\r\n\r\n\r\n   /**\r\n   * Visualizza un messaggio come Toast\r\n   * @param message Messaggio da mostrare\r\n   */\r\n  showMessage(message: string) {\r\n\r\n    //Creo un messaggio\r\n    this.toastCtr.create({\r\n      message: message,\r\n      duration: 3000\r\n    })\r\n    .then(tstMsg => {\r\n      tstMsg.present();\r\n    });\r\n\r\n  }\r\n\r\n  getIcon (idSport){\r\n    return this.startService.getSportIcon(idSport);\r\n  }\r\n\r\n  onShare(docPianificazione:PrenotazionePianificazione){\r\n    let url:string;\r\n    let messaggio:string;\r\n    let logo: string;\r\n    let oggetto: string;\r\n    \r\n    \r\n\r\n    if (this.myPrenotazione && docPianificazione){\r\n\r\n      for (const iterator of this.myArea.AREALINKS) {\r\n        if (iterator.TIPOURL==PageType.home){\r\n          url=iterator.REFERURL;\r\n          break;\r\n        }      \r\n      }\r\n      if(!url){\r\n        url='';\r\n      }\r\n      logo=this.startConfig.getUrlLogo();\r\n      messaggio=this.myPrenotazione.NOMINATIVO+' ha prenotato il '+docPianificazione.DATAORAINIZIO.toLocaleDateString()+' alle '+docPianificazione.DATAORAINIZIO.toLocaleTimeString();\r\n      \r\n      if (this.startConfig.companyName){\r\n        messaggio += ' presso '+this.startConfig.companyName;\r\n      }\r\n  \r\n      if (docPianificazione['_INDIRIZZO_Location']){\r\n        messaggio += ' '+docPianificazione['_INDIRIZZO_Location'];\r\n      }\r\n  \r\n      if (docPianificazione['_DENOMINAZIONE_Campo']){\r\n        messaggio += ' (Campo: '+docPianificazione['_DENOMINAZIONE_Campo'];\r\n      }\r\n  \r\n      if (docPianificazione['_DENOMINAZIONE_Sport']){\r\n        messaggio += ', Attività: '+docPianificazione['_DENOMINAZIONE_Sport']+')';\r\n      }\r\n  \r\n  \r\n      oggetto='Prenotazione '+docPianificazione.PROGRESSIVO;\r\n  \r\n      if(this.startService.isDesktop){\r\n        //share via mail su desktop\r\n        window.open('mailto:?subject='+oggetto+'&body='+messaggio);\r\n      }\r\n      else{\r\n        //share su mobile\r\n        this.socialSharing.share(messaggio,'',logo,url);\r\n      }\r\n    }\r\n\r\n    else{\r\n      this.showMessage('Errore nella condivisione');\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Richiesta cancellazione prenotazione al server\r\n   * @param idPianificazione Prenotazione Pianificazione\r\n   */\r\n  onClickTrash(idPianificazione: string) {\r\n    this.alertController.create({\r\n      header:\"Sei sicuro?\",\r\n      message:\"Continuando, cancellerai questa prenotazione\",\r\n      buttons: [\r\n        {\r\n          text: 'Conferma',\r\n          handler: () => {this.deletePianificazione(idPianificazione)}\r\n        },\r\n        {\r\n          text: 'Annulla',\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n\r\n    })\r\n    .then(alert => {\r\n      alert.present();\r\n    })\r\n  }\r\n\r\n\r\n  deletePianificazione(idPianificazione: string){\r\n\r\n    this.loadingController.create({\r\n      message: 'Cancellazione...',\r\n      spinner: 'circular',\r\n      backdropDismiss: true\r\n    })\r\n    .then(loading => {\r\n      return loading.present();\r\n    })\r\n    .then(() => {\r\n      //faccio richiesta cancellazione \r\n      return this.startService.requestDeletePianificazione(idPianificazione)\r\n    })\r\n    .then(resp => {\r\n      //Chiudo il Loading Controller\r\n      this.loadingController.dismiss();\r\n      \r\n      //Visualizzo il messaggio\r\n      this.showMessage(resp.message);\r\n\r\n      //Se è andato tutto bene\r\n      if(resp.result) {\r\n        \r\n        //è andato tutto bene\r\n        this.navCtr.navigateBack('/historylist');\r\n      }\r\n\r\n    })\r\n    .catch(resp => {\r\n      this.loadingController.dismiss();\r\n      this.showMessage(resp.message);\r\n    })\r\n    \r\n\r\n\r\n\r\n\r\n    // this.alertController.create({\r\n    //   header: 'Cancellazione',\r\n    //   message: 'Contattaci direttamente per cancellare questa prenotazione',\r\n    //   backdropDismiss: true,\r\n    //   buttons: [\r\n    //     {\r\n    //       text: 'Ok',\r\n    //       handler: ()=>{this.alertController.dismiss()}\r\n    //     }\r\n    //   ]\r\n      \r\n    // })\r\n    // .then(elAlert => {\r\n    //   elAlert.present();\r\n    // })\r\n  }\r\n\r\n}\r\n","<ion-header>\r\n  <ion-toolbar color=\"primary\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-back-button defaultHref=\"/historylist\">    </ion-back-button>\r\n    </ion-buttons>\r\n    <ion-title>Prenotazione </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <!-- IN ATTESA DATI  -->\r\n  <!-- DATI  NON RICEVUTI -->\r\n  <!-- <div *ngIf=\"showSpinner\" id=\"crs-spinner\">\r\n    <ion-progress-bar type=\"indeterminate\"></ion-progress-bar>\r\n  </div> -->\r\n\r\n<!-- <div *ngIf=\"!showSpinner\"> -->\r\n<div>\r\n  <ion-slides [options]=\"sliderOpts\">\r\n    <ion-slide *ngFor=\"let docPianificazione of myPrenotazione.PRENOTAZIONEPIANIFICAZIONE; index as i\">\r\n      <div style=\"width: 100%;\" >\r\n        <div class=\"ion-text-center div-qr\" mode=\"md\">\r\n            <h6>ID: {{docPianificazione.PROGRESSIVO}}</h6>\r\n            <qrcode [qrdata]=\"docPianificazione.ID\"></qrcode>\r\n            <p>\r\n              <ion-icon name=\"information-circle-outline\" color=\"primary\"></ion-icon>\r\n              Presenta il Qr-code o l'ID prenotazione all'ingresso\r\n            </p>\r\n        </div>\r\n    \r\n        <div class=\"ion-text-center div-btns\">\r\n          <ion-button layout=\"icon-top\" fill=\"clear\" size=\"large\" (click)=\"onClickTrash(docPianificazione.ID)\">\r\n            <ion-icon name=\"trash-outline\"></ion-icon>\r\n          </ion-button>\r\n          <ion-button *ngIf=\"docPianificazione && docPianificazione['_EMAIL_Location']\" fill=\"clear\" size=\"large\" href=\"{{'mailto:'+docPianificazione['_EMAIL_Location']+'?subject=Prenotazione numero '+docPianificazione.PROGRESSIVO}}\">\r\n            <ion-icon name=\"mail-outline\"></ion-icon>\r\n          </ion-button>\r\n          <ion-button  fill=\"clear\" size=\"large\" (click)=\"onShare(docPianificazione)\">\r\n            <ion-icon name=\"share-social-outline\"></ion-icon>\r\n          </ion-button>\r\n        </div>\r\n    \r\n        <ion-list lines=\"none\">\r\n          <ion-item lines=\"full\" *ngIf=\"myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length>1\">\r\n            <ion-icon *ngIf=\"i!=0\" color=\"primary\" class=\"no-margin-vertical\" slot=\"start\" name=\"chevron-back\"></ion-icon>\r\n            <ion-label class=\"no-margin-vertical\">DATA {{i+1}} DI {{myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length}}</ion-label>\r\n            <ion-icon *ngIf=\"i<myPrenotazione.PRENOTAZIONEPIANIFICAZIONE.length-1\" color=\"primary\" class=\"no-margin-vertical\" slot=\"end\" name=\"chevron-forward\"></ion-icon>\r\n          </ion-item>\r\n          <ion-item>\r\n            <ion-label>\r\n              <h2>{{docPianificazione['_DENOMINAZIONE_Sport']}}</h2>\r\n            </ion-label>\r\n            <ion-chip color=\"primary\">\r\n              <i class=\"icon-sport\"><span [innerHTML]=\"getIcon(docPianificazione.IDSPORT)\"></span></i> \r\n            </ion-chip>\r\n          </ion-item>\r\n          <ion-item>\r\n            <ion-label>\r\n              <h2>{{docPianificazione.DATAORAINIZIO| date : 'EEEE dd/LL/yyyy'|titlecase}}</h2>\r\n              <p>dalle {{docPianificazione.DATAORAINIZIO | date : 'HH:mm'}} alle {{docPianificazione.DATAORAFINE | date : 'HH:mm'}} </p>\r\n            </ion-label>\r\n            <ion-chip color=\"primary\">\r\n              {{docPianificazione.DURATAORE}} {{docPianificazione.DURATAORE==1? 'Ora':'Ore'}} \r\n            </ion-chip>\r\n          </ion-item>\r\n          <ion-item>\r\n            <ion-label>\r\n              <h2>{{docPianificazione['_DENOMINAZIONE_Campo']}}</h2>\r\n              <p>{{docPianificazione['_COMUNE_Location']|titlecase}}</p>\r\n              <p>{{docPianificazione['_INDIRIZZO_Location']|titlecase}}</p>\r\n            </ion-label>\r\n            <ion-chip color=\"primary\">\r\n              {{docPianificazione.NUMPARTECIPANTI}}\r\n              <ion-icon name=\"person\"></ion-icon>\r\n            </ion-chip>\r\n          </ion-item>\r\n        </ion-list>\r\n      </div>\r\n    </ion-slide>\r\n  </ion-slides>\r\n    <ion-item color=\"light\">\r\n      PAGAMENTO\r\n    </ion-item>\r\n    <ion-item lines=\"full\">\r\n      <ion-label slot=\"start\">\r\n        Importo\r\n      </ion-label>\r\n      <ion-label style=\"text-align: right;\">\r\n        {{myPrenotazione.TOTALE | currency : 'EUR'}}\r\n      </ion-label>\r\n    </ion-item>\r\n    <ion-item lines=\"full\"  *ngIf=\"myPrenotazione.TOTALE!=myPrenotazione.INCASSATO\">\r\n      <ion-label slot=\"start\">\r\n        Pagato\r\n      </ion-label>\r\n      <ion-label style=\"text-align: right;\">\r\n        {{myPrenotazione.INCASSATO | currency : 'EUR'}}\r\n      </ion-label>\r\n    </ion-item>\r\n    <ion-item lines=\"full\">\r\n      <ion-label slot=\"start\">\r\n        Residuo\r\n      </ion-label>\r\n      <ion-label style=\"text-align: right;\">\r\n        {{myPrenotazione.RESIDUO | currency : 'EUR'}}\r\n      </ion-label>\r\n    </ion-item>\r\n  </div>\r\n</ion-content>\r\n\r\n<ion-footer>\r\n  <ion-button expand=\"block\" [disabled]=\"true\" color=\"tertiary\">\r\n    {{myPrenotazione.getCaptionStatePayment(false)}}\r\n  </ion-button>\r\n</ion-footer>"]}