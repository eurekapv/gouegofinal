<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Agenda Impegni</ion-title>
  </ion-toolbar>

  <ion-toolbar mode="md">

    <ion-segment 
          
          [(ngModel)]="selectedView" 
          (ionChange)="onChangeSegment($event)" >

      <ion-segment-button  
                [value]="PageView.impegni">
        <ion-icon name="today-outline"></ion-icon>
        <ion-label>Impegni</ion-label>
      </ion-segment-button>

      <ion-segment-button 
      [value]="PageView.corsi">
        <ion-icon name="school-outline"></ion-icon>
        <ion-label>Corsi</ion-label>
      </ion-segment-button>

    </ion-segment>
  </ion-toolbar>

</ion-header>

<ion-content scrollEvents (ionScroll)="onScroll($event)">

  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- PORZIONE DATE PIANIFICATE -->
  <div class="contentExpand" *ngIf="selectedView==PageView.impegni">

    <!-- PORZIONE FILTRI -->
    <ion-list>
      <ion-item-group >
        <ion-item-divider 
              class="ion-padding-vertical"
              color="light"
              (click)="onChangeCollapseFilterPianificazioni()">

          <ion-icon slot="start" [name]="collapsedFilterPianificazioni ? 'chevron-down-outline':'chevron-up-outline'"></ion-icon>
          <ion-label>
            <h2>{{getLabelFilterImpegni()}}</h2>
          </ion-label>
        </ion-item-divider>

        <ion-item 
              *ngIf = "!collapsedFilterPianificazioni"
              lines="none" 
              color="" >
          <ion-label class="ion-text-wrap">
            <h6>E' possibile ottenere l'elenco degli impegni giornalieri, settimanali o mensili</h6>
          </ion-label>
          <ion-icon slot="start" name="information-circle-outline"></ion-icon>
        </ion-item>

        <ion-item 
            *ngIf = "!collapsedFilterPianificazioni"
            lines="none" 
            color="">
          <ion-icon slot="start" name="search-circle-outline"></ion-icon>
          <ion-label>Ricerca Impegni</ion-label>

          <ion-select
                mode="ios" 
                (ionChange)="onChangePageRangeSearch($event)"
                [(ngModel)]="rangeSearchPianificazioni"
                interface = "action-sheet" 
                okText="Conferma" 
                cancelText="Annulla">
            <ion-select-option [value]="PageRangeSearch.giorno">Giornalieri</ion-select-option>
            <ion-select-option [value]="PageRangeSearch.settimana">Settimanali</ion-select-option>
            <ion-select-option [value]="PageRangeSearch.mese">Mensili</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item lines="none" color="" >
          <ion-icon slot="start" name="calendar-outline" color="primary"></ion-icon>
          <ion-datetime 
            displayFormat="DDDD - DD/MM/YYYY" 
            [dayNames]="settimana" 
            [(ngModel)]="selectedIsoDate" 
            (ngModelChange)="onChangeFilterDateImpegni()"
          >
        </ion-datetime>
        <ion-icon name="chevron-down-outline" color="primary" slot="end"></ion-icon>
        </ion-item>

        
      </ion-item-group>          
    </ion-list>

    <!-- PIANIFICAZIONI PRESENTI -->
    <div 
          *ngIf="myListPianificazioni && myListPianificazioni.length != 0" 
          class="ion-no-padding">
      <ion-list           
          class="ion-padding-vertical">

          <!-- VENGONO MOSTRATI GLI ELEMENTI DEL CALENDARIO CORSO -->
          <!-- LA DATA VIENE MOSTRATA SOLO SE LA VISIONE E' DIVERSA DA GIORNO -->
          <app-item-calendario 
            *ngFor="let pianificazione of myListPianificazioni" 
            [params]="getItemParamsFromPianificazione(pianificazione)"
            [showDate]="rangeSearchPianificazioni != PageRangeSearch.giorno"
            (click)="onClickImpegno(pianificazione)">
          </app-item-calendario>
        

      </ion-list>
    </div>
  
    <!-- NESSUNA PIANIFICAZIONE  -->
    <div class="nofind-cnt" *ngIf="!myListPianificazioni || myListPianificazioni.length == 0">
      <ion-label>Nessun corso pianificato</ion-label>
    </div>
  </div>

  <!-- PORZIONI ELENCO CORSI -->
  <div class="contentExpand" *ngIf="selectedView==PageView.corsi">
    <!-- AREA FILTRO RICERCA -->
    <ion-list>
      <ion-item-group >
        <ion-item-divider 
              class="ion-padding-vertical"
              color="light"
              (click)="onChangeCollapseFilterCorsi()">
              <ion-icon slot="start" [name]="collapsedFilterCorsi ? 'chevron-down-outline':'chevron-up-outline'"></ion-icon>              
          <ion-label>
            <h2>Corsi che risultano</h2>
          </ion-label>
        </ion-item-divider>

        <ion-item 
              *ngIf = "!collapsedFilterCorsi"
              lines="none" 
              color="" >
          <ion-label class="ion-text-wrap">
            <h6>Elenco dei corsi svolti, in esecuzioni o che ti sono stati assegnati da eseguire prossimamente come trainer o assistente. 
              Al termine del corso potrai dare una valutazione finale dei partecipanti, assegnando eventualmente un nuovo livello raggiunto</h6>
          </ion-label>
          <ion-icon slot="start" name="information-circle-outline"></ion-icon>
        </ion-item>        

        <ion-item lines="none" color="" >
          <ion-icon slot="start" name="hourglass-outline" color="primary"></ion-icon>
          <ion-select 
              mode="ios" 
              (ionChange)="onChangeTimeState($event)"
              [(ngModel)]="selectedTimeState"
              interface="action-sheet">

              <ion-select-option [value]="TimeStateCourse.passati">
                Conclusi
              </ion-select-option>  

              <ion-select-option [value]="TimeStateCourse.attivi">
                In Esecuzione
              </ion-select-option>

              <ion-select-option [value]="TimeStateCourse.futuri">
                Futuri
              </ion-select-option> 

          </ion-select>
        
        <ion-icon name="chevron-down-outline" color="primary" slot="end"></ion-icon>
        </ion-item>

        
      </ion-item-group>  
    </ion-list>

    <!-- CORSI TROVATI -->
    <div class="ion-no-padding" *ngIf="myListCorsi && myListCorsi.length != 0">
        
      <!-- LISTA CORSI -->
      <ion-list *ngIf="myListCorsi!.length !== 0">
        <ion-item button 
              *ngFor="let corso of myListCorsi" 
              (click)="onClickCorso(corso)" >

        <!-- ICONA CORSO -->
        <ion-icon 
            name="school" 
            class="icon-school"
            slot="start"
            [color]="getColorIconCorso(corso)">
        </ion-icon>

        <ion-label class="ion-text-wrap">
          <p>{{corso.DATAINIZIO | date : 'EEEE dd/MM/yyyy' | titlecase}}
            <br/>
            {{corso.DATAFINE | date : 'EEEE dd/MM/yyyy' | titlecase}}
          </p>
          <h4>{{corso['_DENOMINAZIONE_Sport']}} in {{corso['_DENOMINAZIONE_Location']}}</h4>
          <h6>{{corso.GIORNIPREVISTI| giorniPrevisti: lingua|titlecase}} </h6>

        </ion-label>   
        
        <!-- ORA INIZIO -->
        <ion-chip 
            [color]="corso.DATAFINE > today && corso.DATAINIZIO < today ? 'success': 'danger'">
          {{corso.ORAINIZIO | date: 'HH:mm'}}
          <ion-icon name="time-outline"></ion-icon>
        </ion-chip>
        </ion-item>         
      </ion-list>        

    </div>
  

    <!-- NESSUN CORSO TROVATO  -->
    <div class="nofind-cnt" *ngIf="!myListCorsi || myListCorsi.length == 0">
      <ion-label>Nessun corso trovato</ion-label>
    </div>
  </div>    

  
  
</ion-content>
