<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button [defaultHref]="backButtonHref"></ion-back-button>
    </ion-buttons>
    <ion-title>QUALCOSA SU DI TE</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <div class="page-container">

    <!-- INFO BOX -->
    <div class="info-box">
      <ion-icon name="information-circle" class="info-icon"></ion-icon>
      <p>Ti chiediamo alcune informazioni così da poterti consigliare le attività che abbiamo riservato per te</p>
    </div>

    <form [formGroup]="formPagePrimary">

      <!-- ========== SEZIONE 1: DATI ANAGRAFICI ========== -->
      <div class="section-card">
        <div class="section-header">
          <div class="header-icon">
            <ion-icon name="person"></ion-icon>
          </div>
          <h3>Come ti chiami?</h3>
        </div>

        <div class="section-body">
          
          <!-- Nome -->
          <div class="input-group">
            <ion-icon name="person-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Nome"
                  labelPlacement="floating"
                  placeholder="Inserisci il tuo nome"
                  [clearInput]="true"
                  formControlName="nome">
            </ion-input>
          </div>

          <!-- Cognome -->
          <div class="input-group">
            <ion-icon name="person-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Cognome"
                  labelPlacement="floating"
                  placeholder="Inserisci il tuo cognome"
                  [clearInput]="true"
                  formControlName="cognome">
            </ion-input>
          </div>

          <!-- Sesso -->
          <div class="input-group">
            <ion-icon name="male-female-outline" class="input-icon"></ion-icon>
            <ion-select
                  label="Sesso"
                  labelPlacement="floating"
                  interface="popover"
                  formControlName="sesso">
              <ion-select-option 
                *ngFor="let sesso of listSesso"
                [value]="sesso.value">
                {{ sesso.description }}
              </ion-select-option>
            </ion-select>
          </div>

          <!-- Codice Fiscale -->
          <div class="input-group">
            <ion-icon name="card-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Codice Fiscale"
                  labelPlacement="floating"
                  placeholder="RSSMRA80A01H501Z"
                  [clearInput]="true"
                  (ionBlur)="onCfChange()"
                  formControlName="cf">
            </ion-input>
          </div>

        </div>
      </div>

      <!-- ========== SEZIONE 2: INDIRIZZO ========== -->
      <div class="section-card">
        <div class="section-header">
          <div class="header-icon">
            <ion-icon name="home"></ion-icon>
          </div>
          <h3>Dove vivi?</h3>
        </div>

        <div class="section-body">
          
          <!-- Indirizzo -->
          <div class="input-group">
            <ion-icon name="location-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Indirizzo"
                  labelPlacement="floating"
                  placeholder="Via/Piazza"
                  [clearInput]="true"
                  formControlName="indResidenza">
            </ion-input>
          </div>

          <!-- Comune -->
          <div class="input-group">
            <ion-icon name="business-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Comune"
                  labelPlacement="floating"
                  placeholder="Città"
                  [clearInput]="true"
                  formControlName="comResidenza">
            </ion-input>
          </div>

          <!-- CAP e Provincia (su due colonne) -->
          <div class="input-row">
            <div class="input-group half">
              <ion-icon name="mail-outline" class="input-icon"></ion-icon>
              <ion-input
                    label="CAP"
                    labelPlacement="floating"
                    placeholder="00000"
                    [clearInput]="true"
                    type="tel"
                    inputmode="tel"
                    maxlength="5"
                    formControlName="capResidenza">
              </ion-input>
            </div>

            <div class="input-group half">
              <ion-icon name="map-outline" class="input-icon"></ion-icon>
              <ion-input
                    label="Provincia"
                    labelPlacement="floating"
                    placeholder="Sigla"
                    [clearInput]="true"
                    formControlName="provResidenza">
              </ion-input>
            </div>
          </div>

          <!-- Stato -->
          <div class="input-group">
            <ion-icon name="flag-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Stato"
                  labelPlacement="floating"
                  placeholder="Italia"
                  [clearInput]="true"
                  formControlName="statoResidenza">
            </ion-input>
          </div>

        </div>
      </div>

      <!-- ========== SEZIONE 3: DATI NASCITA ========== -->
      <div class="section-card">
        <div class="section-header">
          <div class="header-icon">
            <ion-icon name="calendar"></ion-icon>
          </div>
          <h3>Quando sei nato?</h3>
        </div>

        <div class="section-body">
          
          <!-- Data di nascita (componente custom) -->
          <div class="date-input-wrapper">
            <app-dtinput
                  title="Data di nascita"
                  label="Nato il"
                  [(actualDate)]="this.utente.NATOIL">
            </app-dtinput>
          </div>

          <!-- Comune nascita -->
          <div class="input-group">
            <ion-icon name="business-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Comune"
                  labelPlacement="floating"
                  placeholder="Città di nascita"
                  [clearInput]="true"
                  formControlName="comNascita">
            </ion-input>
          </div>

          <!-- CAP nascita (se visibile) -->
          <div class="input-group" *ngIf="showCapNascita">
            <ion-icon name="mail-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="CAP"
                  labelPlacement="floating"
                  placeholder="00000"
                  [clearInput]="true"
                  type="tel"
                  inputmode="tel"
                  maxlength="5"
                  formControlName="capNascita">
            </ion-input>
          </div>

          <!-- Provincia nascita -->
          <div class="input-group">
            <ion-icon name="map-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Provincia"
                  labelPlacement="floating"
                  placeholder="Sigla"
                  [clearInput]="true"
                  formControlName="provNascita">
            </ion-input>
          </div>

          <!-- Stato nascita -->
          <div class="input-group">
            <ion-icon name="flag-outline" class="input-icon"></ion-icon>
            <ion-input
                  label="Stato"
                  labelPlacement="floating"
                  placeholder="Italia"
                  [clearInput]="true"
                  formControlName="statoNascita">
            </ion-input>
          </div>

        </div>
      </div>

      <!-- ========== SEZIONE 4: CONTATTI ========== -->
      <div class="section-card">
        <div class="section-header">
          <div class="header-icon">
            <ion-icon name="call"></ion-icon>
          </div>
          <h3>Cellulare e Email</h3>
        </div>

        <div class="section-body">
          
          <!-- Mobile -->
          <div class="contact-item">
            <div class="contact-icon">
              <ion-icon name="call"></ion-icon>
            </div>
            <div class="contact-info">
              <p class="contact-label">Numero Mobile</p>
              <p class="contact-value">{{utente.MOBILENUMBER ? utente.MOBILENUMBER : 'Non definito'}}</p>
            </div>
              <ion-badge [class]="utente.getColorBadgeForVerifica('mobile')">
                <ion-icon name="checkmark-circle"></ion-icon>
                {{utente.getLabelVerificaMobile()}}
              </ion-badge>
          </div>

          <!-- Email -->
          <div class="contact-item">
            <div class="contact-icon">
              <ion-icon name="mail"></ion-icon>
            </div>
            <div class="contact-info">
              <p class="contact-label">Email</p>
              <p class="contact-value">{{utente.EMAIL ? utente.EMAIL : 'Non definita'}}</p>
            </div>
            <ion-badge [class]="utente.getColorBadgeForVerifica('mail')">
              <ion-icon name="checkmark-circle"></ion-icon>
              {{utente.getLabelVerificaMail()}}
            </ion-badge>
          </div>

        </div>
      </div>

    </form>

    <!-- BOTTONE SALVA -->
    <ion-button
        class="save-button"
        expand="block"
        size="large"
        (click)="onSubmit()">
        <ion-icon name="checkmark-circle" slot="start"></ion-icon>
        Salva Modifiche
    </ion-button>

  </div>

</ion-content>